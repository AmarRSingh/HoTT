<html>
<head>
<title>Freudenthal.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Freudenthal.v</h1>

<div class="code" title="File: Freudenthal.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)

(** * The Freudenthal Suspension Theorem, and related results. (INCOMPLETE) *)

</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 4
Time: 0.043s">
<div class="time" style="width: 0.54658700902504%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 4
Time: 0.005s">
<div class="time" style="width: 0.0635566289564%"></div>
<pre>
Require Import HProp EquivalenceVarieties.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 5
Time: 0.125s">
<div class="time" style="width: 1.58891572391%"></div>
<pre>
Require Import HIT.Connectedness HIT.Suspension HIT.Truncations.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 6
Time: 0.003s">
<div class="time" style="width: 0.03813397737384%"></div>
<pre>
Import TrM.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope trunc_scope.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Generalizable Variables X A B f g n.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** [proof_admitted] is used to implement the admit tactic, as in Coq 8.5 beta 1. *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Axiom proof_admitted : False.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Ltac admit := case proof_admitted.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** Connectedness of the suspension *)

</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isconn_susp {n : trunc_index} {X : Type} `{H : IsConnected n X}
  : IsConnected n.+1 (Susp X).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply isconnected_from_elim.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros C H' f.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists (f North).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 21
Time: 0.003s">
<div class="time" style="width: 0.03813397737384%"></div>
<pre>
  assert ({ p0 : f North = f South &amp; forall x:X, ap f (merid x) = p0 })
    as [p0 allpath_p0] by (apply (isconnected_elim n); apply H').</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (Susp_ind (fun a =&gt; f a = f North) 1 p0^).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 25
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  apply (concat (transport_paths_Fl _ _)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (concat (concat_p1 _)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply ap, allpath_p0.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 28
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The Freudenthal Suspension Theorem *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Freudenthal.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We assume funext and univalence.  In fact, since we will use funext at two different levels and local assumptions are monomorphic, we need to assume funext twice; we give the second assumption of it a name (so we can use it explicitly when we want it), and a different type (so it doesn’t get used when we don’t want it). TODO: perhaps this could be handled in a more uniform way?? *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context `{Funext} (funext_large : Funext * Unit) `{Univalence}
        {n : trunc_index} {Hn : ~ n = -2}
        (X : Type) (x0:X) `{IsConnMap n _ _ (unit_name x0)}.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* TODO: eventually, change these to the weaker assumptions:
Context {n : trunc_index} (X : Type) `{IsConnected n.+1 X}.
*)

(** For convenience, we add some local abbreviations. *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation No := (@North X).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation So := (@South X).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Notation mer := (@merid X).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 43
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
Definition mer' := (fun x =&gt; mer x @ (mer x0)^).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The eventual theorem we want is: *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance Freudenthal
  : IsConnMap (n -2+ n) (mer').</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros p.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold IsConnected.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** We are not ready to prove this yet.  For the remainder of the section, we will generalize this goal a bit, and prove some auxiliary lemmas; then we will return to the theorem. *)
Abort.

(** The goal we require for the FST is: *)
Definition FST_Codes_No (p : No = No)
  := (Trunc (n -2+ n) (hfiber mer' p)).

(** To prove it, we generalise it over [Susp X], by [Susp_ind].  This requires three components, which we construct (the main parts of) as lemmas in advance. *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 57
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>Definition FST_Codes_So (q : No = So)
  := (Trunc (n -2+ n) (hfiber mer q)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* TODO: move! *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition hfiber_pair {A B} {f: A -&gt; B} {b} (a:A) (p:f a = b) : hfiber f b
  := (a;p).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition FST_Codes_cross (x1 : X) (q : No = So)
  : FST_Codes_No (q @ (mer x1) ^) -&gt; FST_Codes_So q.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold FST_Codes_No, FST_Codes_So, mer'.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply Trunc_rec.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 67
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [x2 p].</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert x1 x2 p.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 68
Time: 0.049s">
<div class="time" style="width: 0.62285496377272%"></div>
<pre>
  refine (@wedge_incl_elim_uncurried _ n n X x0 _ X x0 _
    (fun x1 x2 =&gt; (mer x2 @ (mer x0) ^ = q @ (mer x1) ^)
                    -&gt; Trunc (n -2+ n) (hfiber mer q)) _ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 71
Time: 2.057s">
<div class="time" style="width: 26.147197152663%"></div>
<pre>
  refine (pr1 (@isconnected_elim n.+1 X _ _ _ _)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 73
Time: 0.257s">
<div class="time" style="width: 3.266810728359%"></div>
<pre> apply @trunc_sigma; try typeclasses eauto.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 74
Time: 0.063s">
<div class="time" style="width: 0.80081352485064%"></div>
<pre> apply @trunc_forall; try typeclasses eauto; intro.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 74
Time: 0.017s">
<div class="time" style="width: 0.21609253845176%"></div>
<pre>
      apply @trunc_arrow; try typeclasses eauto; intro.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      admit.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 77
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
    admit.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 78
Time: 7.867s">
<div class="time" style="width: 100%"></div>
<pre>
  refine (pr1 (@isconnected_elim n.+1 X _ _ _ _)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 80
Time: 0.165s">
<div class="time" style="width: 2.0973687555612%"></div>
<pre> apply @trunc_arrow; try typeclasses eauto; intros.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 80
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
    admit.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 82
Time: 0.004s">
<div class="time" style="width: 0.05084530316512%"></div>
<pre> exists (fun b s =&gt; tr (hfiber_pair b (cancelR _ _ _ s))).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 82
Time: 0.01s">
<div class="time" style="width: 0.1271132579128%"></div>
<pre>
    exists (fun a r =&gt; tr (hfiber_pair a
                                                    (cancelR _ _ _ ((concat_pV _) @ (concat_pV _)^ @ r)))).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 84
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
    apply path_forall; intros s.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 85
Time: 0.004s">
<div class="time" style="width: 0.05084530316512%"></div>
<pre> apply ap, ap, ap.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 85
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
    exact ((concat_1p _)^ @ whiskerR (concat_pV _)^ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 86
Time: 0.054s">
<div class="time" style="width: 0.68641159272912%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We will need to show that [FST_Codes_cross] is an equivalence, for each [x1, q]. By connectedness of [X], it will be enough to show this for the case [x1 = x0]; to show this, we first write that case in a tidier form. *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition FST_Codes_cross_x0 (q : No = So)
  : FST_Codes_No (q @ (mer x0)^) -&gt; FST_Codes_So q.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold FST_Codes_No, FST_Codes_So.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 92
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  apply Trunc_functor, (functor_sigma idmap).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold mer'; intros x1.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply cancelR.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 94
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 95
Time: 0.004s">
<div class="time" style="width: 0.05084530316512%"></div>
<pre>

Definition isequiv_FST_Codes_cross (x : X) (q : No = So)
  : IsEquiv (FST_Codes_cross x q).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert x.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 100
Time: 0.003s">
<div class="time" style="width: 0.03813397737384%"></div>
<pre>
  apply (@conn_map_elim _ _ _ (unit_name x0) _
    (fun x =&gt; IsEquiv (FST_Codes_cross x q))).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros x; generalize dependent n.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 103
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> intros [ | n'] imposs.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 103
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
      destruct (imposs 1).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros ?.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (@trunc_leq -1).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact tt.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply hprop_isequiv.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [].</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 106
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> unfold FST_Codes_cross.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 106
Time: 0.621s">
<div class="time" style="width: 7.8937333163849%"></div>
<pre>
  refine (isequiv_homotopic (FST_Codes_cross_x0 q) _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold FST_Codes_cross_x0.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 108
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
    apply isequiv_Trunc_functor, @isequiv_functor_sigma.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 109
Time: 0.006s">
<div class="time" style="width: 0.07626795474768%"></div>
<pre> refine _.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 110
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> apply isequiv_cancelR.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 111
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre> hnf.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 111
Time: 0.018s">
<div class="time" style="width: 0.22880386424304%"></div>
<pre> apply Trunc_ind.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 111
Time: 0.013s">
<div class="time" style="width: 0.16524723528664%"></div>
<pre> intros ?; apply trunc_succ.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 111
Time: 0.076s">
<div class="time" style="width: 0.96606076013728%"></div>
<pre>
    intros [x r]; simpl.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 112
Time: 0.02s">
<div class="time" style="width: 0.2542265158256%"></div>
<pre>
    unfold functor_sigma; simpl.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 113
Time: 0.238s">
<div class="time" style="width: 3.0252955383246%"></div>
<pre>
    symmetry.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 114
Time: 0.344s">
<div class="time" style="width: 4.3726960722003%"></div>
<pre>
    exact (ap10 (wedge_incl_comp1 x0 x0 _ _ _ _ x) r).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 115
Time: 0.59s">
<div class="time" style="width: 7.4996822168552%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition FST_Codes
  : forall (y : Susp X), (No = y) -&gt; Type.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (Susp_ind (fun y =&gt; (No = y -&gt; Type)) FST_Codes_No FST_Codes_So).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 122
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply (@path_forall (fst funext_large)); intros p.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 122
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
  refine (transport_arrow _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 123
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  refine (transport_const _ _ @ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 124
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
  transitivity (FST_Codes_No (p @ (mer x)^)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 126
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> apply ap, transport_paths_r.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_universe_uncurried.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 127
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  exists (FST_Codes_cross x p).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 128
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
  apply isequiv_FST_Codes_cross.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 129
Time: 0.005s">
<div class="time" style="width: 0.0635566289564%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** It now remains to show that each [FST_Codes y p] is contractible. It is easy to provide a canonical inhabitant, by transport. (More directly, we could use path-induction, but we will later need to use transport lemmas to reason about this.) *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 132
Time: 0.004s">
<div class="time" style="width: 0.05084530316512%"></div>
<pre>Definition FST_Codes_center (y : Susp X) (p : No = y)
  : FST_Codes y p.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 134
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  assert (goal' : FST_Codes y (transport _ p 1)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply transportD.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl; unfold FST_Codes_No.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply tr.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists x0; unfold mer'.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply concat_pV.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 137
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
  refine (transport _ _ goal').</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 138
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> refine (transport_paths_r _ _ @ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply concat_1p.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 139
Time: 0.004s">
<div class="time" style="width: 0.05084530316512%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** TODO: move the following few lemmas. *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 142
Time: 0.015s">
<div class="time" style="width: 0.1906698868692%"></div>
<pre>Lemma transport_as_ap {A} (P : A -&gt; Type) {x y} (p : x = y)
  : transport P p == transport idmap (ap P p).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 144
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  intros ?; destruct p; exact 1.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma transportD'
  {A : Type} (B : A -&gt; Type) (C : forall a : A, B a -&gt; Type)
  {x1 x2 : A} (p : x1 = x2) (y : B x1)
: C x1 y -&gt; C x2 (transport B p y).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (transport idmap _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 153
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  refine (_ @ ap10 (apD C p) _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply inverse.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 155
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  refine (transport_arrow _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 156
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  refine (transport_const _ _ @ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply ap, transport_Vp.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 158
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments transportD' / [_] _ _ [_ _] _ _ _.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 161
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>

Lemma transportD_as_apD
  {A : Type} (B : A -&gt; Type) (C : forall a : A, B a -&gt; Type)
  {x1 x2 : A} (p : x1 = x2) (y : B x1)
: transportD B C p y == transportD' B C p y.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 167
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  intros ?; destruct p; simpl.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact 1.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 168
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 169
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** A transport lemma. *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 171
Time: 0.01s">
<div class="time" style="width: 0.1271132579128%"></div>
<pre>Definition FST_Codes_transportD_concrete (x1 : X) (p : No = No)
  : FST_Codes No p -&gt; FST_Codes So (transport (paths No) (mer x1) p).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro rr.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 174
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre> assert (goal' : FST_Codes So (p @ mer x1)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 174
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
    apply (FST_Codes_cross x1).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 175
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
    refine (transport FST_Codes_No _ rr).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 176
Time: 0.003s">
<div class="time" style="width: 0.03813397737384%"></div>
<pre> symmetry; apply concat_pp_V.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 176
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
  refine (transport FST_Codes_So _ goal').</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 177
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  apply inverse, transport_paths_r.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 178
Time: 0.006s">
<div class="time" style="width: 0.07626795474768%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 179
Time: 0.023s">
<div class="time" style="width: 0.29236049319944%"></div>
<pre>

Definition FST_Codes_transportD (x1 : X) (p : No = No) (rr : FST_Codes No p)
  : transportD (paths No) FST_Codes (mer x1) p rr
  = FST_Codes_transportD_concrete x1 p rr.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 184
Time: 0.003s">
<div class="time" style="width: 0.03813397737384%"></div>
<pre>
  refine (transportD_as_apD _ _ _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold transportD'.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 186
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
  unfold FST_Codes.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 187
Time: 0.159s">
<div class="time" style="width: 2.0211008008135%"></div>
<pre> rewrite (Susp_ind_beta_merid _ _ _ _ x1); simpl.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 187
Time: 0.013s">
<div class="time" style="width: 0.16524723528664%"></div>
<pre>
    rewrite (@ap10_path_forall (fst funext_large)).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold FST_Codes_transportD_concrete.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 189
Time: 0.096s">
<div class="time" style="width: 1.2202872759629%"></div>
<pre>
  rewrite ! transport_pp.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 190
Time: 0.026s">
<div class="time" style="width: 0.33049447057328%"></div>
<pre>
  refine (transport_path_universe _ _ @ _).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(*rewrite transport_paths_r.
  rewrite transport_as_ap.*)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 193
Time: 0.019s">
<div class="time" style="width: 0.24151519003432%"></div>
<pre>Admitted.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** Showing it is contractible, we will again need the universal property of the suspension. We will prove the components as separate lemmas first; to see the required types of these, we temporarily set up the theorem. *)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 196
Time: 0.007s">
<div class="time" style="width: 0.08897928053896%"></div>
<pre>Definition FST_Codes_contr (y : Susp X) (p : No = y) (rr : FST_Codes y p)
  : rr = FST_Codes_center y p.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert y p rr.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 199
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check (Susp_ind (fun y =&gt; forall p rr, rr = FST_Codes_center y p)).
Abort.

Definition FST_Codes_contr_No (p : No = No) (rr : FST_Codes No p)
  : (rr = FST_Codes_center No p).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  revert rr.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 205
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> apply Trunc_ind.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 205
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre> intros ?; apply trunc_succ.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 205
Time: 0.002s">
<div class="time" style="width: 0.02542265158256%"></div>
<pre>
  intros [x1 r].</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 206
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> destruct r.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold FST_Codes_center.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 206
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (*transitivity (tr
    (transport (fun p =&gt; hfiber mer' p) (transport_paths_r p 1 @ concat_1p p)
    (transportD (paths No))))
simpl in *.*)</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 210
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>Admitted.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance Freudenthal
  : IsConnMap (n -2+ n) (@merid X).</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 214
Time: 0.001s">
<div class="time" style="width: 0.01271132579128%"></div>
<pre>
  intros p; apply isconnected_from_elim; intros C ? f.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Admitted.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 216
Time: 0.282s">
<div class="time" style="width: 3.584593873141%"></div>
<pre>

End Freudenthal.</pre>
</div>
<div class="code" title="File: Freudenthal.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


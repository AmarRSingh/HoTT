<html>
<head>
<title>Bool.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Bool.v</h1>

<div class="code" title="File: Bool.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)
(** * Theorems about the booleans *)

</pre>
</div>
<div class="code" title="File: Bool.v
Line: 3
Time: 0.029s">
<div class="time" style="width: 100%"></div>
<pre>Require Import Overture Contractible Equivalences types.Prod HSet.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* coq calls it "bool", we call it "Bool" *)</pre>
</div>
<div class="code" title="File: Bool.v
Line: 6
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>Inductive Bool : Type :=
  | true : Bool
  | false : Bool.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Add Printing If Bool.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Delimit Scope bool_scope with Bool.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Bind Scope bool_scope with Bool.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition andb (b1 b2 : Bool) : Bool := if b1 then b2 else false.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition orb (b1 b2 : Bool) : Bool := if b1 then true else b2.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition negb (b : Bool) := if b then false else true.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition implb (b1 b2 : Bool) : Bool := if b1 then b2 else true.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Infix "||" := orb : bool_scope.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Infix "&amp;&amp;" := andb : bool_scope.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 25
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>

Instance trunc_if n A B `{IsTrunc n A, IsTrunc n B} (b : Bool)
: IsTrunc n (if b then A else B) | 100
  := if b as b return (IsTrunc n (if b then A else B)) then _ else _.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section BoolDecidable.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 31
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
  Definition false_ne_true : ~false = true
    := fun H =&gt; match H in (_ = y) return (if y then Empty else Bool) with
                  | 1%path =&gt; true
                end.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 35
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>

  Definition true_ne_false : ~true = false
    := fun H =&gt; false_ne_true (symmetry _ _ H).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 38
Time: 0.003s">
<div class="time" style="width: 10.344827586207%"></div>
<pre>

  Definition decidable_paths_bool : decidable_paths Bool
    := fun x y =&gt; match x as x, y as y return ((x = y) + (~x = y)) with
                    | true, true =&gt; inl idpath
                    | false, false =&gt; inl idpath
                    | true, false =&gt; inr true_ne_false
                    | false, true =&gt; inr false_ne_true
                  end.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance trunc_bool : IsHSet Bool | 0
    := hset_decidable decidable_paths_bool.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 49
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
End BoolDecidable.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section BoolForall.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable P : Bool -&gt; Type.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Let f (s : forall b, P b) := (s false, s true).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 55
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>

  Let g (u : P false * P true) (b : Bool) : P b :=
    match b with
      | false =&gt; fst u
      | true =&gt; snd u
    end.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition equiv_bool_forall_prod `{Funext} :
    (forall b, P b) &lt;~&gt; P false * P true.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 65
Time: 0.004s">
<div class="time" style="width: 13.793103448276%"></div>
<pre>
    apply (equiv_adjointify f g);
    repeat (reflexivity
              || intros []
              || intro
              || apply path_forall).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 70
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 71
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
End BoolForall.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section EquivBoolEquiv.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** We prove that the type [Bool &lt;~&gt; Bool] is equivalent to [Bool].  We first define the functions in both directoins, which identify [true] with the identity equivalence and [false] with the flip equivalence. *)

 </pre>
</div>
<div class="code" title="File: Bool.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isequiv_negb : IsEquiv negb.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 78
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
      refine (@BuildIsEquiv
                _ _
                negb negb
                (fun b =&gt; if b as b return negb (negb b) = b then idpath else idpath)
                (fun b =&gt; if b as b return negb (negb b) = b then idpath else idpath)
                _).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 84
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
      intros []; simpl; exact idpath.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 85
Time: 0.003s">
<div class="time" style="width: 10.344827586207%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We prove that equivalences [Bool &lt;~&gt; Bool] send [true] and [false] to different things. *)
 </pre>
</div>
<div class="code" title="File: Bool.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma eval_bool_isequiv (f : Bool -&gt; Bool) `{IsEquiv Bool Bool f}
  : f false = negb (f true).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (eissect f true).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose proof (eissect f false).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 93
Time: 0.003s">
<div class="time" style="width: 10.344827586207%"></div>
<pre>
    destruct (f true), (f false).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Bool.v
Line: 95
Time: 0.002s">
<div class="time" style="width: 6.8965517241379%"></div>
<pre> etransitivity; try (eassumption || (symmetry; eassumption)).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Bool.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Bool.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Bool.v
Line: 98
Time: 0.002s">
<div class="time" style="width: 6.8965517241379%"></div>
<pre> etransitivity; try (eassumption || (symmetry; eassumption)).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 98
Time: 0.003s">
<div class="time" style="width: 10.344827586207%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We identify the constant equivalence with [true] and the flip equivalence with [false], and do this by evaluating the equivalence function on [true]. *)
 </pre>
</div>
<div class="code" title="File: Bool.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Let f : Bool &lt;~&gt; Bool -&gt; Bool := fun e =&gt; e true.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 102
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
  Let g : Bool -&gt; Bool &lt;~&gt; Bool := fun b =&gt; if b
                                            then {| equiv_fun := idmap |}
                                            else {| equiv_fun := negb |}.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We can't depend on [EquivalenceVarieties] nor [Misc] here, so we take the necessary lemma as a hypothesis, and put the theorem in [Misc.v] *)
 </pre>
</div>
<div class="code" title="File: Bool.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context `{Funext}.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 108
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
  Hypothesis path_equiv : forall e1 e2 : Bool &lt;~&gt; Bool,
                            (e1 = e2 :&gt; (Bool -&gt; Bool)) -&gt; (e1 = e2 :&gt; (Bool &lt;~&gt; Bool)).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Lemma equiv_bool_equiv_bool_bool_helper : Bool &lt;~&gt; (Bool &lt;~&gt; Bool).</pre>
</div>
<div class="code" title="File: Bool.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (equiv_adjointify g f _ _);
    unfold f, g; clear f g;
    hnf; simpl.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Bool.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro e.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 116
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
      destruct e as [e ?].</pre>
</div>
<div class="code" title="File: Bool.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_equiv; try assumption.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 119
Time: 0.001s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
      intros []; simpl.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Bool.v
Line: 121
Time: 0.002s">
<div class="time" style="width: 6.8965517241379%"></div>
<pre> destruct (e true); reflexivity.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      *</pre>
</div>
<div class="code" title="File: Bool.v
Line: 122
Time: 0.002s">
<div class="time" style="width: 6.8965517241379%"></div>
<pre> etransitivity; [ | symmetry; apply eval_bool_isequiv; trivial ].</pre>
</div>
<div class="code" title="File: Bool.v
Line: 122
Time: 0.002s">
<div class="time" style="width: 6.8965517241379%"></div>
<pre>
        destruct (e true); reflexivity.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Bool.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros []; reflexivity.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 124
Time: 0.006s">
<div class="time" style="width: 20.689655172414%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 125
Time: 0.008s">
<div class="time" style="width: 27.586206896552%"></div>
<pre>
End EquivBoolEquiv.</pre>
</div>
<div class="code" title="File: Bool.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


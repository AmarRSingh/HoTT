<html>
<head>
<title>Modality.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Modality.v</h1>

<div class="code" title="File: Modality.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 1
Time: 0.042s">
<div class="time" style="width: 48.275862068966%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 1
Time: 0.012s">
<div class="time" style="width: 13.793103448276%"></div>
<pre>
Require Import ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Modalities *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 8
Time: 0.015s">
<div class="time" style="width: 17.241379310345%"></div>
<pre>Record Modality :=
  {
    msubu : UnitSubuniverse ;
    mreplete : Replete msubu ;
    O_ind : forall A (B : msubu A -&gt; Type) (B_inO : forall oa, In msubu (B oa)),
               (forall a, B (to msubu A a)) -&gt; forall a, B a ;
    O_ind_beta : forall A B B_inO (f : forall a : A, B (to msubu A a)) a,
                    O_ind A B B_inO f (to msubu A a) = f a ;
    inO_paths : forall A (A_inO : In msubu A) (z z' : A), In msubu (z = z')
  }.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments O_ind {O} {A} B {B_inO} f a : rename.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_ind_beta {O} {A} B {B_inO} f a : rename.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* We don't declare this as a coercion, since soon we're going to declare a coercion from [Modality] to [ReflectiveSubuniverse]; then we'll get this coercion automatically as a composite. *)
(* Coercion mod_usubu : Modality &gt;-&gt; UnitSubuniverse. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Existing Instance mreplete.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Global Existing Instance inO_paths.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Our definition of modality is slightly different from the one in the book, which requires an induction principle only into families of the form [fun oa =&gt; O (B oa)], and similarly only that path-spaces of types [O A] are modal, where "modal" means that the unit is an equivalence.  This is equivalent, roughly since every modal type [A] (in this sense) is equivalent to [O A].

However, our definition is more convenient in formalized applications because in some examples (such as [Trunc] and closed modalities), there is a naturally occurring [O_ind] into all modal types that is not judgmentally equal to the one that can be constructed by passing through [O] and back again.  Thus, when we apply general theorems about modalities to a particular modality such as [Trunc], the proofs will reduce definitionally to "the way we would have proved them directly" if we didn't know about general modalities.

On the other hand, in other examples (such as [~~] and open modalities) it is easier to construct the latter weaker induction principle.  Thus, we now show how to get from that to our definition of modality. *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section EasyModality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context (O' : Type -&gt; Type).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context (to_O : forall T, T -&gt; O' T).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Let inO' A := IsEquiv (to_O A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context (O_indO : forall A (B : O' A -&gt; Type),
                       (forall a, O' (B (to_O A a)))
                       -&gt; forall z, O' (B z)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 41
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>

  Context (O_indO_beta : forall A B (f : forall a, O' (B (to_O A a))) a,
      O_indO A B f (to_O A a) = f a).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context (inO_pathsO : forall A (z z' : O' A), inO' (z = z')).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Here is the defined more general induction principle. *)

 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition O_ind' A (B : O' A -&gt; Type)
        (B_inO : forall oa, inO' (B oa))
        (f : forall a, B (to_O A a))
        (oa : O' A) : B oa.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (H := B_inO oa); unfold inO' in H.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ((to_O (B oa))^-1).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply O_indO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros a; apply to_O, f.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 59
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>

  Local Definition O_ind_beta' A B {B_inO : forall oa, inO' (B oa)}
        (f : forall a : A, B (to_O A a)) a
  : O_ind' A B B_inO f (to_O A a) = f a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold O_ind'.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 65
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>
    apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply @O_indO_beta with (f := fun x =&gt; to_O _ (f x)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 67
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 68
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We start by building a [UnitSubuniverse]. *)

 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition O_inO' A : inO' (O' A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 73
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>
    refine (isequiv_adjointify (to_O (O' A))
             (O_indO (O' A) (const A) idmap) _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 76
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre> intros x; pattern x; apply O_ind'.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros oa; apply inO_pathsO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a; apply ap.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (O_indO_beta (O' A) (const A) idmap a).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros a.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_indO_beta (O' A) (const A) idmap a).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 81
Time: 0.003s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** However, it seems to be surprisingly hard to show (without univalence) that this [UnitSubuniverse] is replete.  We basically have to develop enough functoriality of [O] and naturality of [to_O].  We could do that directly, but instead we piggyback by showing that it is a reflective subuniverse.  This is why we excluded repleteness from the basic definition of [ReflectiveSubuniverse] and the proofs of functoriality. *)

 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition O : ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 87
Time: 0.041s">
<div class="time" style="width: 47.126436781609%"></div>
<pre>
    refine (Build_ReflectiveSubuniverse
              (Build_UnitSubuniverse
                 (fun T =&gt; IsEquiv (to_O T))
                 O' O_inO' to_O _)
              _ _ _ _);
      intros P Q ?.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_ind' P (fun _ =&gt; Q) (fun _ =&gt; Q_inO) f).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f x.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_ind_beta' P (fun _ =&gt; Q) f x).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros g h p x.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      cbn in Q_inO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 97
Time: 0.007s">
<div class="time" style="width: 8.0459770114943%"></div>
<pre>
      refine ((ap (to_O Q))^-1 _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 98
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>
      refine (O_ind' P (fun y =&gt; to_O Q (g y) = to_O Q (h y)) _ _ x).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply inO_pathsO.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Modality.v
Line: 101
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre> intros a; apply ap, p.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 102
Time: 0.087s">
<div class="time" style="width: 100%"></div>
<pre> intros g h p x; cbn.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 102
Time: 0.006s">
<div class="time" style="width: 6.8965517241379%"></div>
<pre>
      rewrite O_ind_beta'.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 103
Time: 0.005s">
<div class="time" style="width: 5.7471264367816%"></div>
<pre>
      rewrite concat_pp_p.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 104
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>
      apply moveR_Vp.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 105
Time: 0.007s">
<div class="time" style="width: 8.0459770114943%"></div>
<pre>
      rewrite &lt;- ap_compose.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 106
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>
      exact (concat_A1p (eissect (to_O Q)) (p x)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 107
Time: 0.057s">
<div class="time" style="width: 65.51724137931%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** It is now automatically replete, since in our case [inO] means by definition that [to_O] is an equivalence. *)

 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 112
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>Local Instance replete_rsubU : Replete O.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 113
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>
    apply replete_inO_isequiv_to_O; trivial.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 114
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Finally, we can build a modality. *)

 </pre>
</div>
<div class="code" title="File: Modality.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Build_Modality_easy : Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 119
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 120
Time: 0.041s">
<div class="time" style="width: 47.126436781609%"></div>
<pre>
    refine (Build_Modality O _ O_ind' O_ind_beta' _); cbn.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 121
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 122
Time: 0.021s">
<div class="time" style="width: 24.137931034483%"></div>
<pre>

End EasyModality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We show that modalities have underlying reflective subuniverses.  It is important in some applications, such as [Trunc], that this construction uses the general [O_ind] given as part of the modality data, and not one constructed out of [O_indO] as we did when proving [Build_Modality_easy].  For instance, this ensures that [O_functor] reduces to simply an application of [O_ind].

 Note also that our choice of how to define reflective subuniverses differently from the book enables us to prove this without using funext. *)

(** Corollary 7.7.8, part 1 *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 130
Time: 0.025s">
<div class="time" style="width: 28.735632183908%"></div>
<pre>Definition modality_to_reflective_subuniverse (O : Modality)
: ReflectiveSubuniverse
:= Build_ReflectiveSubuniverse (msubu O)
     (fun P Q H =&gt; O_ind (fun _ =&gt; Q))
     (fun P Q H =&gt; O_ind_beta (fun _ =&gt; Q))
     (fun P Q H g h =&gt; O_ind (fun y =&gt; g y = h y))
     (fun P Q H g h =&gt; O_ind_beta (fun y =&gt; g y = h y)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Coercion modality_to_reflective_subuniverse : Modality &gt;-&gt; ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Corollary 7.7.8, part 2 *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 140
Time: 0.004s">
<div class="time" style="width: 4.5977011494253%"></div>
<pre>Global Instance inO_sigma {O : Modality} (A:Type) (B:A -&gt; Type)
       `{In O A} `{forall a, In O (B a)}
: In O {x:A &amp; B x}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  generalize dependent A.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 144
Time: 0.005s">
<div class="time" style="width: 5.7471264367816%"></div>
<pre>
  refine (snd (inO_sigma_iff _) _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros A B ? g.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 146
Time: 0.004s">
<div class="time" style="width: 4.5977011494253%"></div>
<pre>
  exists (O_ind B g).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 147
Time: 0.008s">
<div class="time" style="width: 9.1954022988506%"></div>
<pre>
  apply O_ind_beta.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 148
Time: 0.005s">
<div class="time" style="width: 5.7471264367816%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Conversely, if a reflective subuniverse is closed under sigmas, it is a modality. *)

</pre>
</div>
<div class="code" title="File: Modality.v
Line: 152
Time: 0.004s">
<div class="time" style="width: 4.5977011494253%"></div>
<pre>Theorem reflective_subuniverse_to_modality
  (O : ReflectiveSubuniverse) {rep : Replete O}
  (H : forall (A:Type) (B:A -&gt; Type)
          `{In O A} `{forall a, In O (B a)},
     (In O ({x:A &amp; B x})))
  : Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 158
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>
  pose (K := fst (inO_sigma_iff _) H).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 159
Time: 0.03s">
<div class="time" style="width: 34.48275862069%"></div>
<pre>
  exact (Build_Modality _ _
           (fun A B B_inO g =&gt; pr1 (K A B B_inO g))
           (fun A B B_inO g =&gt; pr2 (K A B B_inO g))
           _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 163
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The induction principle [O_ind], like most induction principles, is an equivalence. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section OIndEquiv.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {fs : Funext} (O : Modality).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section OIndEquivData.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 169
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>

    Context {A : Type} (B : O A -&gt; Type) `{forall a, In O (B a)}.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 171
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>

    Global Instance isequiv_O_ind : IsEquiv (O_ind B).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 174
Time: 0.003s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
      apply isequiv_adjointify with (g := fun h =&gt; h oD to O A).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 175
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros h.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 176
Time: 0.053s">
<div class="time" style="width: 60.919540229885%"></div>
<pre>
        refine (O_ind (fun oa =&gt; O_ind B (h oD to O A) oa = h oa) _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 177
Time: 0.004s">
<div class="time" style="width: 4.5977011494253%"></div>
<pre>
        exact (O_ind_beta B (h oD to O A)).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_forall.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 179
Time: 0.003s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
        exact (O_ind_beta B f).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 180
Time: 0.015s">
<div class="time" style="width: 17.241379310345%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 181
Time: 0.003s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>

    Definition equiv_O_ind
    : (forall a, B (to O A a)) &lt;~&gt; (forall oa, B oa)
    := BuildEquiv _ _ (O_ind B) _.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Theorem 7.7.7 *)
   </pre>
</div>
<div class="code" title="File: Modality.v
Line: 188
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>Definition isequiv_oD_to_O
    : IsEquiv (fun (h : forall oa, B oa) =&gt; h oD to O A)
    := equiv_isequiv (equiv_inverse equiv_O_ind).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 190
Time: 0.001s">
<div class="time" style="width: 1.1494252873563%"></div>
<pre>

  End OIndEquivData.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 192
Time: 0.007s">
<div class="time" style="width: 8.0459770114943%"></div>
<pre>

  Local Definition isequiv_o_to_O (A B : Type) (B_inO : In O B)
  : IsEquiv (fun (h : O A -&gt; B) =&gt; h o to O A)
    := isequiv_oD_to_O (fun _ =&gt; B).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 196
Time: 0.002s">
<div class="time" style="width: 2.2988505747126%"></div>
<pre>

End OIndEquiv.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 198
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Finally, we give one nontrivial example of a modality.  This is Exercise 7.12 in the book. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition notnot_modality `{Funext} : Modality.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 201
Time: 0.01s">
<div class="time" style="width: 11.494252873563%"></div>
<pre>
  refine (Build_Modality_easy
            (fun X =&gt; ~~X)
            (fun X x nx =&gt; nx x)
            (fun A B f z nBz =&gt;
              z (fun a =&gt; f a (transport (fun x =&gt; ~B x)
                                          (path_ishprop _ _)
                                          nBz)))
            _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 210
Time: 0.007s">
<div class="time" style="width: 8.0459770114943%"></div>
<pre> intros; apply path_ishprop.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Modality.v
Line: 211
Time: 0.025s">
<div class="time" style="width: 28.735632183908%"></div>
<pre> intros; refine (isequiv_iff_hprop _ _).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 211
Time: 0.007s">
<div class="time" style="width: 8.0459770114943%"></div>
<pre>
    intros; apply path_ishprop.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 212
Time: 0.003s">
<div class="time" style="width: 3.448275862069%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Modality.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Of course, there is also the trivial example. *)</pre>
</div>
<div class="code" title="File: Modality.v
Line: 215
Time: 0.01s">
<div class="time" style="width: 11.494252873563%"></div>
<pre>Definition identity_modality : Modality
  := Build_Modality
     (Build_UnitSubuniverse
        (fun _ =&gt; Unit)
        idmap
        (fun _ =&gt; tt)
        (fun T =&gt; idmap)
        _)
     (fun T U _ _ _ =&gt; tt)
     (fun A B _ f a =&gt; f a)
     (fun A B _ f a =&gt; 1)
     (fun A _ z z' =&gt; tt).</pre>
</div>
<div class="code" title="File: Modality.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For more examples of modalities, see hit/Truncations.v and hit/PropositionalFracture.v. *)

</pre>
</div>
</body>
</html>


<html>
<head>
<title>UnivalenceImpliesFunext.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for UnivalenceImpliesFunext.v</h1>

<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 1
Time: 0.049s">
<div class="time" style="width: 22.790697674419%"></div>
<pre>Require Import Overture types.Universe FunextVarieties Equivalences types.Paths types.Unit.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Generalizable All Variables.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Set Implicit Arguments.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Univalence Implies Functional Extensionality *)

(** Here we prove that univalence implies function extensionality. *)

</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section UnivalenceImpliesFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Univalence}.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Exponentiation preserves equivalences, i.e., if [e] is an equivalence then so is post-composition by [e]. *)

  (* Should this go somewhere else? *)

 </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 16
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>Theorem univalence_isequiv_postcompose `{H0 : IsEquiv A B w} C : IsEquiv (@compose C A B w).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 17
Time: 0.116s">
<div class="time" style="width: 53.953488372093%"></div>
<pre>
    refine (isequiv_adjointify
              (@compose C A B w)
              (@compose C B A w^-1)%equiv
              _
              _);
    intro;
    pose (BuildEquiv _ _ w _) as w';
    change H0 with (@equiv_isequiv _ _ w');
    change w with (@equiv_fun _ _ w');
    clearbody w'; clear H0 w;
    rewrite &lt;- (@eisretr _ _ _ (@isequiv_equiv_path _ A B) w');
    generalize ((equiv_path A B)^-1 w')%equiv;
    intro p;
    clear w';
    destruct p;
    reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 33
Time: 0.013s">
<div class="time" style="width: 6.046511627907%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We are ready to prove functional extensionality, starting with the naive non-dependent version. *)

 </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 38
Time: 0.006s">
<div class="time" style="width: 2.7906976744186%"></div>
<pre>Local Instance isequiv_src_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (compose (fst o pr1)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 42
Time: 0.007s">
<div class="time" style="width: 3.2558139534884%"></div>
<pre>
    apply @univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 43
Time: 0.215s">
<div class="time" style="width: 100%"></div>
<pre>
    refine (isequiv_adjointify
              (fst o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 51
Time: 0.042s">
<div class="time" style="width: 19.53488372093%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 52
Time: 0.007s">
<div class="time" style="width: 3.2558139534884%"></div>
<pre>


  Local Instance isequiv_tgt_compose A B
  : @IsEquiv (A -&gt; {xy : B * B &amp; fst xy = snd xy})
             (A -&gt; B)
             (compose (snd o pr1)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 59
Time: 0.007s">
<div class="time" style="width: 3.2558139534884%"></div>
<pre>
    apply @univalence_isequiv_postcompose.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 60
Time: 0.209s">
<div class="time" style="width: 97.209302325581%"></div>
<pre>
    refine (isequiv_adjointify
              (snd o pr1) (fun x =&gt; ((x, x); idpath))
              (fun _ =&gt; idpath)
              _);
      let p := fresh in
      intros [[? ?] p];
        simpl in p; destruct p;
        reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 68
Time: 0.021s">
<div class="time" style="width: 9.7674418604651%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Theorem Univalence_implies_FunextNondep (A B : Type)
  : forall f g : A -&gt; B, f == g -&gt; f = g.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros f g p.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** Consider the following maps. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 76
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>pose (d := fun x : A =&gt; existT (fun xy =&gt; fst xy = snd xy) (f x, f x) (idpath (f x))).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 76
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    pose (e := fun x : A =&gt; existT (fun xy =&gt; fst xy = snd xy) (f x, g x) (p x)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** If we compose [d] and [e] with [free_path_target], we get [f] and [g], respectively. So, if we had a path from [d] to [e], we would get one from [f] to [g]. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 79
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>change f with ((snd o pr1) o d).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 79
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
    change g with ((snd o pr1) o e).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 80
Time: 0.009s">
<div class="time" style="width: 4.1860465116279%"></div>
<pre>
    apply ap.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** Since composition with [src] is an equivalence, we can freely compose with [src]. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 83
Time: 0.013s">
<div class="time" style="width: 6.046511627907%"></div>
<pre>pose (fun A B x y=&gt; @equiv_inv _ _ _ (@isequiv_ap _ _ _ (@isequiv_src_compose A B) x y)) as H'.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 83
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
    apply H'.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 84
Time: 0.01s">
<div class="time" style="width: 4.6511627906977%"></div>
<pre>
    reflexivity.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 85
Time: 0.016s">
<div class="time" style="width: 7.4418604651163%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 86
Time: 0.009s">
<div class="time" style="width: 4.1860465116279%"></div>
<pre>
End UnivalenceImpliesFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section UnivalenceImpliesWeakFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{ua1 : Univalence, ua2 : Univalence}.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (** Now we use this to prove weak funext, which as we know implies (with dependent eta) also the strong dependent funext. *)

 </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Theorem Univalence_implies_WeakFunext : WeakFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros A P allcontr.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** We are going to replace [P] with something simpler. *)
   </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>pose (U := (fun (_ : A) =&gt; Unit)).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assert (p : P = U).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 99
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre> apply Univalence_implies_FunextNondep.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro x.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (@path_universe_uncurried ua1).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_contr_unit.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (** Now this is much easier. *)
     </pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 104
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>rewrite p.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold U; simpl.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exists (fun _ =&gt; tt).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro f.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 107
Time: 0.001s">
<div class="time" style="width: 0.46511627906977%"></div>
<pre>
      apply (@Univalence_implies_FunextNondep ua2).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro x.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 109
Time: 0.002s">
<div class="time" style="width: 0.93023255813953%"></div>
<pre>
      exact (@contr Unit _ _).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 110
Time: 0.004s">
<div class="time" style="width: 1.8604651162791%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End UnivalenceImpliesWeakFunext.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 112
Time: 0.003s">
<div class="time" style="width: 1.3953488372093%"></div>
<pre>

Definition Univalence_implies_Funext `{ua1 : Univalence, ua2 : Univalence} : Funext
  := WeakFunext_implies_Funext (@Univalence_implies_WeakFunext ua1 ua2).</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Immediate Univalence_implies_Funext : typeclass_instances.</pre>
</div>
<div class="code" title="File: UnivalenceImpliesFunext.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


<html>
<head>
<title>ReflectiveSubuniverse.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ReflectiveSubuniverse.v</h1>

<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.027s">
<div class="time" style="width: 27.272727272727%"></div>
<pre>Require Import Overture PathGroupoids HProp Equivalences EquivalenceVarieties.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.01s">
<div class="time" style="width: 10.10101010101%"></div>
<pre>
Require Import types.Empty types.Unit types.Arrow types.Sigma types.Paths
        types.Forall types.Prod types.Universe types.ObjectClassifier.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Reflective Subuniverses *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {ua : Univalence}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {fs : Funext}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** A reflective subuniverse is the data of : *)

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 15
Time: 0.013s">
<div class="time" style="width: 13.131313131313%"></div>
<pre>Record ReflectiveSubuniverse :=
    { 
      (** a predicate [U -&gt; Prop] *)
      in_subuniverse : Type -&gt; hProp ;
      (** we define the type of modal types *)
      SubuniverseType := {T : Type &amp; (in_subuniverse) T} ;
      (** for every type [T], a type [O T] such that [in_subuniverse (O T)] *)
      to_O : Type -&gt; SubuniverseType ; 
      (** for every type [T], a map [A -&gt; O T] *)
      O_unit : forall T, T -&gt; (to_O T).1; 
      (** an equivalence [((O P)-&gt;Q) &lt;~&gt; (P -&gt; Q)] *)
      O_isequiv : forall (P : Type) (Q : SubuniverseType), 
                  IsEquiv (fun f : (to_O P).1 -&gt; Q.1 =&gt; f o (@O_unit P)) 
    }.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Notation O := to_O.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 30
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>

  Coercion SubuniverseType_pr1 subU (T:SubuniverseType subU) := @pr1 Type subU.(in_subuniverse) T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The equivalence arising from [O_isequiv] *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 35
Time: 0.006s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>Definition O_equiv {subU} (P : Type) (Q : SubuniverseType subU)
    : (subU.(O) P -&gt; Q) &lt;~&gt; (P -&gt; Q)
    := BuildEquiv _ _ (fun f =&gt; f o (O_unit subU P)) (O_isequiv subU P Q).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Some shortcuts to manipulate the above equivalence.  Here is a "recursor" for [O]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 40
Time: 0.006s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>Definition O_rec {subU} (P : Type) (Q : SubuniverseType subU)
    : (P -&gt; Q) -&gt; (subU.(O) P) -&gt; Q
    := (O_equiv P Q)^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Here is its "computation rule" *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 45
Time: 0.009s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>Definition O_rec_retr {subU} (P : Type) (Q : SubuniverseType subU) f
    : O_rec _ _ f o subU.(O_unit) _ = f
    := @eisretr _ _ _ (subU.(O_isequiv) P Q) f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Versions of [O_rec_retr] with [compose] unfolded and that are
     further pre- or post-composed with another function.  This
     enables [rewrite] to recognize them. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 52
Time: 0.011s">
<div class="time" style="width: 11.111111111111%"></div>
<pre>Definition O_rec_retr' {subU} (P : Type) (Q : SubuniverseType subU) f
    : (fun x =&gt; O_rec _ _ f (subU.(O_unit) _ x)) = f
    := O_rec_retr P Q f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 54
Time: 0.014s">
<div class="time" style="width: 14.141414141414%"></div>
<pre>
  Definition O_rec_retr'_pre {subU} (P A : Type) (Q : SubuniverseType subU) f (g : A -&gt; P)
    : (fun x =&gt; O_rec _ _ f (subU.(O_unit) _ (g x))) = f o g
    := ap (fun k =&gt; k o g) (O_rec_retr P Q f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 57
Time: 0.015s">
<div class="time" style="width: 15.151515151515%"></div>
<pre>
  Definition O_rec_retr'_post {subU} (P B : Type) (Q : SubuniverseType subU) f (h : Q -&gt; B)
    : (fun x =&gt; h (O_rec _ _ f (subU.(O_unit) _ x))) = h o f
    := ap (fun k =&gt; h o k) (O_rec_retr P Q f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 60
Time: 0.015s">
<div class="time" style="width: 15.151515151515%"></div>
<pre>
  Definition O_rec_retr'_prepost {subU} (P A B : Type) (Q : SubuniverseType subU) f (g : A -&gt; P) (h : Q -&gt; B)
    : (fun x =&gt; h (O_rec _ _ f (subU.(O_unit) _ (g x)))) = h o f o g
    := ap (fun k =&gt; h o k o g) (O_rec_retr P Q f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 63
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** And a tactic that tries them all *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Ltac rewrite_O_rec_retr :=
    repeat first
      [ unfold compose; rewrite O_rec_retr'
        | unfold compose; rewrite O_rec_retr'_post
        | unfold compose; rewrite O_rec_retr'_pre
        | unfold compose; rewrite O_rec_retr'_prepost
      ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Here is the "uniqueness rule" for the "recursor" *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 75
Time: 0.01s">
<div class="time" style="width: 10.10101010101%"></div>
<pre>Definition O_rec_sect {subU} (P : Type) (Q : SubuniverseType subU) f
    : O_rec _ _ (f o subU.(O_unit) _) = f
    := @eissect _ _ _ (subU.(O_isequiv) P Q) f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Basic_facts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 79
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Variable subU : ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The second component of [subuniverse_Type] is unique *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 84
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>Definition path_SubuniverseType
    : forall (T T' : SubuniverseType subU), T.1 = T'.1 -&gt; T = T'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 86
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
      intros [T h] [T' h'] X.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 87
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply (path_sigma _ _ _ X).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 88
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply allpath_hprop.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 89
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The subuniverse structure is transportable *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 93
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>Definition ReflectiveSubuniverse_transport T U (f : T &lt;~&gt; U)
    : (subU.(in_subuniverse) T) -&gt; (subU.(in_subuniverse) U)
    := transport (in_subuniverse subU) (path_universe_uncurried f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
    (** Unit maps are equivalences iff they admit a retraction *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 98
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>Definition O_unit_retract_isequiv (T:Type) (mu : (subU.(O) T) -&gt; T) (eta := subU.(O_unit) T)
    : Sect eta mu -&gt; IsEquiv eta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold Sect; intros H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 101
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre> apply isequiv_adjointify with (g:=mu).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 102
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre> assert (X : eta o mu o eta = idmap o eta).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 102
Time: 0.008s">
<div class="time" style="width: 8.0808080808081%"></div>
<pre>
        apply (ap (fun g =&gt; eta o g)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (path_forall _ _ H).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 104
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
        apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 105
Time: 0.02s">
<div class="time" style="width: 20.20202020202%"></div>
<pre>
        apply ((ap (O_equiv T (O subU T)))^-1); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 106
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
        exact X.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 108
Time: 0.012s">
<div class="time" style="width: 12.121212121212%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** A type is modal if and only if its unit map is an equivalence : *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 113
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>Instance isequiv_O_unit (P : SubuniverseType subU)
    : IsEquiv (subU.(O_unit) P).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 115
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply O_unit_retract_isequiv with (mu := (O_rec P P idmap)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 116
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
      exact (ap10 (O_rec_retr P P idmap)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 117
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 118
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

    Definition equiv_O_unit (P : SubuniverseType subU)
      : P &lt;~&gt; subU.(O) P
      := (BuildEquiv _ _ (subU.(O_unit) P) (isequiv_O_unit _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 122
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>

    Definition O_modal (T:SubuniverseType subU)
    : T = subU.(O) T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_SubuniverseType.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
      apply path_universe_uncurried.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 128
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply equiv_O_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 129
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 130
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>

    Definition O_unit_isequiv_iff_modal (T:Type)
    : IsEquiv (subU.(O_unit) T) &lt;-&gt; (subU.(in_subuniverse) T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      split.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros e.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 136
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply (ReflectiveSubuniverse_transport (O subU T)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply equiv_inverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 138
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          eexists; exact e.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact ((O subU T).2).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros X; exact (isequiv_O_unit (T;X)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 141
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 142
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (* Hence, a type is modal if its unit admits a retraction. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 145
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre>Definition O_unit_retract_modal (T:Type) (mu : (subU.(O) T) -&gt; T) (eta := subU.(O_unit) T) (iss : Sect eta mu)
    : subU.(in_subuniverse) T
    := fst (O_unit_isequiv_iff_modal T) (O_unit_retract_isequiv T mu iss).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The modality is idempotent *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 150
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>Definition O_idempotent
    : forall T, (O subU) (((O subU) T)) = O subU T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 152
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
      intro T; symmetry; apply O_modal.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 153
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** A little commutation property between [O_rec] and [eta] *)
    
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 158
Time: 0.034s">
<div class="time" style="width: 34.343434343434%"></div>
<pre>Definition O_rec_O_unit (A : SubuniverseType subU) (B : Type)
               (f : B -&gt; A) (x : (O subU B))
    : O_unit subU A (O_rec B A f x) = O_rec B (O subU A) ((O_unit subU A) o f) x
      :=  (((fun U =&gt; (ap10 (O_rec_sect B (O subU A) U) x))
              (O_unit subU A o O_rec B A f))^)
            @ ((ap (fun u =&gt; O_rec B (O subU A)
                                   (O_unit subU A o u) x)
                   (inverse (O_rec_retr B A f)))^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The universal property commutes with [eta] *)
    
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 169
Time: 0.01s">
<div class="time" style="width: 10.10101010101%"></div>
<pre>Definition path_arrow_modal (A:Type) (B:SubuniverseType subU)
      (f g:(O subU A) -&gt; B) (eta := O_unit subU A)
      : ((f o eta = g o eta) -&gt; (f=g))
      := @equiv_inj _ _ _ (O_isequiv subU A B) _ _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 172
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre>
    
    Definition ap10_path_arrow_modal (A:Type) (B:SubuniverseType subU) (f g:(O subU A) -&gt; B)
               (eta := O_unit subU A) (pi : (f o eta = g o eta))
    : forall a, ap10 (path_arrow_modal A B _ _ pi) (eta a) = ap10 pi a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 178
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre>
      refine ((ap_ap10_L _ _ eta (path_arrow_modal A B f g pi) a) ^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 179
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre>
      apply (ap (fun h =&gt; ap10 h a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold path_arrow_modal, equiv_inj.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 181
Time: 0.01s">
<div class="time" style="width: 10.10101010101%"></div>
<pre>
      apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 182
Time: 0.05s">
<div class="time" style="width: 50.505050505051%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 183
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

  End Basic_facts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** In this section, we see that [O] is a functor. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Variable subU : ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 190
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
    
    Definition O_functor (A B : Type) (f : A -&gt; B)
    : (subU.(O) A) -&gt; (subU.(O) B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 194
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply O_rec; intro x; apply subU.(O_unit); apply f; exact x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (* What is this for? *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 199
Time: 0.009s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>Definition O_functor_modal_square (A : Type) (B : SubuniverseType subU) (f : A -&gt; B)
    : ((equiv_O_unit _ B) ^-1)  o  (O_functor A B f)  o  (subU.(O_unit) A)
      =  f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 202
Time: 0.032s">
<div class="time" style="width: 32.323232323232%"></div>
<pre>
      apply path_arrow; intro x; unfold compose, O_functor; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 203
Time: 0.004s">
<div class="time" style="width: 4.040404040404%"></div>
<pre>
      pose ((ap10 ((O_rec_retr A (subU.(O) B)) ((O_unit subU B) o f)) x)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 204
Time: 0.029s">
<div class="time" style="width: 29.292929292929%"></div>
<pre>
      exact (transport (fun U =&gt; O_rec B B (fun x : B =&gt; x) U = f x)
                       ((ap10 ((O_rec_retr A (subU.(O) B)) ((O_unit subU B) o f)) x)^)
                       (ap10 (O_rec_retr B B idmap) (f x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 207
Time: 0.013s">
<div class="time" style="width: 13.131313131313%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on composition *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 211
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>Definition O_functor_compose (A B C : Type) ( f : A -&gt; B) (g : B -&gt; C)
    : (O_functor A C (g o f)) = (O_functor B C g) o (O_functor A B f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 213
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply path_arrow_modal; unfold O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 214
Time: 0.019s">
<div class="time" style="width: 19.191919191919%"></div>
<pre>
      rewrite_O_rec_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 216
Time: 0.006s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Hence functoriality on commutative squares *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 220
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>Definition O_functor_square (A B C X : Type) (pi1 : X -&gt; A) (pi2 : X -&gt; B)
               (f : A -&gt; C) (g : B -&gt; C) (comm : (f o pi1) = (g o pi2))
    : ( (O_functor A C f) o (O_functor X A pi1) )
      = ( (O_functor B C g) o (O_functor X B pi2) ).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 223
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 224
Time: 0.022s">
<div class="time" style="width: 22.222222222222%"></div>
<pre>
      path_via (O_functor X C (f o pi1)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 226
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> symmetry; apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 227
Time: 0.022s">
<div class="time" style="width: 22.222222222222%"></div>
<pre> path_via (O_functor X C (g o pi2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap; exact comm.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 229
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 230
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>

  End Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Variable subU : ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** The [Unit] type *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma in_subuniverse_unit : (subU.(in_subuniverse) Unit).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 240
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply O_unit_retract_modal with (mu := fun x:(subU.(O) Unit) =&gt; tt).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (@contr Unit _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
    (** ** Dependent product and arrows *)
    (** Theorem 7.7.2 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition in_subuniverse_forall (A:Type) (B:A -&gt; Type) 
    : (forall x, (subU.(in_subuniverse) (B x)))
      -&gt; ((subU.(in_subuniverse)) (forall x:A, (B x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 251
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (ev := fun x =&gt; (fun (f:(forall x, (B x))) =&gt; f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 252
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      pose (zz := fun x:A =&gt; O_rec _ (B x; H x) (ev x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 253
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      apply O_unit_retract_modal with (mu := fun z =&gt; fun x =&gt; zz x z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro phi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold zz, ev; clear zz; clear ev.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 257
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      pose (foo := O_rec_retr _ (B x; H x) (fun f : forall x0, (B x0) =&gt; f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 258
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      exact (ap10 foo phi).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 259
Time: 0.004s">
<div class="time" style="width: 4.040404040404%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 260
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition in_subuniverse_arrow (A : Type) (B : SubuniverseType subU)
    : (in_subuniverse subU (A -&gt; B)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply in_subuniverse_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact B.2.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Product *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 270
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>Definition in_subuniverse_prod (A B : SubuniverseType subU)
    : (in_subuniverse subU (A*B)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 272
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
      apply O_unit_retract_modal with
        (mu := fun X =&gt; (O_rec (A * B) A fst X , O_rec (A * B) B snd X)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 274
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
      intros [a b]; apply path_prod; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 276
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre> exact (ap10 (O_rec_retr (A * B) A fst) (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 277
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre> exact (ap10 (O_rec_retr (A * B) B snd) (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 277
Time: 0.009s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre> 
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** We show that [OA*OB] has the same universal property as [O(A*B)] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 281
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>Lemma equiv_O_prod_rect (A B : Type) (C : SubuniverseType subU)
    : ((O subU A)*(O subU B) -&gt; C) &lt;~&gt; (A * B -&gt; C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 283
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (equiv_compose' (equiv_uncurry A B C)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 284
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
      refine (equiv_compose' _ (equiv_inverse (equiv_uncurry (O subU A) (O subU B) C))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 285
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
      apply (equiv_compose' (O_equiv A (B -&gt; C ; in_subuniverse_arrow B C))); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_postcompose'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_equiv B C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 288
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** TODO : [O(A*B) = OA * OB] *)

    (** ** Dependent sums *)
    (** Theorem 7.7.4 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 295
Time: 0.004s">
<div class="time" style="width: 4.040404040404%"></div>
<pre>Definition in_subuniverse_sigma_iff
    : (forall (A:SubuniverseType subU) (B:A -&gt; SubuniverseType subU),
         (in_subuniverse subU ({x:A &amp; B x})))
      &lt;-&gt;
      (forall (A:Type) (B: (O subU A) -&gt; SubuniverseType subU)
              (g : forall (a:A), (B (O_unit subU A a))),
         {f : forall (z:(O subU A)), (B z) &amp; forall a:A, f (O_unit subU A a) = g a}).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      split.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A B g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 304
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
        pose (Z := (sigT B ; H (O subU A) B) : SubuniverseType subU).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 305
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
        pose (g' := (fun a:A =&gt; (O_unit subU A a ; g a)) : A -&gt; Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        pose (f' := O_rec _ _ g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 307
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
        pose (eqf := (O_rec_retr _ _ g')  : f' o O_unit subU A = g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 308
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre>
        pose (eqid := path_arrow_modal subU A (O subU A) (pr1 o f') idmap
                        (ap (fun k =&gt; pr1 o k) eqf)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 310
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
        exists (fun z =&gt; transport B (ap10 eqid z) ((f' z).2)); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold eqid.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 312
Time: 0.013s">
<div class="time" style="width: 13.131313131313%"></div>
<pre> rewrite ap10_path_arrow_modal.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 312
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
        refine (_ @ pr2_path (ap10 (O_rec_retr A Z g') a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 313
Time: 0.007s">
<div class="time" style="width: 7.0707070707071%"></div>
<pre>
        apply (ap (fun p =&gt; transport B p _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 314
Time: 0.007s">
<div class="time" style="width: 7.0707070707071%"></div>
<pre>
        exact ((ap_ap10 (f' o O_unit subU A) g' pr1 eqf a)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros H A B.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 316
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>
        pose (h := fun x =&gt; O_rec ({x:A &amp; B x}) A pr1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 317
Time: 0.004s">
<div class="time" style="width: 4.040404040404%"></div>
<pre>
        pose (p := (fun z =&gt; ap10 (O_rec_retr ({x : A &amp; B x}) A pr1) z)
                : h o (O_unit _ _) == pr1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 319
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre>
        pose (g := fun z =&gt; (transport B ((p z)^) z.2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 320
Time: 0.012s">
<div class="time" style="width: 12.121212121212%"></div>
<pre>
        simpl in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 321
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre>
        specialize (H ({x:A &amp; B x}) (B o h) g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 322
Time: 0.008s">
<div class="time" style="width: 8.0808080808081%"></div>
<pre>
        destruct H as [f q].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 323
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
        apply O_unit_retract_modal with (mu := fun w =&gt; (h w; f w)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 324
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
        intros [x1 x2].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 325
Time: 0.004s">
<div class="time" style="width: 4.040404040404%"></div>
<pre>
        refine (path_sigma B _ _ _ _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 327
Time: 0.003s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> apply p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 328
Time: 0.008s">
<div class="time" style="width: 8.0808080808081%"></div>
<pre> rewrite (q (x1;x2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 328
Time: 0.024s">
<div class="time" style="width: 24.242424242424%"></div>
<pre>
          unfold g; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 329
Time: 0.002s">
<div class="time" style="width: 2.020202020202%"></div>
<pre> exact (transport_pV B _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 329
Time: 0.099s">
<div class="time" style="width: 100%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Paths *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 334
Time: 0.001s">
<div class="time" style="width: 1.010101010101%"></div>
<pre>Definition in_subuniverse_paths (S:SubuniverseType subU) (x y:S)
    : (in_subuniverse subU (x=y)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (O_unit_retract_modal subU _ _ _); intro u.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (p : (fun _:(O subU (x=y)) =&gt; x) = (fun _=&gt; y)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
        {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 339
Time: 0.009s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre> apply ((ap (O_equiv (x=y) S))^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 339
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply path_arrow; intro v.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact v.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (ap10 p u).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 342
Time: 0.013s">
<div class="time" style="width: 13.131313131313%"></div>
<pre>
        rewrite &lt;- ap_ap10_L.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 343
Time: 0.019s">
<div class="time" style="width: 19.191919191919%"></div>
<pre>
        rewrite eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 344
Time: 0.005s">
<div class="time" style="width: 5.0505050505051%"></div>
<pre> 
        rewrite ap10_path_arrow; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 345
Time: 0.062s">
<div class="time" style="width: 62.626262626263%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 346
Time: 0.004s">
<div class="time" style="width: 4.040404040404%"></div>
<pre>
    
  End Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 348
Time: 0.097s">
<div class="time" style="width: 97.979797979798%"></div>
<pre>
End Reflective_Subuniverse.</pre>
</div>
</body>
</html>


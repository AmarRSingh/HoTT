<html>
<head>
<title>ReflectiveSubuniverse.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ReflectiveSubuniverse.v</h1>

<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2
Time: 0.042s">
<div class="time" style="width: 38.532110091743%"></div>
<pre>Require Import Overture PathGroupoids HProp Equivalences EquivalenceVarieties
        UnivalenceImpliesFunext Functorish.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 3
Time: 0.008s">
<div class="time" style="width: 7.3394495412844%"></div>
<pre>
Require Import types.Empty types.Unit types.Arrow types.Sigma types.Paths
        types.Forall types.Prod types.Universe ObjectClassifier.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Reflective Subuniverses *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Unit_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** A UnitSubuniverse is the common underlying structure of a reflective subuniverse and a modality.  It consists of: *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 14
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Class UnitSubuniverse :=
    {
      (** an endomorphism [O] of [Type], and *)
      O : Type -&gt; Type ;
      (** maps [T -&gt; O T] for all [T]. *)
      O_unit : forall T, T -&gt; O T
    }.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We made [UnitSubuniverse] into a typeclass, rather than just a record, so that when there is an assumed one around it doesn't need to be given explicitly as an argument to everything.  You should *not* ever declare a global [Instance] of [UnitSubuniverse].  The things to do with it are:

  1. Assume an arbitrary one for the purposes of general theory, as we will do here.  In this case it is a variable in the context, so typeclass resolution finds it automatically.

  2. Construct a specific one, such as n-types.  You should not define it as a global instance: use [Definition] or [Local Instance].  That way someone else can import your file and still be able to talk about subuniverses other than yours.  (If they do want to use yours, then they can declare it with [Local Existing Instance].)

  3. Apply general theory to a specific example explicitly.  This requires giving the specific example, defined as above, as an explicit argument to the general functions and theorems.

  4. Specify locally that we will be applying the general theory of subuniverses only to a specific example, by declaring that example as a [Local Instance].  (If the subuniverse in question has already been defined somewhere else, you can declare it as an instance locally with [Local Existing Instance].)  This way the instance won't outlast the containing section, module, or file, but inside that section, module, or file, you won't have to give it as an explicit argument.

  The same considerations will apply to [ReflectiveSubuniverse] and [Modality].
  *)

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Context {subU : UnitSubuniverse}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The property of being in the subuniverse.  This is a more usual sort of typeclass, to be inferred automatically in many cases.  Note, however, that you shouldn't write [`{inO A}], since the generalizing binders will then introduce a *new* [UnitSubuniverse] hypothesis rather than using the one you intend; write [{A_inO : inO A}] instead.  *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 38
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Class inO (T : Type) :=
    isequiv_inO : IsEquiv (O_unit T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Typeclasses Transparent inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Global Existing Instance isequiv_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 42
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>

  Definition equiv_O_unit (T : Type) {T_inO : inO T} : T &lt;~&gt; O T
    := BuildEquiv T (O T) (O_unit T) T_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 45
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>

  Global Instance hprop_inO `{Funext} (T : Type) : IsHProp (inO T) := _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Being in the universe transports along equivalences, by univalence *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 50
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>Definition inO_equiv_inO `{Univalence} (T : Type) {U : Type} {T_inO : inO T} (f : T &lt;~&gt; U)
    : inO U
    := transport inO (path_universe f) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
  (** The type of types in the subuniverse *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition TypeO : Type
    := {T : Type &amp; inO T}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Coercion TypeO_pr1 (T : TypeO) := @pr1 Type inO T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The second component of [TypeO] is unique *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 61
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Definition path_TypeO `{Funext}
    : forall (T T' : TypeO), T.1 = T'.1 -&gt; T = T'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 63
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
    intros [T h] [T' h'] X.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply (path_sigma _ _ _ X).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 65
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
    apply allpath_hprop.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 66
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 67
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>

End Unit_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


Section Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 72
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {ua : Univalence}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** A reflective subuniverse is a subuniverse with unit, as above,
     for which the unit has a universal property. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 77
Time: 0.01s">
<div class="time" style="width: 9.1743119266055%"></div>
<pre>Class ReflectiveSubuniverse :=
    {
      (** The underlying [UnitSubuniverse] *)
      rsubu_usubu : UnitSubuniverse ;
      (** [O T] is in the subuniverse for all [T] *)
      O_inO : forall T, inO (O T) ;
      (** an equivalence [((O P)-&gt;Q) &lt;~&gt; (P -&gt; Q)] *)
      isequiv_o_O_unit : forall (P Q : Type) (Q_inO : inO Q), 
                  IsEquiv (fun f : O P -&gt; Q =&gt; f o O_unit P)
    }.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Existing Instance rsubu_usubu.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Coercion rsubu_usubu : ReflectiveSubuniverse &gt;-&gt; UnitSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Global Existing Instance O_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Global Existing Instance isequiv_o_O_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context {subU : ReflectiveSubuniverse}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section ORec.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Context (P Q : Type) {Q_inO : inO Q}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The equivalence arising from [isequiv_o_O_unit] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 100
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>Definition equiv_O_rectnd : (O P -&gt; Q) &lt;~&gt; (P -&gt; Q)
      := BuildEquiv _ _ (fun f =&gt; f o (O_unit P)) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
    (** Some shortcuts to manipulate the above equivalence.  Here is a "recursor" for [O]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 104
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Definition O_rectnd : (P -&gt; Q) -&gt; (O P) -&gt; Q
      := equiv_O_rectnd^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Context (f : P -&gt; Q).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Here is its "computation rule". *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 110
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Definition O_rectnd_retr : O_rectnd f o O_unit _ = f
      := eisretr equiv_O_rectnd f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Versions of [O_rectnd_retr] with [compose] unfolded and that are further pre- or post-composed with another function.  This enables [rewrite] to recognize them. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 114
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Definition O_rectnd_retr' : (fun x =&gt; O_rectnd f (O_unit _ x)) = f
      := O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 115
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
    Definition O_rectnd_retr'_pre (A : Type) (g : A -&gt; P)
      : (fun x =&gt; O_rectnd f (O_unit _ (g x))) = f o g
      := ap (fun k =&gt; k o g) O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 118
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
    Definition O_rectnd_retr'_post (B : Type) (h : Q -&gt; B)
      : (fun x =&gt; h (O_rectnd f (O_unit _ x))) = h o f
      := ap (fun k =&gt; h o k) O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 121
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
    Definition O_rectnd_retr'_prepost (A B : Type) (g : A -&gt; P) (h : Q -&gt; B)
      : (fun x =&gt; h (O_rectnd f (O_unit _ (g x)))) = h o f o g
      := ap (fun k =&gt; h o k o g) O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** And here is the "uniqueness rule" for the "recursor" *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 127
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>Definition O_rectnd_sect (f : O P -&gt; Q) : O_rectnd (f o O_unit _) = f
      := eissect equiv_O_rectnd f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 128
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>

  End ORec.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Here is a tactic that tries all the forms of [O_rectnd_retr]. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Ltac rewrite_O_rectnd_retr :=
    repeat first
      [ unfold compose; rewrite O_rectnd_retr'
        | unfold compose; rewrite O_rectnd_retr'_post
        | unfold compose; rewrite O_rectnd_retr'_pre
        | unfold compose; rewrite O_rectnd_retr'_prepost
      ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Basic_facts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
    (** [T] is in the subuniverse as soon as [O_unit T] admits a retraction. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 144
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Definition inO_unit_retract (T:Type) (mu : O T -&gt; T)
    : Sect (O_unit T) mu -&gt; inO T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold Sect; intros H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply isequiv_adjointify with (g:=mu).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 148
Time: 0.009s">
<div class="time" style="width: 8.256880733945%"></div>
<pre>
        apply ((ap (equiv_O_rectnd T (O T)))^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 149
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
        apply path_arrow; intros x; unfold compose; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (ap (O_unit T) (H x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 152
Time: 0.009s">
<div class="time" style="width: 8.256880733945%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Injectivity of composing with the unit. *)
    
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 157
Time: 0.007s">
<div class="time" style="width: 6.4220183486239%"></div>
<pre>Definition path_arrow_modal {A B : Type} {BinO : inO B} (f g : O A -&gt; B)
      : ((f o O_unit A = g o O_unit A) -&gt; (f = g))
      := @equiv_inj _ _ (equiv_O_rectnd A B) _ _ _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 159
Time: 0.006s">
<div class="time" style="width: 5.5045871559633%"></div>
<pre>
    
    Definition ap10_path_arrow_modal {A B : Type} {BinO : inO B} (f g : O A -&gt; B)
               (pi : f o O_unit A = g o O_unit A)
    : forall a, ap10 (path_arrow_modal _ _ pi) (O_unit _ a) = ap10 pi a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 165
Time: 0.008s">
<div class="time" style="width: 7.3394495412844%"></div>
<pre>
      refine ((ap10_ap_precompose (O_unit _) (path_arrow_modal f g pi) a) ^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 166
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
      apply (ap (fun h =&gt; ap10 h a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 167
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold path_arrow_modal, equiv_inj.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 168
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
      apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 169
Time: 0.014s">
<div class="time" style="width: 12.844036697248%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 170
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>

  End Basic_facts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** In this section, we see that [O] is a functor. *)
    
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 178
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Definition O_functor {A B : Type} (f : A -&gt; B) : O A -&gt; O B.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_rectnd.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 180
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro x; exact (O_unit B (f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 182
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (* What is this for? *)
    (* Definition O_functor_modal_square (A : Type) (B : SubuniverseType subU) (f : A -&gt; B)
    : ((equiv_O_unit _ B) ^-1)  o  (O_functor A B f)  o  (subU.(O_unit) A)
      =  f.
    Proof.
      apply path_arrow; intro x; unfold compose, O_functor; simpl.
      pose ((ap10 ((O_rectnd_retr A (subU.(O) B)) ((O_unit subU B) o f)) x)^).
      exact (transport (fun U =&gt; O_rectnd B B (fun x : B =&gt; x) U = f x)
                       ((ap10 ((O_rectnd_retr A (subU.(O) B)) ((O_unit subU B) o f)) x)^)
                       (ap10 (O_rectnd_retr B B idmap) (f x))).
    Defined.
     *)

    (** Functoriality on composition *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 199
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Definition O_functor_compose {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
    : (O_functor (g o f)) = (O_functor g) o (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 201
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      apply path_arrow_modal; unfold O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 202
Time: 0.019s">
<div class="time" style="width: 17.43119266055%"></div>
<pre>
      rewrite_O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 204
Time: 0.009s">
<div class="time" style="width: 8.256880733945%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Hence functoriality on commutative squares *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 208
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>Definition O_functor_square {A B C X : Type} (pi1 : X -&gt; A) (pi2 : X -&gt; B)
               (f : A -&gt; C) (g : B -&gt; C) (comm : (f o pi1) = (g o pi2))
    : ( (O_functor f) o (O_functor pi1) )
      = ( (O_functor g) o (O_functor pi2) ).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 212
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
      transitivity (O_functor (f o pi1)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 214
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre> symmetry; apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 215
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre> transitivity (O_functor (g o pi2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap; exact comm.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 217
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre> apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 217
Time: 0.006s">
<div class="time" style="width: 5.5045871559633%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on identities *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_functor_idmap (A : Type)
    : @O_functor A A idmap = idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 223
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      apply path_arrow_modal; unfold O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 224
Time: 0.006s">
<div class="time" style="width: 5.5045871559633%"></div>
<pre>
      rewrite_O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 226
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Which implies preservation of equivalences *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 230
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Global Instance O_functorish : Functorish O
      := Build_Functorish O _ _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact @O_functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 233
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 235
Time: 0.007s">
<div class="time" style="width: 6.4220183486239%"></div>
<pre>

    Global Instance isequiv_O_functor `{Univalence}
      {A B} (f : A -&gt; B) `{IsEquiv _ _ f}
    : IsEquiv (O_functor f)
    := isequiv_fmap O f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 240
Time: 0.014s">
<div class="time" style="width: 12.844036697248%"></div>
<pre>

    Definition equiv_O_functor `{Univalence} {A B} (f : A &lt;~&gt; B)
    : O A &lt;~&gt; O B
    := BuildEquiv _ _ (O_functor f) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Naturality of [O_unit] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 247
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>Definition O_unit_natural {A B} (f : A -&gt; B)
    : (O_functor f) o (O_unit A) = (O_unit B) o f
    := (O_rectnd_retr _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The pointed endofunctor ([O],[O_unit]) is well-pointed *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 252
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>Definition O_functor_wellpointed (A : Type)
    : O_functor (O_unit A) o O_unit A = O_unit (O A) o O_unit A
    := O_unit_natural (O_unit A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 254
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>

  End Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The maps that are inverted by the reflector. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation O_inverts f := (IsEquiv (O_functor f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 261
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>

    Global Instance O_inverts_O_unit (A : Type)
    : O_inverts (O_unit A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 265
Time: 0.008s">
<div class="time" style="width: 7.3394495412844%"></div>
<pre>
      refine (isequiv_homotopic (O_unit (O A)) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 266
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
      apply ap10, path_arrow_modal.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 267
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
      symmetry; apply O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 268
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** A map between modal types that is inverted by [O] is already an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 272
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Definition isequiv_O_inverts {A B} {A_inO : inO A} {B_inO : inO B}
      (f : A -&gt; B) `{O_inverts f}
    : IsEquiv f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 275
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      assert (IsEquiv (O_unit B o f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 277
Time: 0.01s">
<div class="time" style="width: 9.1743119266055%"></div>
<pre> refine (isequiv_homotopic (O_functor f o O_unit A) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 277
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        apply ap10, O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 278
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
      refine (cancelL_isequiv (O_unit B)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 279
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 280
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>

    Definition equiv_O_inverts {A B} {A_inO : inO A} {B_inO : inO B}
      (f : A -&gt; B) `{O_inverts f}
    : A &lt;~&gt; B
    := BuildEquiv _ _ f (isequiv_O_inverts f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Two maps between modal types that become equal after applying [O_functor] are already equal. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 288
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Definition O_functor_faithful_inO `{Funext} {A B} {A_inO : inO A} {B_inO : inO B}
      (f g : A -&gt; B) (e : O_functor f = O_functor g)
      : f = g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 291
Time: 0.01s">
<div class="time" style="width: 9.1743119266055%"></div>
<pre>
      refine (@equiv_inj _ _ (equiv_postcompose (O_unit B)) _ _ _ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 292
Time: 0.015s">
<div class="time" style="width: 13.761467889908%"></div>
<pre>
      transitivity (O_functor f o O_unit A); try (symmetry; apply O_unit_natural).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 293
Time: 0.017s">
<div class="time" style="width: 15.596330275229%"></div>
<pre>
      transitivity (O_functor g o O_unit A); try (apply O_unit_natural).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 294
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
      exact (ap (fun h =&gt; h o O_unit A) e).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 295
Time: 0.01s">
<div class="time" style="width: 9.1743119266055%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Any map to a type in the subuniverse that is inverted by [O] must be equivalent to [O_unit].  More precisely, the type of such maps is contractible. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 299
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>Definition typeof_O_unit (A : Type)
      := { OA : Type &amp; { Ou : A -&gt; OA &amp; ((inO OA) * (O_inverts Ou)) }}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 300
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>

    Global Instance contr_typeof_O_unit `{Univalence} (A : Type)
    : Contr (typeof_O_unit A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 304
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
      exists (O A ; (O_unit A ; (_ , _))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 305
Time: 0.011s">
<div class="time" style="width: 10.091743119266%"></div>
<pre>
      intros [OA [Ou [? ?]]].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 306
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      pose (f := O_rectnd A OA Ou : O A -&gt; OA).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 307
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
      pose (g := (O_functor Ou)^-1 o O_unit OA : (OA -&gt; O A)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assert (IsEquiv f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 310
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre> refine (isequiv_adjointify f g _ _); apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 311
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre> apply O_functor_faithful_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 311
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
          rewrite O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 312
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
          fold (f o g); rewrite O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 313
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
          refine (path_arrow_modal (O_functor f o O_functor g) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 314
Time: 0.011s">
<div class="time" style="width: 10.091743119266%"></div>
<pre>
          unfold g; rewrite O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          (* Here we need to "rewrite modulo associativity" again... *)
         </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 317
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>match goal with |- (?a o (?b o ?c) o ?d = ?e) =&gt; change (a o b o (c o d) = e) end.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 317
Time: 0.006s">
<div class="time" style="width: 5.5045871559633%"></div>
<pre>
          rewrite O_functor_wellpointed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 318
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
          match goal with |- (?a o ?b o (?c o ?d) = ?e) =&gt; change ((a o (b o c)) o d = e) end.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 319
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
          apply (ap (fun h =&gt; h o O_unit OA)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 320
Time: 0.006s">
<div class="time" style="width: 5.5045871559633%"></div>
<pre>
          rewrite O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 321
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
          match goal with |- (?a o (?b o ?c) = ?d) =&gt; change ((a o b) o c = d) end.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 322
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
          rewrite O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 323
Time: 0.056s">
<div class="time" style="width: 51.376146788991%"></div>
<pre>
          refine (moveR_equiv_M (f := equiv_precompose (O_functor Ou)^-1)
                                (O_unit OA o f) idmap _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 325
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
          apply path_arrow_modal.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 326
Time: 0.011s">
<div class="time" style="width: 10.091743119266%"></div>
<pre>
          transitivity (O_unit OA o Ou); try (symmetry; apply O_unit_natural).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 327
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
          apply (ap (fun h =&gt; O_unit OA o h)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 328
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 329
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre> rewrite_O_rectnd_retr; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 329
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 330
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre> refine (path_arrow_modal (g o f) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 330
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
          unfold f; rewrite_O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 331
Time: 0.021s">
<div class="time" style="width: 19.266055045872%"></div>
<pre>
          refine (moveR_equiv_M
                    (f := equiv_postcompose (O_functor Ou)^-1)
                    (O_unit OA o Ou) (O_unit A) _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 334
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
          symmetry; apply O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 336
Time: 0.011s">
<div class="time" style="width: 10.091743119266%"></div>
<pre>
      refine (path_sigma _ _ _ _ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (path_universe f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 339
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre> rewrite transport_sigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 339
Time: 0.06s">
<div class="time" style="width: 55.045871559633%"></div>
<pre>
        refine (path_sigma _ _ _ _ _); cbn; try apply allpath_hprop.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 340
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply path_arrow; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 341
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        rewrite transport_arrow_fromconst.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 342
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        rewrite transport_path_universe.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 344
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
        revert x; apply ap10; rewrite_O_rectnd_retr; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 345
Time: 0.109s">
<div class="time" style="width: 100%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 346
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>

  End OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 350
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Context `{fs : Funext}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** The [Unit] type *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_unit : inO Unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 356
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_unit_retract with (mu := fun x =&gt; tt).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (@contr Unit _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
    (** ** Dependent product and arrows *)
    (** Theorem 7.7.2 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_forall (A:Type) (B:A -&gt; Type) 
    : (forall x, (inO (B x)))
      -&gt; (inO (forall x:A, (B x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (ev := fun x =&gt; (fun (f:(forall x, (B x))) =&gt; f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (zz := fun x:A =&gt; O_rectnd _ (B x) (ev x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 369
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_unit_retract with (mu := fun z =&gt; fun x =&gt; zz x z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro phi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold zz, ev; clear zz; clear ev.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 372
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (foo := O_rectnd_retr _ (B x) (fun f : forall x0, (B x0) =&gt; f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 374
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      exact (ap10 foo phi).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 375
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance inO_arrow (A B : Type) {B_inO : inO B} : inO (A -&gt; B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 379
Time: 0.009s">
<div class="time" style="width: 8.256880733945%"></div>
<pre>
      apply inO_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Product *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 385
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Global Instance inO_prod (A B : Type) {A_inO : inO A} {B_inO : inO B}
    : inO (A*B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 387
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      apply inO_unit_retract with
        (mu := fun X =&gt; (O_rectnd (A * B) A fst X , O_rectnd (A * B) B snd X)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 389
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
      intros [a b]; apply path_prod; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 390
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 391
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre> exact (ap10 (O_rectnd_retr (A * B) A fst) (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 391
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 392
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre> exact (ap10 (O_rectnd_retr (A * B) B snd) (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 392
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre> 
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** We show that [OA*OB] has the same universal property as [O(A*B)] *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 397
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Definition equiv_O_prod_unit_precompose (A B C : Type) {C_inO : inO C}
    : ((O A) * (O B) -&gt; C) &lt;~&gt; (A * B -&gt; C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (equiv_compose' (equiv_uncurry A B C)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 400
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      refine (equiv_compose' _ (equiv_inverse (equiv_uncurry (O A) (O B) C))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 401
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      apply (equiv_compose' (equiv_O_rectnd A (B -&gt; C))); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 402
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_postcompose'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 403
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (equiv_O_rectnd B C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 404
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The preceding equivalence turns out to be actually (judgmentally!) precomposition with the following function. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 408
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>Definition O_prod_unit (A B : Type) : A * B -&gt; O A * O B
      := fun ab =&gt; (O_unit A (fst ab) , O_unit B (snd ab)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** From this, we can define the comparison map for products, and show that precomposing with it is also an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 412
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>Definition O_prod_cmp (A B : Type) : O (A * B) -&gt; O A * O B
      := O_rectnd (A * B) (O A * O B) (O_prod_unit A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 413
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>

    Definition isequiv_O_prod_cmp_precompose
      (A B C : Type) {C_inO : inO C}
    : IsEquiv (fun h : O A * O B -&gt; C =&gt; h o O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 418
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_prod_cmp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 419
Time: 0.015s">
<div class="time" style="width: 13.761467889908%"></div>
<pre>
      refine (isequiv_homotopic
                ((O_rectnd (A*B) C) o
                 (equiv_O_prod_unit_precompose A B C)) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 422
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros h.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 423
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      apply path_arrow_modal.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 424
Time: 0.011s">
<div class="time" style="width: 10.091743119266%"></div>
<pre>
      rewrite_O_rectnd_retr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 425
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 426
Time: 0.013s">
<div class="time" style="width: 11.926605504587%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Thus, by the Yoneda lemma, the functor [O] preserves products. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isequiv_O_prod_cmp (A B : Type)
    : IsEquiv (O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 431
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 432
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
      apply isequiv_isequiv_precompose;
      apply isequiv_O_prod_cmp_precompose;
      exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 435
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 436
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>

    Definition equiv_O_prod_cmp (A B : Type)
    : O (A * B) &lt;~&gt; (O A * O B)
    := BuildEquiv _ _ (O_prod_cmp A B) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Dependent sums *)
    (** Theorem 7.7.4 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 444
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>Definition inO_sigma_iff
    : (forall (A:Type) (B:A -&gt; Type) {A_inO : inO A} {B_inO : forall a, inO (B a)},
         (inO ({x:A &amp; B x})))
      &lt;-&gt;
      (forall (A:Type) (B: (O A) -&gt; Type) {B_inO : forall a, inO (B a)}
              (g : forall (a:A), (B (O_unit A a))),
         {f : forall (z:O A), (B z) &amp; forall a:A, f (O_unit A a) = g a}).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 451
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
      split.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A B ? g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        pose (Z := sigT B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        assert (inO Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 455
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre> apply H; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        pose (g' := (fun a:A =&gt; (O_unit A a ; g a)) : A -&gt; Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        pose (f' := O_rectnd _ _ g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 457
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        pose (eqf := (O_rectnd_retr _ _ g')  : f' o O_unit A = g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 458
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
        pose (eqid := path_arrow_modal (pr1 o f') idmap
                                       (ap (fun k =&gt; pr1 o k) eqf)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 460
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre>
        exists (fun z =&gt; transport B (ap10 eqid z) ((f' z).2)); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 461
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold eqid.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 462
Time: 0.008s">
<div class="time" style="width: 7.3394495412844%"></div>
<pre> rewrite ap10_path_arrow_modal.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 462
Time: 0.007s">
<div class="time" style="width: 6.4220183486239%"></div>
<pre>
        refine (_ @ pr2_path (ap10 (O_rectnd_retr A Z g') a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 463
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
        apply (ap (fun p =&gt; transport B p _)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 464
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
        exact (ap10_ap_postcompose pr1 eqf a).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 466
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros H A B ? ?.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 466
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        pose (h := fun x =&gt; O_rectnd ({x:A &amp; B x}) A pr1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 467
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
        pose (p := (fun z =&gt; ap10 (O_rectnd_retr ({x : A &amp; B x}) A pr1) z)
                : h o (O_unit _) == pr1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 469
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        pose (g := fun z =&gt; (transport B ((p z)^) z.2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 470
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
        simpl in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 471
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
        specialize (H ({x:A &amp; B x}) (B o h) _ g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 472
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
        destruct H as [f q].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 473
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        apply inO_unit_retract with (mu := fun w =&gt; (h w; f w)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 474
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>
        intros [x1 x2].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 475
Time: 0.003s">
<div class="time" style="width: 2.7522935779817%"></div>
<pre>
        refine (path_sigma B _ _ _ _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 476
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 477
Time: 0.002s">
<div class="time" style="width: 1.8348623853211%"></div>
<pre> apply p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 477
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 478
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre> rewrite (q (x1;x2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 478
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
          unfold g; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 479
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre> exact (transport_pV B _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 479
Time: 0.041s">
<div class="time" style="width: 37.614678899083%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 480
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Paths *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 484
Time: 0.001s">
<div class="time" style="width: 0.91743119266055%"></div>
<pre>Global Instance inO_paths (S : Type) {S_inO : inO S} (x y : S)
    : inO (x=y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 485
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (inO_unit_retract _ _ _); intro u.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 487
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 488
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (p : (fun _ : O (x=y) =&gt; x) = (fun _=&gt; y)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 488
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
        {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 489
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre> apply ((ap (equiv_O_rectnd (x=y) S))^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply path_arrow; intro v.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact v.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (ap10 p u).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 492
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 492
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre>
        rewrite &lt;- ap10_ap_precompose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 493
Time: 0.008s">
<div class="time" style="width: 7.3394495412844%"></div>
<pre>
        rewrite eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 494
Time: 0.005s">
<div class="time" style="width: 4.5871559633028%"></div>
<pre> 
        rewrite ap10_path_arrow; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 495
Time: 0.033s">
<div class="time" style="width: 30.275229357798%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 496
Time: 0.004s">
<div class="time" style="width: 3.6697247706422%"></div>
<pre>
    
  End Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 498
Time: 0.097s">
<div class="time" style="width: 88.990825688073%"></div>
<pre>
End Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


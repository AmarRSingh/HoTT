<html>
<head>
<title>ReflectiveSubuniverse.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ReflectiveSubuniverse.v</h1>

<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.016s">
<div class="time" style="width: 14.414414414414%"></div>
<pre>Require Import HoTT.Basics.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.021s">
<div class="time" style="width: 18.918918918919%"></div>
<pre>
Require Import types.Empty types.Unit types.Arrow types.Sigma types.Paths types.Forall types.Prod types.Universe.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
Require Import HProp ObjectClassifier EquivalenceVarieties.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 3
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
Require Import HoTT.Tactics.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Arguments compose / .</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Reflective Subuniverses *)

(** ** Unit Subuniverses *)

(** A UnitSubuniverse is the common underlying structure of a reflective subuniverse and a modality.  We make it a separate structure in order to use the same names for its fields and functions in the two cases. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 15
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>Class UnitSubuniverse :=
  {
    inO_internal : Type -&gt; Type ;
    O : Type -&gt; Type ;
    O_inO_internal : forall T, inO_internal (O T) ;
    O_unit : forall T, T -&gt; O T ;
    (** In most examples, [Funext] is necessary to prove that the predicate of being in the subuniverse is an hprop.  To avoid needing to assume [Funext] as a global hypothesis when constructing such examples, and since [Funext] is often not needed for any of the rest of the theory, we add it as a hypothesis to this specific field of the record. *)
    hprop_inO_internal : Funext -&gt; forall T, IsHProp (inO_internal T)
  }.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** For reflective subuniverses (and hence also modalities), it will turn out that [inO T] is equivalent to [IsEquiv (O_unit T)].  We could define the former as the latter, and it would simplify some of the general theory.  However, in many examples there is a "more basic" definition of [inO] which is equivalent, but not definitionally identical, to [IsEquiv (O_unit T)].  Thus, including [inO] as data makes more things turn out to be judgmentally what we would expect. *)

(** We made [UnitSubuniverse] into a typeclass, rather than just a record, so that when there is an assumed one around it doesn't need to be given explicitly as an argument to everything.  You should *not* ever declare a global [Instance] of [UnitSubuniverse].  The things to do with it are:

  1. Assume an arbitrary one for the purposes of general theory, as we will do here.  In this case it is a variable in the context, so typeclass resolution finds it automatically.

  2. Construct a specific one, such as n-types.  You should not define it as a global instance: use [Definition] or [Local Instance].  That way someone else can import your file and still be able to talk about subuniverses other than yours.  (If they do want to use yours, then they can declare it with [Local Existing Instance].)

  3. Apply general theory to a specific example explicitly.  This requires giving the specific example, defined as above, as an explicit argument to the general functions and theorems.

  4. Specify locally that we will be applying the general theory of subuniverses only to a specific example, by declaring that example as a [Local Instance].  (If the subuniverse in question has already been defined somewhere else, you can declare it as an instance locally with [Local Existing Instance].)  This way the instance won't outlast the containing section, module, or file, but inside that section, module, or file, you won't have to give it as an explicit argument.

  The same considerations will apply to [ReflectiveSubuniverse] and [Modality].
 *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Unit_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context {subU : UnitSubuniverse}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The property of being in the subuniverse.  This is a more usual sort of typeclass, to be inferred automatically in many cases.  Note, however, that you shouldn't write [`{inO A}], since the generalizing binders will then introduce a *new* [UnitSubuniverse] hypothesis rather than using the one you intend; write [{A_inO : inO A}] instead.  *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 44
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Class inO (T : Type) :=
    isequiv_inO : inO_internal T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Typeclasses Transparent inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Being in the subuniverse is a mere predicate (by hypothesis) *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 50
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Global Instance hprop_inO {fs : Funext} (T : Type)
  : IsHProp (inO T)
  := hprop_inO_internal fs T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** [O T] is always in the subuniverse (by hypothesis) *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 55
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Global Instance O_inO T : inO (O T)
    := O_inO_internal T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The type of types in the subuniverse *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition TypeO : Type
    := {T : Type &amp; inO T}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Coercion TypeO_pr1 (T : TypeO) := @pr1 Type inO T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** The second component of [TypeO] is unique *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 65
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>Definition path_TypeO {fs : Funext} (T T' : TypeO) (p : T.1 = T'.1)
  : T = T'
  := path_sigma_hprop T T' p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 67
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>

End Unit_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Reflective Subuniverses *)

(** A reflective subuniverse is a [UnitSubuniverse], as above, whose unit has a universal property.  Our definition is somewhat different from that in the book, being instead more similar to the definition of a [Modality]; below we show that it is in fact equivalent. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 73
Time: 0.035s">
<div class="time" style="width: 31.531531531532%"></div>
<pre>Class ReflectiveSubuniverse :=
  {
    rsubu_usubu : UnitSubuniverse ;
    O_rectnd : forall {P Q : Type} {Q_inO : inO Q} (f : P -&gt; Q), O P -&gt; Q ;
    O_rectnd_beta : forall {P Q : Type} {Q_inO : inO Q} (f : P -&gt; Q) (x : P),
                      O_rectnd f (O_unit P x) = f x ;
    O_rectpaths : forall {P Q : Type} {Q_inO : inO Q}
                         (g h : O P -&gt; Q) (p : g o O_unit P == h o O_unit P),
                    g == h ;
    O_rectpaths_beta : forall {P Q : Type} {Q_inO : inO Q}
                         (g h : O P -&gt; Q) (p : g o O_unit P == h o O_unit P)
                         (x : P),
                         O_rectpaths g h p (O_unit P x) = p x
  }.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance rsubu_usubu.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 88
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Coercion rsubu_usubu : ReflectiveSubuniverse &gt;-&gt; UnitSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Here we prove the definition of reflective subuniverse in the book. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section IsEquiv.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {fs : Funext} {subU : ReflectiveSubuniverse}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 92
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
  Context (P Q : Type) {Q_inO : inO Q}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 93
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>

  Global Instance isequiv_o_O_unit 
  : IsEquiv (fun g : O P -&gt; Q =&gt; g o O_unit P).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 97
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
    refine (BuildIsEquiv _ _ _ O_rectnd _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 100
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 103
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply O_rectpaths; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 104
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 106
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre> intros f; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 106
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre>
      apply moveR_equiv_M; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 107
Time: 0.011s">
<div class="time" style="width: 9.9099099099099%"></div>
<pre>
      apply path_forall; intros x; symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 108
Time: 0.012s">
<div class="time" style="width: 10.810810810811%"></div>
<pre>
      refine (apD10_ap_precompose (O_unit P) _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 109
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre>
      refine (apD10_path_arrow _ _ _ (O_unit P x) @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 110
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      exact (O_rectpaths_beta _ f _ x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 111
Time: 0.051s">
<div class="time" style="width: 45.945945945946%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 112
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>

  Definition equiv_o_O_unit : (O P -&gt; Q) &lt;~&gt; (P -&gt; Q)
    := BuildEquiv _ _ (fun g : O P -&gt; Q =&gt; g o O_unit P) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 115
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>

  Global Instance isequiv_O_rectnd
  : IsEquiv (@O_rectnd subU P Q _)
  := (@isequiv_inverse _ _ _ isequiv_o_O_unit).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 119
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>

  Definition equiv_O_rectnd : (P -&gt; Q) &lt;~&gt; (O P -&gt; Q)
    := BuildEquiv _ _ O_rectnd _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 122
Time: 0.014s">
<div class="time" style="width: 12.612612612613%"></div>
<pre>

End IsEquiv.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Conversely, from the book's definition we can reconstruct ours. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section ReflectiveSubuniverseFromIsEquiv.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context {fs : Funext}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (subU : UnitSubuniverse).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 129
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
  Let precomp := fun P Q =&gt; (fun g : O P -&gt; Q =&gt; g o O_unit P).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 130
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
  Context (H : forall {P Q : Type} {Q_inO : inO Q}, IsEquiv (precomp P Q)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 131
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  
  Local Definition O_rectnd' {P Q : Type} {Q_inO : inO Q} (f : P -&gt; Q)
  : O P -&gt; Q
  := (precomp P Q)^-1 f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 135
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

  Local Definition O_rectnd_beta' {P Q : Type} {Q_inO : inO Q} (f : P -&gt; Q) (x : P)
  : O_rectnd' f (O_unit P x) = f x
  := ap10 (eisretr (precomp P Q) f) x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 139
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

  Local Definition O_rectpaths' {P Q : Type} {Q_inO : inO Q}
        (g h : O P -&gt; Q) (p : g o O_unit P == h o O_unit P)
  : g == h.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 145
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
    refine ((eissect (precomp P Q) g)^ @ _ @ eissect (precomp P Q) h).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 147
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
    apply path_arrow, p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 148
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 149
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>

  Local Definition O_rectpaths_beta' {P Q : Type} {Q_inO : inO Q}
        (g h : O P -&gt; Q) (p : g o O_unit P == h o O_unit P) (x : P)
  : O_rectpaths' g h p (O_unit P x) = p x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold O_rectpaths'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 155
Time: 0.015s">
<div class="time" style="width: 13.513513513514%"></div>
<pre>
    refine ((ap10_ap_precompose (O_unit P) _ x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 156
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
    refine (apD10 _ x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 157
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
    apply moveR_equiv_M.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 158
Time: 0.057s">
<div class="time" style="width: 51.351351351351%"></div>
<pre>
    rewrite ap_pp, ap_pp, ap_V, &lt;- ap_compose, concat_pp_p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 159
Time: 0.031s">
<div class="time" style="width: 27.927927927928%"></div>
<pre>
    do 2 rewrite &lt;- eisadj.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 160
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
    apply moveR_Vp.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 161
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
    exact (concat_A1p (eisretr (precomp P Q)) (path_arrow _ _ p)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 162
Time: 0.111s">
<div class="time" style="width: 100%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 163
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

  Definition reflective_subuniverse_from_isequiv
  : ReflectiveSubuniverse
  := Build_ReflectiveSubuniverse subU
       (@O_rectnd') (@O_rectnd_beta') (@O_rectpaths') (@O_rectpaths_beta').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 168
Time: 0.012s">
<div class="time" style="width: 10.810810810811%"></div>
<pre>

End ReflectiveSubuniverseFromIsEquiv.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** So why do we use a different definition than the book?  Notice that *both* directions of the comparison between our definition and the book's make use of funext.  Moreover, it seems that in order to do anything useful with the book's definition, or construct any interesting examples, also requires funext.  However, this is not the case for our definition!  Thus, our choice has the following advantages:

1. It avoids the funext redexes that otherwise infect the theory, thereby simplifying the proofs and proof terms.  We never have to worry about whether we have a path between functions or a homotopy; we use only homotopies, with no need for [ap10] or [path_arrow] to mediate.

2. It avoids [Funext] hypotheses in some constructions of reflective subuniverses, particularly the construction from a [Modality].  This enables us to declare such constructions as coercions without running afoul of Coq's "uniform inheritance condition", so that a modality can be used as a reflective subuniverse.

3. In fact, the data of a reflective subuniverse according to our definition are precisely a couple of special cases of the data of a modality.  Thus, all the theorems we prove about reflective subuniverses will, when interpreted for a modality (coerced as above to a reflective subuniverse), reduce definitionally to "the way we would have proved them directly for a modality".  *)

(** ** Replete Subuniverses *)

(** A subuniverse is replete if it is closed under equivalence.  This is also a more usual sort of typeclass.  We are not very interested in non-replete subuniverses; the reason for not including repleteness in the main definition is so that functoriality, below, can not depend on it, so that in turn [Build_Modality_easy] can use functoriality to prove repleteness. *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 183
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Class Replete (subU : UnitSubuniverse) :=
  inO_equiv_inO : forall T U (T_inO : @inO subU T) (f : T -&gt; U) (feq : IsEquiv f), @inO subU U.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Of course, with univalence this is automatic.  This is the only appearance of univalence in the theory of reflective subuniverses and (non-lex) modalities. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance replete_univalence `{Univalence} (subU : UnitSubuniverse)
: Replete subU.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros T U ? f ?.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (transport (@inO subU) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply path_universe with f; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Properties of Reflective Subuniverses *)

(** We now prove a bunch of things about an arbitrary reflective subuniverse (sometimes replete). *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {subU : ReflectiveSubuniverse}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Functoriality of [O_rectnd] homotopies *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 200
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>Definition O_rectnd_homotopy {P Q} {Q_inO : inO Q} (f g : P -&gt; Q) (pi : f == g)
  : O_rectnd f == O_rectnd g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 202
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
    apply O_rectpaths; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 203
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
    etransitivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 206
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> etransitivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (pi _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 208
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> symmetry; apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 208
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 209
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** If [T] is in the subuniverse, then [O_unit T] is an equivalence. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 212
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Global Instance isequiv_O_unit_inO (T : Type) {T_inO : inO T} : IsEquiv (O_unit T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (g := O_rectnd idmap).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine (isequiv_adjointify (O_unit T) g _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 216
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre> refine (O_rectpaths (O_unit T o g) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 221
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 222
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

  Definition equiv_O_unit (T : Type) {T_inO : inO T} : T &lt;~&gt; O T
    := BuildEquiv T (O T) (O_unit T) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** In this section, we see that [O] is a functor. *)
    
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 231
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>Definition O_functor {A B : Type} (f : A -&gt; B) : O A -&gt; O B
      := O_rectnd (O_unit B o f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on composition *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 235
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Definition O_functor_compose {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
    : (O_functor (g o f)) == (O_functor g) o (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 236
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 237
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply O_rectpaths; intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 238
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
      refine (O_rectnd_beta (O_unit C o g o f) x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 239
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      transitivity (O_functor g (O_unit B (f x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 240
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 241
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 241
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> exact (O_rectnd_beta (O_unit C o g) (f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 242
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> apply ap; symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 242
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        exact (O_rectnd_beta (O_unit B o f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 243
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on homotopies *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 247
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_functor_homotopy {A B : Type} (f g : A -&gt; B) (pi : f == g)
    : O_functor f == O_functor g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 249
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (O_rectpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 250
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (O_rectnd_beta (O_unit B o f) x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 251
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (_ @ (O_rectnd_beta (O_unit B o g) x)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold compose; apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply pi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 254
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Hence functoriality on commutative squares *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 258
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>Definition O_functor_square {A B C X : Type} (pi1 : X -&gt; A) (pi2 : X -&gt; B)
               (f : A -&gt; C) (g : B -&gt; C) (comm : (f o pi1) == (g o pi2))
    : ( (O_functor f) o (O_functor pi1) )
      == ( (O_functor g) o (O_functor pi2) ).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 263
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      transitivity (O_functor (f o pi1) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 265
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre> symmetry; apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 266
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> transitivity (O_functor (g o pi2) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_homotopy, comm.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 268
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on identities *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 272
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition O_functor_idmap (A : Type)
    : @O_functor A A idmap == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 274
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (O_rectpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 275
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
      apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 276
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 277
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Naturality of [O_unit] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 280
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>Definition O_unit_natural {A B} (f : A -&gt; B)
    : (O_functor f) o (O_unit A) == (O_unit B) o f
    := (O_rectnd_beta _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 282
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The pointed endofunctor ([O],[O_unit]) is well-pointed *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 285
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Definition O_functor_wellpointed (A : Type)
    : O_functor (O_unit A) == O_unit (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 286
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 287
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (O_rectpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 288
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      apply O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 289
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Preservation of equivalences *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isequiv_O_functor {A B} (f : A -&gt; B) `{IsEquiv _ _ f}
    : IsEquiv (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 294
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 295
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      refine (isequiv_adjointify (O_functor f) (O_functor f^-1) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 297
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
        refine ((O_functor_compose _ _ x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 298
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        refine (O_functor_homotopy _ idmap _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y; apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 302
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
        refine ((O_functor_compose _ _ x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 303
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        refine (O_functor_homotopy _ idmap _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y; apply eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 305
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 306
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 307
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
      
    Definition equiv_O_functor {A B} (f : A &lt;~&gt; B)
    : O A &lt;~&gt; O B
    := BuildEquiv _ _ (O_functor f) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Postcomposition respects [O_rectnd] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 314
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>Definition O_rectnd_postcompose {A B C} {B_inO : inO B} {C_inO : inO C}
               (f : A -&gt; B) (g : B -&gt; C)
    : g o O_rectnd f == O_rectnd (g o f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 317
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (O_rectpaths _ _ _); intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 318
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      transitivity (g (f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 319
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 320
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 321
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rectnd_beta (g o f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 321
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 322
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>

  End Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 324
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Replete.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** An equivalent formulation of repleteness is that a type lies in the subuniverse as soon as its unit map is an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 329
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>Definition inO_isequiv_O_unit {rep : Replete subU} (T:Type)
    : IsEquiv (O_unit T) -&gt; inO T
    := fun _ =&gt; inO_equiv_inO (O T) T _ (O_unit T)^-1 _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 331
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Definition inO_iff_isequiv_O_unit {rep : Replete subU} (T:Type)
    : inO T &lt;-&gt; IsEquiv (O_unit T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 334
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 335
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      split.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply isequiv_O_unit_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 337
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply inO_isequiv_O_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 339
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Global Instance replete_inO_isequiv_O_unit
           (H : forall T, IsEquiv (O_unit T) -&gt; inO T)
    : Replete subU.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 344
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros A B A_inO f feq.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 345
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      pose (uA := BuildEquiv _ _ (O_unit A) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 346
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (H B (isequiv_adjointify (O_unit B) _ _ _)); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 348
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre> exact (f o uA^-1 o (O_functor f)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 349
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
        refine ((O_unit_natural f _)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 350
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre>
        transitivity (O_functor f ((O_functor f)^-1 x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 352
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> apply (ap (O_functor f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 352
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 354
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 354
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 355
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
        transitivity (f (uA^-1 (O_unit A (f^-1 x)))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 356
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 357
Time: 0.039s">
<div class="time" style="width: 35.135135135135%"></div>
<pre> apply ap, ap, (O_unit_natural f^-1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 358
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> transitivity (f (f^-1 x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 359
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> apply ap, eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 359
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 360
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 360
Time: 0.015s">
<div class="time" style="width: 13.513513513514%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Thus, [T] is in a replete subuniverse as soon as [O_unit T] admits a retraction. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 364
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Definition inO_unit_retract {rep : Replete subU} (T:Type) (mu : O T -&gt; T)
    : Sect (O_unit T) mu -&gt; inO T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold Sect; intros H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_isequiv_O_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 368
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_adjointify with (g:=mu).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 369
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 370
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre> refine (O_rectpaths (O_unit T o mu) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 370
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        intros x; exact (ap (O_unit T) (H x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 371
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 372
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 372
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 373
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

  End Replete.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 375
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The maps that are inverted by the reflector. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation O_inverts f := (IsEquiv (O_functor f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 380
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Global Instance O_inverts_O_unit (A : Type)
    : O_inverts (O_unit A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 383
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 384
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
      refine (isequiv_homotopic (O_unit (O A)) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 385
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      intros x; symmetry; apply O_functor_wellpointed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 386
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** A map between modal types that is inverted by [O] is already an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 390
Time: 0.022s">
<div class="time" style="width: 19.81981981982%"></div>
<pre>Definition isequiv_O_inverts {A B} {A_inO : inO A} {B_inO : inO B}
      (f : A -&gt; B) `{O_inverts f}
    : IsEquiv f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assert (IsEquiv (O_unit B o f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 395
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre> refine (isequiv_homotopic (O_functor f o O_unit A) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 396
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 396
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
      refine (cancelL_isequiv (O_unit B)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 397
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 398
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>

    Definition equiv_O_inverts {A B} {A_inO : inO A} {B_inO : inO B}
      (f : A -&gt; B) `{O_inverts f}
    : A &lt;~&gt; B
    := BuildEquiv _ _ f (isequiv_O_inverts f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 403
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>

    Definition O_unit_inv_natural {A B} {A_inO : inO A} {B_inO : inO B}
               (f : A -&gt; B)
    : (O_unit B)^-1 o (O_functor f) == f o (O_unit A)^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 408
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      refine (O_rectpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold compose; apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 410
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      refine (O_unit_natural f x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold compose; do 2 apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 412
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      symmetry; apply eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 413
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 414
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Two maps between modal types that become equal after applying [O_functor] are already equal. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 417
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Definition O_functor_faithful_inO {A B} {A_inO : inO A} {B_inO : inO B}
      (f g : A -&gt; B) (e : O_functor f == O_functor g)
      : f == g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 419
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 421
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
      refine (ap f (eissect (O_unit A) x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 422
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
      refine (_ @ ap g (eissect (O_unit A) x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 423
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
      transitivity ((O_unit B)^-1 (O_functor f (O_unit A x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 424
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 425
Time: 0.08s">
<div class="time" style="width: 72.072072072072%"></div>
<pre> symmetry; apply O_unit_inv_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 426
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre> transitivity ((O_unit B)^-1 (O_functor g (O_unit A x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, e.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 428
Time: 0.079s">
<div class="time" style="width: 71.171171171171%"></div>
<pre> apply O_unit_inv_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 428
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 429
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Any map to a type in the subuniverse that is inverted by [O] must be equivalent to [O_unit].  More precisely, the type of such maps is contractible. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 432
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Definition typeof_O_unit (A : Type)
      := { OA : Type &amp; { Ou : A -&gt; OA &amp; ((inO OA) * (O_inverts Ou)) }}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance contr_typeof_O_unit `{Univalence} (A : Type)
    : Contr (typeof_O_unit A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 436
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 437
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      exists (O A ; (O_unit A ; (_ , _))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 438
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
      intros [OA [Ou [? ?]]].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 439
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      pose (f := O_rectnd Ou : O A -&gt; OA).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 440
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      pose (g := (O_functor Ou)^-1 o O_unit OA : (OA -&gt; O A)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assert (IsEquiv f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (isequiv_adjointify f g _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 443
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 444
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> apply O_functor_faithful_inO; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 444
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
          rewrite O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 445
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
          fold (f o g); rewrite O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 446
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 447
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre>
          simpl rewrite (O_functor_compose (O_unit OA) (O_functor Ou)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 448
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
          rewrite O_functor_wellpointed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 449
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
          simpl rewrite (O_unit_natural (O_functor Ou)^-1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 450
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
          refine (O_unit_natural f _ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 451
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
          set (y := (O_functor Ou)^-1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 452
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
          transitivity (O_functor Ou y); try apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 453
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold f, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 454
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
          apply O_rectnd_postcompose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 456
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre> refine (O_rectpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold f, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 457
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
          rewrite O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 459
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
          symmetry; apply O_unit_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 460
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 461
Time: 0.014s">
<div class="time" style="width: 12.612612612613%"></div>
<pre>
      refine (path_sigma _ _ _ _ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 463
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (path_universe f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 463
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 464
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre> rewrite transport_sigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 464
Time: 0.058s">
<div class="time" style="width: 52.252252252252%"></div>
<pre>
        refine (path_sigma _ _ _ _ _); cbn; try apply path_ishprop.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply path_arrow; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 466
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        rewrite transport_arrow_fromconst.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 467
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        rewrite transport_path_universe.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 468
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold f; apply O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 469
Time: 0.091s">
<div class="time" style="width: 81.981981981982%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 470
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

  End OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 472
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 474
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context {rep : Replete subU}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 475
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** The [Unit] type *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 478
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_unit : inO Unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 478
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 479
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_unit_retract with (mu := fun x =&gt; tt).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 480
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (@contr Unit _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 481
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    
    (** ** Dependent product and arrows *)
    (** Theorem 7.7.2 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 486
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Global Instance inO_forall {fs : Funext} (A:Type) (B:A -&gt; Type) 
    : (forall x, (inO (B x)))
      -&gt; (inO (forall x:A, (B x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 488
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 490
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (ev := fun x =&gt; (fun (f:(forall x, (B x))) =&gt; f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (zz := fun x:A =&gt; O_rectnd (ev x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 492
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_unit_retract with (mu := fun z =&gt; fun x =&gt; zz x z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro phi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 494
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold zz, ev; clear zz; clear ev.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 495
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_rectnd_beta (fun f : forall x0, (B x0) =&gt; f x) phi).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 497
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 498
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Global Instance inO_arrow {fs : Funext} (A B : Type) {B_inO : inO B}
    : inO (A -&gt; B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 502
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 504
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 504
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 505
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Product *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 508
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Global Instance inO_prod (A B : Type) {A_inO : inO A} {B_inO : inO B}
    : inO (A*B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 509
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 510
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply inO_unit_retract with
        (mu := fun X =&gt; (@O_rectnd _ (A * B) A _ fst X , O_rectnd snd X)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 512
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      intros [a b]; apply path_prod; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 513
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 514
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> exact (O_rectnd_beta fst (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 514
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 515
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> exact (O_rectnd_beta snd (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 515
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 516
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** We show that [OA*OB] has the same universal property as [O(A*B)] *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 520
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>Definition equiv_O_prod_unit_precompose
               {fs : Funext} (A B C : Type) {C_inO : inO C}
    : ((O A) * (O B) -&gt; C) &lt;~&gt; (A * B -&gt; C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (equiv_compose' (equiv_uncurry A B C)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 524
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      refine (equiv_compose' _ (equiv_inverse (equiv_uncurry (O A) (O B) C))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 525
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply (equiv_compose' (equiv_o_O_unit A (B -&gt; C))); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_postcompose'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 527
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (equiv_o_O_unit B C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 528
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 529
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The preceding equivalence turns out to be actually (judgmentally!) precomposition with the following function. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 532
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>Definition O_prod_unit (A B : Type) : A * B -&gt; O A * O B
      := functor_prod (O_unit A) (O_unit B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 533
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** From this, we can define the comparison map for products, and show that precomposing with it is also an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 536
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>Definition O_prod_cmp (A B : Type) : O (A * B) -&gt; O A * O B
      := O_rectnd (O_prod_unit A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance isequiv_O_prod_cmp (A B : Type)
    : IsEquiv (O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 541
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      refine (isequiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 542
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 543
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply prod_rect; intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 543
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        apply O_rectnd; intro b; revert a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 544
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_rectnd; intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 546
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (a, b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold prod_rect, O_prod_cmp, O_prod_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 548
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
        intros [oa ob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 549
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
        revert ob; refine (O_rectpaths _ _ _); intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 550
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre>
        revert oa; refine (O_rectpaths _ _ _); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 551
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
        cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 552
Time: 0.031s">
<div class="time" style="width: 27.927927927928%"></div>
<pre> abstract (repeat rewrite O_rectnd_beta; reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold prod_rect, O_prod_cmp, O_prod_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 553
Time: 0.014s">
<div class="time" style="width: 12.612612612613%"></div>
<pre>
        refine (O_rectpaths _ _ _); intros [a b]; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 554
Time: 0.031s">
<div class="time" style="width: 27.927927927928%"></div>
<pre>
        abstract (repeat (rewrite O_rectnd_beta; cbn); reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 555
Time: 0.052s">
<div class="time" style="width: 46.846846846847%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 556
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>

    Definition isequiv_O_prod_cmp_precompose
      {fs : Funext} (A B C : Type) {C_inO : inO C}
    : IsEquiv (fun h : O A * O B -&gt; C =&gt; h o O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 560
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 561
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      apply isequiv_precompose; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 562
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 563
Time: 0.014s">
<div class="time" style="width: 12.612612612613%"></div>
<pre>

    Definition equiv_O_prod_cmp {fs : Funext} (A B : Type)
    : O (A * B) &lt;~&gt; (O A * O B)
    := BuildEquiv _ _ (O_prod_cmp A B) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 567
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Dependent sums *)
    (** Theorem 7.7.4 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 571
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>Definition inO_sigma_iff
    : (forall (A:Type) (B:A -&gt; Type) {A_inO : inO A} {B_inO : forall a, inO (B a)},
         (inO ({x:A &amp; B x})))
      &lt;-&gt;
      (forall (A:Type) (B: (O A) -&gt; Type) {B_inO : forall a, inO (B a)}
              (g : forall (a:A), (B (O_unit A a))),
         {f : forall (z:O A), (B z) &amp; forall a:A, f (O_unit A a) = g a}).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 577
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 578
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      split.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 580
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 580
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A B ? g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 580
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        pose (Z := sigT B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 581
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        assert (inO Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 582
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> apply H; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 582
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        pose (g' := (fun a:A =&gt; (O_unit A a ; g a)) : A -&gt; Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 583
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        pose (f' := O_rectnd g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 584
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        pose (eqf := (O_rectnd_beta g')  : f' o O_unit A == g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 585
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>
        pose (eqid := O_rectpaths (pr1 o f') idmap
                                  (fun x =&gt; ap pr1 (eqf x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 587
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        exists (fun z =&gt; transport B (eqid z) ((f' z).2)); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 588
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold eqid.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 589
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre> rewrite O_rectpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 589
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
        exact (pr2_path (O_rectnd_beta g' a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros H A B ? ?.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 591
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>
        pose (h := fun x =&gt; @O_rectnd _ ({x:A &amp; B x}) A _ pr1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 592
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
        pose (p := (fun z =&gt; O_rectnd_beta pr1 z)
                   : h o (O_unit _) == pr1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 594
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        pose (g := fun z =&gt; (transport B ((p z)^) z.2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 595
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
        simpl in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 596
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
        specialize (H ({x:A &amp; B x}) (B o h) _ g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 597
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
        destruct H as [f q].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 598
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        apply inO_unit_retract with (mu := fun w =&gt; (h w; f w)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 599
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
        intros [x1 x2].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 600
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
        refine (path_sigma B _ _ _ _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 603
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre> rewrite (q (x1;x2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 603
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
          unfold g; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (transport_pV B _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 604
Time: 0.024s">
<div class="time" style="width: 21.621621621622%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 605
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Paths *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 609
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Global Instance inO_paths (S : Type) {S_inO : inO S} (x y : S)
    : inO (x=y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 610
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 611
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (inO_unit_retract _ _ _); intro u.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (p : (fun _ : O (x=y) =&gt; x) == (fun _=&gt; y)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 613
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
        {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 614
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre> refine (O_rectpaths _ _ _); unfold compose; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intro v; exact v.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 615
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (p u).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 617
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 617
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
        rewrite O_rectpaths_beta; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 618
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 619
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
    
  End Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Monad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 623
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>

    Definition O_monad_mult A : O (O A) -&gt; O A
      := O_rectnd idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 626
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Definition O_monad_mult_natural {A B} (f : A -&gt; B)
    : O_functor f o O_monad_mult A == O_monad_mult B o O_functor (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 629
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 630
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply O_rectpaths; intros x; unfold compose, O_monad_mult.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 631
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>
      simpl rewrite (O_unit_natural (O_functor f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 632
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
      rewrite (O_rectnd_beta idmap x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 633
Time: 0.005s">
<div class="time" style="width: 4.5045045045045%"></div>
<pre>
      rewrite (O_rectnd_beta idmap (O_functor f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 634
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 635
Time: 0.008s">
<div class="time" style="width: 7.2072072072072%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 636
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Definition O_monad_unitlaw1 A
    : O_monad_mult A o (O_unit (O A)) == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 640
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply O_rectpaths; intros x; unfold compose, O_monad_mult.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 641
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      exact (O_rectnd_beta idmap (O_unit A x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 642
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 643
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Definition O_monad_unitlaw2 A
    : O_monad_mult A o (O_functor (O_unit A)) == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 646
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 647
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply O_rectpaths; intros x; unfold O_monad_mult, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 648
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre>
      repeat rewrite O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 649
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 650
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 651
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Definition O_monad_mult_assoc A
    : O_monad_mult A o O_monad_mult (O A) == O_monad_mult A o O_functor (O_monad_mult A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 654
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 655
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply O_rectpaths; intros x; unfold O_monad_mult, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 656
Time: 0.015s">
<div class="time" style="width: 13.513513513514%"></div>
<pre>
      repeat rewrite O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 657
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 658
Time: 0.009s">
<div class="time" style="width: 8.1081081081081%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 659
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

  End Monad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 661
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section StrongMonad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 663
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context {fs : Funext} {rep : Replete subU}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 664
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>

    Definition O_monad_strength A B : A * O B -&gt; O (A * B)
      := fun aob =&gt; O_rectnd (fun b a =&gt; O_unit (A*B) (a,b)) (snd aob) (fst aob).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 667
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>

    Definition O_monad_strength_natural A A' B B' (f : A -&gt; A') (g : B -&gt; B')
    : O_functor (functor_prod f g) o O_monad_strength A B ==
      O_monad_strength A' B' o functor_prod f (O_functor g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 671
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 672
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      intros [a ob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 673
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 673
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 673
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
      revert ob; apply O_rectpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 674
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      intros b; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 675
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 676
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      unfold O_monad_strength, O_functor, compose; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 677
Time: 0.018s">
<div class="time" style="width: 16.216216216216%"></div>
<pre>
      repeat rewrite O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 678
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 679
Time: 0.014s">
<div class="time" style="width: 12.612612612613%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 680
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      
    (** The diagrams for strength, see http://en.wikipedia.org/wiki/Strong_monad *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 683
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>Definition O_monad_strength_unitlaw1 A
    : O_functor (@snd Unit A) o O_monad_strength Unit A == @snd Unit (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 684
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 685
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      intros [[] oa]; revert oa.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 686
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      apply O_rectpaths; intros x; unfold O_monad_strength, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 687
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 687
Time: 0.006s">
<div class="time" style="width: 5.4054054054054%"></div>
<pre> 
      repeat rewrite O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 688
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 689
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 690
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>

    Definition O_monad_strength_unitlaw2 A B
    : O_monad_strength A B o functor_prod idmap (O_unit B) == O_unit (A*B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 693
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [a b].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 695
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, functor_prod, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 696
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 696
Time: 0.013s">
<div class="time" style="width: 11.711711711712%"></div>
<pre> 
      repeat rewrite O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 697
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 698
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 699
Time: 0.01s">
<div class="time" style="width: 9.009009009009%"></div>
<pre>

    Definition O_monad_strength_assoc1 A B C
    : O_functor (equiv_prod_assoc A B C)^-1 o O_monad_strength (A*B) C ==
      O_monad_strength A (B*C) o functor_prod idmap (O_monad_strength B C) o (equiv_prod_assoc A B (O C))^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 703
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 704
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
      intros [[a b] oc].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 705
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
      revert a; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 706
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre> revert b; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 706
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
      revert oc; apply O_rectpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 707
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      intros c; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 708
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre>
      apply path_arrow; intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 709
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 709
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor, functor_prod, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 710
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 710
Time: 0.03s">
<div class="time" style="width: 27.027027027027%"></div>
<pre> 
      repeat rewrite O_rectnd_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 711
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 712
Time: 0.041s">
<div class="time" style="width: 36.936936936937%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 713
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>

    Definition O_monad_strength_assoc2 A B
    : O_monad_mult (A*B) o O_functor (O_monad_strength A B) o O_monad_strength A (O B) ==
      O_monad_strength A B o functor_prod idmap (O_monad_mult B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 717
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 718
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre>
      intros [a oob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 719
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre> revert a; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 719
Time: 0.004s">
<div class="time" style="width: 3.6036036036036%"></div>
<pre>
      revert oob; apply O_rectpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 720
Time: 0.002s">
<div class="time" style="width: 1.8018018018018%"></div>
<pre> apply O_rectpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 720
Time: 0.003s">
<div class="time" style="width: 2.7027027027027%"></div>
<pre>
      intros b; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 721
Time: 0.001s">
<div class="time" style="width: 0.9009009009009%"></div>
<pre> apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 721
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor, O_monad_mult, functor_prod, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 722
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 722
Time: 0.048s">
<div class="time" style="width: 43.243243243243%"></div>
<pre> 
      repeat (rewrite O_rectnd_beta; simpl).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 723
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 724
Time: 0.04s">
<div class="time" style="width: 36.036036036036%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 725
Time: 0.007s">
<div class="time" style="width: 6.3063063063063%"></div>
<pre>
      
  End StrongMonad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 727
Time: 0.107s">
<div class="time" style="width: 96.396396396396%"></div>
<pre>
      
End Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 730
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


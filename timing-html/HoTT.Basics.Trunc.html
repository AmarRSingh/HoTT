<html>
<head>
<title>Trunc.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Trunc.v</h1>

<div class="code" title="File: Trunc.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*-  *)
(** * Truncatedness *)

</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 3
Time: 0.017s">
<div class="time" style="width: 29.824561403509%"></div>
<pre>Require Import Overture PathGroupoids Contractible Equivalences Fibrations.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope trunc_scope.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Generalizable Variables A B m n f.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Arithmetic on truncation-levels. *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Fixpoint trunc_index_add (m n : trunc_index) : trunc_index
  := match m with
       | -2 =&gt; n
       | trunc_S m' =&gt; trunc_S (trunc_index_add m' n)
     end.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation "m -2+ n" := (trunc_index_add m n) (at level 50, left associativity) : trunc_scope.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 15
Time: 0.001s">
<div class="time" style="width: 1.7543859649123%"></div>
<pre>

Fixpoint trunc_index_leq (m n : trunc_index) : Type
  := match m, n with
       | -2, _ =&gt; Unit
       | trunc_S m', -2 =&gt; Empty
       | trunc_S m', trunc_S n' =&gt; trunc_index_leq m' n'
     end.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation "m &lt;= n" := (trunc_index_leq m n) (at level 70, no associativity) : trunc_scope.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Truncatedness proper. *)

(** A contractible space is (-2)-truncated, by definition. *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition contr_trunc_minus_two `{H : IsTrunc -2 A} : Contr A
  := H.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 29
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Truncation levels are cumulative. *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance trunc_succ `{IsTrunc n A} : IsTrunc (trunc_S n) A | 1000.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  generalize dependent A.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 33
Time: 0.001s">
<div class="time" style="width: 1.7543859649123%"></div>
<pre>
  induction n as [| n I]; simpl; intros A H x y.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply contr_paths_contr.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply I, H.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 36
Time: 0.001s">
<div class="time" style="width: 1.7543859649123%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 37
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Instance trunc_leq {m n} (Hmn : m &lt;= n) `{IsTrunc m A} : IsTrunc n A | 1000.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 39
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  generalize dependent A; generalize dependent m.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 41
Time: 0.002s">
<div class="time" style="width: 3.5087719298246%"></div>
<pre>
  induction n as [ | n' IH];
    intros [ | m'] Hmn A ? .</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* -2, -2 *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>assumption.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* S m', -2 *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>destruct Hmn.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* -2, S n' *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 46
Time: 0.001s">
<div class="time" style="width: 1.7543859649123%"></div>
<pre>apply @trunc_succ, (IH -2); auto.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 47
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> (* S m', S n' *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 47
Time: 0.002s">
<div class="time" style="width: 3.5087719298246%"></div>
<pre>intros x y; apply (IH m');
                     auto with typeclass_instances.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 48
Time: 0.002s">
<div class="time" style="width: 3.5087719298246%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Equivalence preserves truncation (this is, of course, trivial with univalence).
   This is not an [Instance] because it causes infinite loops.
   *)</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition trunc_equiv `(f : A -&gt; B)
  `{IsTrunc n A} `{IsEquiv A B f}
  : IsTrunc n B.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  generalize dependent B; generalize dependent A.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 57
Time: 0.001s">
<div class="time" style="width: 1.7543859649123%"></div>
<pre>
  induction n as [| n I]; simpl; intros A ? B f ?.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 58
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (contr_equiv f).</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 60
Time: 0.057s">
<div class="time" style="width: 100%"></div>
<pre>
    exact (I (f^-1 x = f^-1 y) (H (f^-1 x) (f^-1 y)) (x = y) ((ap (f^-1))^-1) _).</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 61
Time: 0.002s">
<div class="time" style="width: 3.5087719298246%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 62
Time: 0.002s">
<div class="time" style="width: 3.5087719298246%"></div>
<pre>

Definition trunc_equiv' `(f : A &lt;~&gt; B) `{IsTrunc n A}
  : IsTrunc n B
  := trunc_equiv f.</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Truncated morphisms *)

</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 69
Time: 0.001s">
<div class="time" style="width: 1.7543859649123%"></div>
<pre>Class IsTruncMap (n : trunc_index) {X Y : Type} (f : X -&gt; Y) :=
  istruncmap_fiber :&gt; forall y:Y, IsTrunc n (hfiber f y).</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Notation IsEmbedding := (IsTruncMap -1).</pre>
</div>
<div class="code" title="File: Trunc.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


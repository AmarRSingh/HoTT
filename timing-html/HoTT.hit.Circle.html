<html>
<head>
<title>Circle.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Circle.v</h1>

<div class="code" title="File: Circle.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)

(** * Theorems about the circle [SÂ¹]. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 4
Time: 0.026s">
<div class="time" style="width: 86.666666666667%"></div>
<pre>Require Import HoTT.Basics.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 4
Time: 0.03s">
<div class="time" style="width: 100%"></div>
<pre>
Require Import Types.Paths Types.Forall Types.Arrow Types.Universe Types.Empty Types.Unit.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 5
Time: 0.011s">
<div class="time" style="width: 36.666666666667%"></div>
<pre>
Require Import HSet UnivalenceImpliesFunext.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Generalizable Variables X A B f g n.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** Definition of the circle. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export Circle.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Private Inductive S1 : Type1 :=
| base : S1.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Axiom loop : base = base.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 17
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Definition S1_ind (P : S1 -&gt; Type) (b : P base) (l : loop # b = b)
  : forall (x:S1), P x
  := fun x =&gt; match x with base =&gt; fun _ =&gt; b end l.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 21
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Axiom S1_ind_beta_loop
  : forall (P : S1 -&gt; Type) (b : P base) (l : loop # b = b),
  apD (S1_ind P b l) loop = l.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Circle.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** The non-dependent eliminator *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 30
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>Definition S1_rec (P : Type) (b : P) (l : b = b)
  : S1 -&gt; P
  := S1_ind (fun _ =&gt; P) b (transport_const _ _ @ l).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 32
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>

Definition S1_rec_beta_loop (P : Type) (b : P) (l : b = b)
  : ap (S1_rec P b l) loop = l.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold S1_rec.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 37
Time: 0.005s">
<div class="time" style="width: 16.666666666667%"></div>
<pre>
  refine (cancelL (transport_const loop b) _ _ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 38
Time: 0.015s">
<div class="time" style="width: 50%"></div>
<pre>
  refine ((apD_const (S1_ind (fun _ =&gt; P) b _) loop)^ @ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 39
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  refine (S1_ind_beta_loop (fun _ =&gt; P) _ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 40
Time: 0.016s">
<div class="time" style="width: 53.333333333333%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** The loop space of the circle is the Integers. *)

(* First we define the appropriate integers. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 46
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>Inductive Pos : Type1 :=
| one : Pos
| succ_pos : Pos -&gt; Pos.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 48
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Definition one_neq_succ_pos (z : Pos) : ~ (one = succ_pos z)
  := fun p =&gt; transport (fun s =&gt; match s with one =&gt; Unit | succ_pos t =&gt; Empty end) p tt.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 51
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Definition succ_pos_injective {z w : Pos} (p : succ_pos z = succ_pos w) : z = w
  := transport (fun s =&gt; z = (match s with one =&gt; w | succ_pos a =&gt; a end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 54
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>

Inductive Int : Type1 :=
| neg : Pos -&gt; Int
| zero : Int
| pos : Pos -&gt; Int.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 59
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Definition neg_injective {z w : Pos} (p : neg z = neg w) : z = w
  := transport (fun s =&gt; z = (match s with neg a =&gt; a | zero =&gt; w | pos a =&gt; w end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 62
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Definition pos_injective {z w : Pos} (p : pos z = pos w) : z = w
  := transport (fun s =&gt; z = (match s with neg a =&gt; w | zero =&gt; w | pos a =&gt; a end)) p (idpath z).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 65
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Definition neg_neq_zero {z : Pos} : ~ (neg z = zero)
  := fun p =&gt; transport (fun s =&gt; match s with neg a =&gt; z = a | zero =&gt; Empty | pos _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 68
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>

Definition pos_neq_zero {z : Pos} : ~ (pos z = zero)
  := fun p =&gt; transport (fun s =&gt; match s with pos a =&gt; z = a | zero =&gt; Empty | neg _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 71
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>

Definition neg_neq_pos {z w : Pos} : ~ (neg z = pos w)
  := fun p =&gt; transport (fun s =&gt; match s with neg a =&gt; z = a | zero =&gt; Empty | pos _ =&gt; Empty end) p (idpath z).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* And prove that they are a set. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance decpaths_int : DecidablePaths Int.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 78
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  intros [n | | n] [m | | m].</pre>
</div>
<div class="code" title="File: Circle.v
Line: 79
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  revert m; induction n as [|n IHn]; intros m; induction m as [|m IHm].</pre>
</div>
<div class="code" title="File: Circle.v
Line: 80
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (inl 1).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 81
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inr (fun p =&gt; one_neq_succ_pos _ (neg_injective p))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 82
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inr (fun p =&gt; one_neq_succ_pos _ (symmetry _ _ (neg_injective p)))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 83
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  destruct (IHn m) as [p | np].</pre>
</div>
<div class="code" title="File: Circle.v
Line: 84
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inl (ap neg (ap succ_pos (neg_injective p)))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 85
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inr (fun p =&gt; np (ap neg (succ_pos_injective (neg_injective p))))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 86
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (inr neg_neq_zero).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (inr neg_neq_pos).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 88
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inr (neg_neq_zero o symmetry _ _)).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (inl 1).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 90
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inr (pos_neq_zero o symmetry _ _)).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 91
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inr (neg_neq_pos o symmetry _ _)).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (inr pos_neq_zero).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 93
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  revert m; induction n as [|n IHn]; intros m; induction m as [|m IHm].</pre>
</div>
<div class="code" title="File: Circle.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (inl 1).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 95
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inr (fun p =&gt; one_neq_succ_pos _ (pos_injective p))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 96
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  exact (inr (fun p =&gt; one_neq_succ_pos _ (symmetry _ _ (pos_injective p)))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 97
Time: 0.004s">
<div class="time" style="width: 13.333333333333%"></div>
<pre>
  destruct (IHn m) as [p | np].</pre>
</div>
<div class="code" title="File: Circle.v
Line: 98
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  exact (inl (ap pos (ap succ_pos (pos_injective p)))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 99
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  exact (inr (fun p =&gt; np (ap pos (succ_pos_injective (pos_injective p))))).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 100
Time: 0.014s">
<div class="time" style="width: 46.666666666667%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance hset_int : IsHSet Int | 0.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 103
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact _.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Successor is an autoequivalence of [Int]. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>Definition succ_int (z : Int) : Int
  := match z with
       | neg (succ_pos n) =&gt; neg n
       | neg one =&gt; zero
       | zero =&gt; pos one
       | pos n =&gt; pos (succ_pos n)
     end.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 115
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>

Definition pred_int (z : Int) : Int
  := match z with
       | neg n =&gt; neg (succ_pos n)
       | zero =&gt; neg one
       | pos one =&gt; zero
       | pos (succ_pos n) =&gt; pos n
     end.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance isequiv_succ_int : IsEquiv succ_int | 0
  := isequiv_adjointify succ_int pred_int _ _.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 127
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  intros [[|n] | | [|n]]; reflexivity.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 128
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  intros [[|n] | | [|n]]; reflexivity.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 129
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Now we do the encode/decode. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section AssumeUnivalence.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Context `{Univalence}.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 134
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>

Definition S1_code : S1 -&gt; Type
  := S1_rec Type Int (path_universe succ_int).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Transporting in the codes fibration is the successor autoequivalence. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 140
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>Definition transport_S1_code_loop (z : Int)
  : transport S1_code loop z = succ_int z.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 142
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  refine (transport_compose idmap S1_code loop z @ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 143
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  unfold S1_code; rewrite S1_rec_beta_loop.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 144
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  apply transport_path_universe.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 145
Time: 0.006s">
<div class="time" style="width: 20%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 146
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>

Definition transport_S1_code_loopV (z : Int)
  : transport S1_code loop^ z = pred_int z.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 150
Time: 0.004s">
<div class="time" style="width: 13.333333333333%"></div>
<pre>
  refine (transport_compose idmap S1_code loop^ z @ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 151
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  rewrite ap_V.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 152
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  unfold S1_code; rewrite S1_rec_beta_loop.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 153
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  rewrite &lt;- (path_universe_V succ_int).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 154
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  apply transport_path_universe.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 155
Time: 0.009s">
<div class="time" style="width: 30%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Encode by transporting *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 159
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>Definition S1_encode (x:S1) : (base = x) -&gt; S1_code x
  := fun p =&gt; p # zero.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Decode by iterating loop. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 163
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>Fixpoint loopexp {A : Type} {x : A} (p : x = x) (n : Pos) : (x = x)
  := match n with
       | one =&gt; p
       | succ_pos n =&gt; loopexp p n @ p
     end.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 167
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>

Definition looptothe (z : Int) : (base = base)
  := match z with
       | neg n =&gt; loopexp (loop^) n
       | zero =&gt; 1
       | pos n =&gt; loopexp (loop) n
     end.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition S1_decode (x:S1) : S1_code x -&gt; (base = x).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 177
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  revert x; refine (S1_ind (fun x =&gt; S1_code x -&gt; base = x) looptothe _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 178
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  apply path_forall; intros z; simpl in z.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 179
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  refine (transport_arrow _ _ _ @ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 180
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  refine (transport_paths_r loop _ @ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 181
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  rewrite transport_S1_code_loopV.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 182
Time: 0.007s">
<div class="time" style="width: 23.333333333333%"></div>
<pre>
  destruct z as [[|n] | | [|n]]; simpl.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 183
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  by apply concat_pV_p.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 184
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  by apply concat_pV_p.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by apply concat_Vp.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by apply concat_1p.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 187
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 188
Time: 0.012s">
<div class="time" style="width: 40%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* The nontrivial part of the proof that decode and encode are equivalences is showing that decoding followed by encoding is the identity on the fibers over [base]. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 192
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>Definition S1_encode_looptothe (z:Int)
  : S1_encode base (looptothe z) = z.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 193
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 194
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  destruct z as [n | | n]; unfold S1_encode.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 195
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  induction n; simpl in *.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 196
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  refine (moveR_transport_V _ loop _ _ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 197
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  by symmetry; apply transport_S1_code_loop.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 198
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  rewrite transport_pp.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 199
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  refine (moveR_transport_V _ loop _ _ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 200
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  refine (_ @ (transport_S1_code_loop _)^).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 201
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assumption.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  reflexivity.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 203
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  induction n; simpl in *.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  by apply transport_S1_code_loop.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 205
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  rewrite transport_pp.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 206
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
  refine (moveR_transport_p _ loop _ _ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 207
Time: 0.002s">
<div class="time" style="width: 6.6666666666667%"></div>
<pre>
  refine (_ @ (transport_S1_code_loopV _)^).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assumption.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 209
Time: 0.008s">
<div class="time" style="width: 26.666666666667%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* Now we put it together. *)

</pre>
</div>
<div class="code" title="File: Circle.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition S1_encode_isequiv (x:S1) : IsEquiv (S1_encode x).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 214
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>
  refine (isequiv_adjointify (S1_encode x) (S1_decode x) _ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 215
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* Here we induct on [x:S1].  We just did the case when [x] is [base]. *)
 </pre>
</div>
<div class="code" title="File: Circle.v
Line: 217
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>refine (S1_ind (fun x =&gt; Sect (S1_decode x) (S1_encode x))
    S1_encode_looptothe _ _).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 218
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* What remains is easy since [Int] is known to be a set. *)
 </pre>
</div>
<div class="code" title="File: Circle.v
Line: 220
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>by apply path_forall; intros z; apply set_path2.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 220
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  (* The other side is trivial by path induction. *)
 </pre>
</div>
<div class="code" title="File: Circle.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>intros []; reflexivity.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 222
Time: 0.003s">
<div class="time" style="width: 10%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 223
Time: 0.001s">
<div class="time" style="width: 3.3333333333333%"></div>
<pre>

Definition equiv_loopS1_int : (base = base) &lt;~&gt; Int
  := BuildEquiv _ _ (S1_encode base) (S1_encode_isequiv base).</pre>
</div>
<div class="code" title="File: Circle.v
Line: 226
Time: 0.009s">
<div class="time" style="width: 30%"></div>
<pre>

End AssumeUnivalence.</pre>
</div>
<div class="code" title="File: Circle.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


<html>
<head>
<title>Fibrations.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Fibrations.v</h1>

<div class="code" title="File: Fibrations.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * Basic facts about fibrations *)

</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 2
Time: 0.05s">
<div class="time" style="width: 100%"></div>
<pre>Require Import HoTT.Basics Types.Sigma Types.Paths.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* ** Homotopy fibers *)

(** Paths in homotopy fibers can be constructed using [path_sigma] and [transport_paths_Fl]. *)

</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 9
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>Definition path_hfiber {A B : Type} {f : A -&gt; B} {y : B}
  {x1 x2 : hfiber f y} (q : x1.1 = x2.1) (r : x1.2 = ap f q @ x2.2)
: x1 = x2.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 11
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 12
Time: 0.002s">
<div class="time" style="width: 4%"></div>
<pre>
  refine (path_sigma _ _ _ q _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 13
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
  refine (transport_paths_Fl _ _ @ _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 14
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>
  apply moveR_Vp, r.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 15
Time: 0.004s">
<div class="time" style="width: 8%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 16
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Homotopic maps have equivalent fibers. *)

</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 19
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>Definition equiv_hfiber_homotopic
           {A B : Type} (f g : A -&gt; B) (h : f == g) (b : B)
: hfiber f b &lt;~&gt; hfiber g b.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 21
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 22
Time: 0.007s">
<div class="time" style="width: 14%"></div>
<pre>
  refine (BuildEquiv _ _ (fun fx =&gt; (fx.1 ; (h fx.1)^ @ fx.2)) _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 23
Time: 0.017s">
<div class="time" style="width: 34%"></div>
<pre>
  refine (isequiv_adjointify _ (fun gx =&gt; (gx.1 ; (h gx.1) @ gx.2)) _ _);
    intros [a p]; simpl.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 26
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre> apply ap, concat_V_pp.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 27
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre> apply ap, concat_p_Vp.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 27
Time: 0.019s">
<div class="time" style="width: 38%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Replacing a map with a fibration *)

</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 31
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>Definition equiv_fibration_replacement  {B C} (f:C -&gt;B):
  C &lt;~&gt; {y:B &amp; hfiber f y}.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 32
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 33
Time: 0.015s">
<div class="time" style="width: 30%"></div>
<pre>
  refine (BuildEquiv _ _ _ (BuildIsEquiv
               C {y:B &amp; {x:C &amp; f x = y}}
               (fun c =&gt; (f c; (c; idpath)))
               (fun c =&gt; c.2.1)
               _
               (fun c =&gt; idpath)
               _)).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 41
Time: 0.011s">
<div class="time" style="width: 22%"></div>
<pre> repeat (intros [] || intro); reflexivity.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 42
Time: 0.005s">
<div class="time" style="width: 10%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 42
Time: 0.016s">
<div class="time" style="width: 32%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 43
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>

Definition hfiber_fibration {X} (x : X) (P:X-&gt;Type):
    P x &lt;~&gt; @hfiber (sigT P) X pr1 x.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 46
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 47
Time: 0.021s">
<div class="time" style="width: 42%"></div>
<pre>
  refine (BuildEquiv _ _ _ (BuildIsEquiv
               (P x) { z : sigT P &amp; z.1 = x }
               (fun Px =&gt; ((x; Px); idpath))
               (fun Px =&gt; transport P Px.2 Px.1.2)
               _
               (fun Px =&gt; idpath)
               _)).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 55
Time: 0.012s">
<div class="time" style="width: 24%"></div>
<pre> repeat (intros [] || intro); reflexivity.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 56
Time: 0.006s">
<div class="time" style="width: 12%"></div>
<pre> reflexivity.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 56
Time: 0.021s">
<div class="time" style="width: 42%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Exercise 4.4: The unstable octahedral axiom. *)

</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section UnstableOctahedral.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Context {A B C} (f : A -&gt; B) (g : B -&gt; C).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 62
Time: 0.002s">
<div class="time" style="width: 4%"></div>
<pre>

  Definition hfiber_compose_map (b : B)
  : hfiber (g o f) (g b) -&gt; hfiber g (g b)
    := fun x =&gt; (f x.1 ; x.2).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 66
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>

  Definition hfiber_hfiber_compose_map (b : B)
  : hfiber (hfiber_compose_map b) (b;1) &lt;~&gt; hfiber f b.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold hfiber, hfiber_compose_map.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 71
Time: 0.005s">
<div class="time" style="width: 10%"></div>
<pre>
    refine (equiv_compose' _ (equiv_inverse (equiv_sigma_assoc _ _))).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 72
Time: 0.002s">
<div class="time" style="width: 4%"></div>
<pre>
    refine (equiv_functor_sigma' (equiv_idmap _) _); intros a; simpl.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 73
Time: 0.008s">
<div class="time" style="width: 16%"></div>
<pre>
    transitivity ({p : g (f a) = g b &amp; {q : f a = b &amp; transport (fun y =&gt; g y = g b) q p = 1}}).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 74
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 75
Time: 0.009s">
<div class="time" style="width: 18%"></div>
<pre> refine (equiv_functor_sigma' (equiv_idmap _)
                (fun p =&gt; equiv_inverse (equiv_path_sigma _ _ _))).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 77
Time: 0.004s">
<div class="time" style="width: 8%"></div>
<pre> refine (equiv_compose' _ (equiv_sigma_symm _)).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 77
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>
      apply equiv_sigma_contr; intros p.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 78
Time: 0.011s">
<div class="time" style="width: 22%"></div>
<pre>
      destruct p; simpl; exact _.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 79
Time: 0.031s">
<div class="time" style="width: 62%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 80
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>

  Definition hfiber_compose (c : C)
  : hfiber (g o f) c &lt;~&gt; { w : hfiber g c &amp; hfiber f w.1 }.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold hfiber, compose.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 85
Time: 0.005s">
<div class="time" style="width: 10%"></div>
<pre>
    refine (equiv_compose' (equiv_sigma_assoc
              (fun x =&gt; g x = c) (fun w =&gt; {x : A &amp; f x = w.1})) _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 87
Time: 0.007s">
<div class="time" style="width: 14%"></div>
<pre>
    refine (equiv_compose' (equiv_functor_sigma' (equiv_idmap B)
             (fun b =&gt; equiv_sigma_symm (fun a p =&gt; f a = b))) _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 89
Time: 0.004s">
<div class="time" style="width: 8%"></div>
<pre>
    refine (equiv_compose' (equiv_sigma_symm _) _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 90
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
    refine (equiv_functor_sigma' (equiv_idmap A) _); intros a.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 91
Time: 0.007s">
<div class="time" style="width: 14%"></div>
<pre>
    refine (equiv_compose' (equiv_functor_sigma' (equiv_idmap B)
              (fun b =&gt; equiv_sigma_symm0 _ _)) _); simpl.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 93
Time: 0.007s">
<div class="time" style="width: 14%"></div>
<pre>
    refine (equiv_compose' (equiv_inverse (equiv_sigma_assoc (fun b =&gt; f a = b) (fun w =&gt; g w.1 = c))) _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 94
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
    symmetry.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 95
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
    refine (@equiv_contr_sigma _ (fun w =&gt; g w.1 = c)
             (* Unfortunately, we appear to have to give this argument explicitly so that Coq finds the correct instance. *)
             (contr_basedpaths (f a))).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 98
Time: 0.038s">
<div class="time" style="width: 76%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 99
Time: 0.025s">
<div class="time" style="width: 50%"></div>
<pre>

End UnstableOctahedral.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Fibers of [functor_sigma] *)

</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 104
Time: 0.005s">
<div class="time" style="width: 10%"></div>
<pre>Definition hfiber_functor_sigma {A B} (P : A -&gt; Type) (Q : B -&gt; Type)
           (f : A -&gt; B) (g : forall a, P a -&gt; Q (f a))
           (b : B) (v : Q b)
: (hfiber (functor_sigma f g) (b; v)) &lt;~&gt;
  {w : hfiber f b &amp; hfiber (g w.1) ((w.2)^ # v)}.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold hfiber, functor_sigma.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 110
Time: 0.004s">
<div class="time" style="width: 8%"></div>
<pre>
  equiv_via ({x : sigT P &amp; {p : f x.1 = b &amp; p # (g x.1 x.2) = v}}).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 112
Time: 0.004s">
<div class="time" style="width: 8%"></div>
<pre> refine (equiv_functor_sigma' (equiv_idmap _)
             (fun x =&gt; equiv_inverse (equiv_path_sigma Q _ _))).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 113
Time: 0.005s">
<div class="time" style="width: 10%"></div>
<pre>
  refine (equiv_compose' _ (equiv_inverse (equiv_sigma_assoc P _))).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 114
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
  equiv_via ({a:A &amp; {q:f a = b &amp; {p : P a &amp; q # (g a p) = v}}}).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  {</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 116
Time: 0.004s">
<div class="time" style="width: 8%"></div>
<pre> refine (equiv_functor_sigma' (equiv_idmap _) (fun a =&gt; _)); simpl.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 116
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>
    refine (equiv_sigma_symm _).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 117
Time: 0.006s">
<div class="time" style="width: 12%"></div>
<pre>
  refine (equiv_compose' _
           (equiv_sigma_assoc (fun a =&gt; f a = b)
             (fun w =&gt; {p : P w.1 &amp; w.2 # (g w.1 p) = v}))).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 120
Time: 0.012s">
<div class="time" style="width: 24%"></div>
<pre>
  refine (equiv_functor_sigma' (equiv_idmap _) _);
    intros [a p]; simpl.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 122
Time: 0.002s">
<div class="time" style="width: 4%"></div>
<pre>
  refine (equiv_functor_sigma' (equiv_idmap _) _);
    intros u; simpl.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 124
Time: 0.001s">
<div class="time" style="width: 2%"></div>
<pre>
  apply equiv_moveL_transport_V.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 125
Time: 0.032s">
<div class="time" style="width: 64%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Theorem 4.7.6 *)</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 128
Time: 0.002s">
<div class="time" style="width: 4%"></div>
<pre>Definition hfiber_functor_sigma_idmap {A} (P Q : A -&gt; Type)
           (g : forall a, P a -&gt; Q a)
           (b : A) (v : Q b)
: (hfiber (functor_sigma idmap g) (b; v)) &lt;~&gt;
   hfiber (g b) v.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 133
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
  refine (equiv_compose' _ (hfiber_functor_sigma P Q idmap g b v)).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 134
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
  refine (@equiv_contr_sigma _
           (fun w =&gt; hfiber (g w.1) (transport Q (w.2)^ v))
           (* Unfortunately, we appear to have to give this argument explicitly so that Coq finds the correct instance. *)
           (contr_basedpaths' b)).</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 138
Time: 0.003s">
<div class="time" style="width: 6%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Fibrations.v
Line: 140
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


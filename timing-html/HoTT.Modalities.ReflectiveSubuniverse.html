<html>
<head>
<title>ReflectiveSubuniverse.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for ReflectiveSubuniverse.v</h1>

<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.039s">
<div class="time" style="width: 19.024390243902%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 1
Time: 0.009s">
<div class="time" style="width: 4.390243902439%"></div>
<pre>
Require Import UnivalenceImpliesFunext EquivalenceVarieties Extensions.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 2
Time: 0.011s">
<div class="time" style="width: 5.3658536585366%"></div>
<pre>
Require Import HoTT.Tactics.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Arguments compose / .</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 8
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * Reflective Subuniverses *)

(** We will define reflective subuniverses using modules.  Since modules are one of the more difficult parts of Coq to understand, and the documentation in the reference manual is a bit sparse, we include here a brief introduction to modules.

For our purposes here, it is appropriate to think of a [Module Type] as analogous to a [Record] type, and a [Module] having that module type (called an "implementation" of it) as analogous to an element of that record type.  For instance, instead of

&lt;&lt;
Record foo :=
  { bar : Type ;
    baz : bar -&gt; Type
  }.
&gt;&gt;

we could write

&lt;&lt;
Module Type foo.
  Parameter bar : Type.
  Parameter baz : bar -&gt; Type
End foo.
&gt;&gt;

and then instead of

&lt;&lt;
Definition qux : foo
  := Build_foo Bool (fun b =&gt; if b then Unit else Empty).
&gt;&gt;

we could write

&lt;&lt;
Module qux &lt;: foo.
  Definition bar : Type
    := Bool.
  Definition baz : bar -&gt; Type
    := fun b =&gt; if b then Unit else Empty.
End qux.
&gt;&gt;

Given these definitions, where we refer to [bar qux] and [baz qux] in the record case, in the module case we would write [qux.bar] and [qux.baz].  However, there are a few essential differences (apart from these syntactic ones).

Firstly, while elements of records are (like everything else in Coq's type theory) strongly typed, modules are duck-typed.  In other words, [qux] is a module of type [foo] simply by virtue of containing fields [bar] and [baz] that have the same types as those declared for the parameters of [foo]; the type declaration [&lt;: foo] only serves to document and enforce this fact.

Secondly, modules do not have to be declared to have any type, or they can have more than one type.  A module is free to contain as many definitions (and other things such as notations, coercions, instances, etc.) as you like, and to "implement" as many module types as you like.  In particular, [qux] could contain additional definitions and it would still be of type [foo].

Thirdly, and more importantly, modules are *second-class*: you cannot pass them around as arguments to functions.  Nor can you construct them "on the fly"; they can only be defined at top level.  However, you can pass a module as an argument to *another module*.  For instance, here is a module which takes a module of type [foo] as an argument.

&lt;&lt;
Module htns (f : foo).
  Definition qjkx : Type
    := { x : f.bar &amp; f.baz x }.
End htns.
&gt;&gt;

Now if we have a [foo], such as [qux], we can pass it as an argument to [htns] and get a new module (again, only at top level):

&lt;&lt;
Module gcrl := htns qux.
&gt;&gt;

After this, we can refer to [gcrl.qjkx] and get [{ x : qux.bar &amp; qux.baz x }].  Together with the fact that modules don't need to have a type, this sort of gives us a way to pass a module as an argument to a collection of functions; we can define a module like [htns] which takes a [foo] as an argument and in which we define many functions depending on [foo]; then whenever we want to apply these functions to a [foo] (such as [qux]) we do the application at top-level, as above with [gcrl].

Unfortunately, Coq does not allow modules to take elements of ordinary types as arguments either; if you want to pass a [nat], say, as an argument to a module, you have to first wrap the [nat] in another module.  You can think of types and module-types as "parallel universes" of types; never the twain shall meet.

Given these annoying limitations, why would anyone ever use modules instead of records?  One reason is that modules are good at (indeed, are more or less designed for) *namespacing*.  In particular, it is possible to [Import] a module, so that all of its fields can be accessed without a dot-prefix.  In fact, every file in Coq is implicitly its own module, and when you say [Require Import Filename.] you are actually [Import]ing a module.  Similarly, modules are used for access control in the private-inductive-types hack that we use to define HITs that compute.

Another reason to use modules, which is the primary reason we choose to use them here, is that the fields of a module are *individually* universe polymorphic.  In other words, in order to define a module of type [foo], as above, you need to give a *polymorphic* definition of [bar] and a *polymorphic* definition of [baz], and the resulting module remembers the polymorphism of each of those fields.  By contrast, a definition of an element of a record type may be itself polymorphic, but an individual *instance* of that definition will pertain only to a fixed collection of universes.

Note that the possibility of individually polymorphic fields practically mandates that modules *must* be second-class.  For a polymorphic field involves an implicit quantification over all universes; hence if the record itself were a first-class object, what universe would it live in?  A mathematician can think of modules as analogous to the proper classes in NBG set theory: they can be "large" without impacting the consistency strength, *because* we are limited in what we can do with them.

In the case in point, if a reflective subuniverse were a record, then "a reflective subuniverse" would be a reflective subuniverse of only *one* universe.  A polymorphic definition of a particular reflective subuniverse would result in defining related reflective subuniverses of every universe, but the relation *between* these subuniverses would not be specified.  In particular, if we have types [X : Type@{i}] and [Y : Type@{j}] in different universes and a map [f : X -&gt; Y], while [Y] is in the subuniverse of [Type@{j}], we could not apply the universal property to extend [f] to a map [O X -&gt; Y], since the universal property asserted for [O@{i} X] would only refer to maps with target also in [Type@{i}].  This is at best annoying; for instance, it means that we couldn't define, say, [Trunc_functor] by using [O_functor] and then proceed to apply it to maps between types in different universes (which turns out to be necessary sometimes).  At worst, such as when trying to prove that the universe of modal types for a lex modalities is itself modal, this approach seems more or less unworkable.

Therefore, we choose to make a reflective subuniverse a module.  This means that in order to define "a reflective subuniverse", you have to give a *polymorphic* definition of the reflector, the universal property, etc.  In particular, the universal property must be polymorphic enough to allow the situation with [X : Type@{i}] and [Y : Type@{j}] considered above.

There are some issues involving this choice that must be addressed.  One of them is that when implementing a polymorphic module types, Coq is *very* strict about matching up the polymorphism.  Specifically, each [Definition] in the implementing module must have *exactly* the same number of universe parameters as the corresponding [Parameter] in the module type, and all the constraints in the former must be implied by those in the latter.  This ensures that the implementation is "at least as polymorphic" as the specification.

Now normally, a polymorphic definition will end up with many more universes than it needs, and we have little control over how many those are.  Therefore, in order to have a chance of ensuring that our implementations of module types match up in polymorphism, we almost always need to add explicit universe annotations in order to control how many universe parameters they end up with.  This is slightly annoying, but fortunately it only needs to be dealt with when *defining* a particular reflective subuniverse; to users the polymorphism should be invisible and automatic.

This also means it is important that we know exactly how many universe parameters each field of our module types is *expected* to take.  It would be nice if Coq had a feature for declaring (and verifying) the universe parameters of a definition in the same way that we declare the type parameters.  In the absence of this (requested at https://coq.inria.fr/bugs/show_bug.cgi?id=3818), we write [Check foo@{a b c}.] after the definition of [foo] to declare that [foo] takes three universe parameters.  Note that this will fail with an [Error] unless [foo] does in fact take exactly three universe parameters.

Another issue that must be dealt with is the fact, mentioned above, that a module cannot be parametrized over an ordinary type.  However, it frequently happens that we do want to define a family of reflective subuniverses, e.g. the n-truncation modalities for all [n : trunc_index], or the open and closed modalities for all [U : hProp].  The solution we choose is for our basic [Module Type] to represent not a *single* reflective subuniverse, but an entire *family* of them, parametrized by some type.  This can be regarded as analogous to how when doing mathematics relative to a base topos, the correct notion of "large category" is an *indexed category* (a.k.a. fibration), which comes with a basic notion of "[I]-indexed family of objects" for all [I] in the base topos.
*)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 93
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** As mentioned above, an implementation of this module type is a *family* of reflective subuniverses, indexed by the below type [ReflectiveSubuniverse].  If we just wrote [ReflectiveSubuniverse : Type], then it would end up parametrized by one universe, but in many examples the natural definition of the parametrizing type involves also a smaller universe, which would cause problems with Coq's strict polymorphism enforcement for module type implementations.  Thus, we use [Type2] instead, which takes two universe parameters. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter ReflectiveSubuniverse : Type2@{u a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check ReflectiveSubuniverse@{u a}.

  (** The universe parameters occurring in the definitions here play one of four roles, which we indicate consistently by [u], [a], [i], and [j].

  - [u] is the size of the parametrizing type [ReflectiveSubuniverse] (and, later, also [Modality]).
  - [a] is the size of smaller type-data occurring in that type, such as the family of generators for a localization.  This generally must be strictly smaller than [u].
  - [i] is the size of a type that we are reflecting or testing to be in the subuniverse.  This is generally at least as big as [a].
  - [j] is the size of a type that we are eliminating into (out of a type in [i]) with a universal property.  Also generally at least as big as [a].
  - [k] is a universe at least as large as both [i] and [j], in which statements about types in both of them can live. *)

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter O_reflector : forall (O : ReflectiveSubuniverse@{u a}),
                            Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check O_reflector@{u a i}.    (** Verify that we have the right number of universes *)

  (** For reflective subuniverses (and hence also modalities), it will turn out that [In O T] is equivalent to [IsEquiv (O_unit T)].  We could define the former as the latter, and it would simplify some of the general theory.  However, in many examples there is a "more basic" definition of [In O] which is equivalent, but not definitionally identical, to [IsEquiv (O_unit T)].  Thus, including [In O] as data makes more things turn out to be judgmentally what we would expect. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 112
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter inO_internal : forall (O : ReflectiveSubuniverse@{u a}),
                             Type2le@{i a} -&gt; Type2le@{i a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check inO_internal@{u a i}.

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 116
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter O_inO_internal : forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                               inO_internal@{u a i} O (O_reflector@{u a i} O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check O_inO_internal@{u a i}.

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter to : forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                   T -&gt; O_reflector@{u a i} O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check to@{u a i}.

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter inO_equiv_inO_internal :
      forall (O : ReflectiveSubuniverse@{u a}) (T U : Type@{i})
             (T_inO : inO_internal@{u a i} O T) (f : T -&gt; U) (feq : IsEquiv f),
        inO_internal@{u a i} O U.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check inO_equiv_inO_internal@{u a i}.

  (** In most examples, [Funext] is necessary to prove that the predicate of being in the subuniverse is an hprop.  To avoid needing to assume [Funext] as a global hypothesis when constructing such examples, and since [Funext] is often not needed for any of the rest of the theory, we add it as a hypothesis to this specific field. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter hprop_inO_internal
  : Funext -&gt; forall (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}),
                IsHProp (inO_internal@{u a i} O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check hprop_inO_internal@{u a i}.

  (** We express the universal property using the representation [ooExtendableAlong] of precomposition equivalences.  This has the advantage that it avoids the funext redexes that otherwise infect the theory, thereby simplifying the proofs and proof terms.  We never have to worry about whether we have a path between functions or a homotopy; we use only homotopies, with no need for [ap10] or [path_arrow] to mediate.  Furthermore, the data in [ooExtendableAlong] are all special cases of the induction principle of a modality.  Thus, all the theorems we prove about reflective subuniverses will, when interpreted for a modality (coerced as above to a reflective subuniverse), reduce definitionally to "the way we would have proved them directly for a modality".  *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter extendable_to_O_internal
  : forall (O : ReflectiveSubuniverse@{u a}) {P : Type2le@{i a}} {Q : Type2le@{j a}} {Q_inO : inO_internal@{u a j} O Q},
      ooExtendableAlong@{i i j k} (to O P) (fun _ =&gt; Q).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check extendable_to_O_internal@{u a i j k}.

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>End ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** We now begin a parametrized module to incorporate most of the theory of reflective subuniverses.  Thus, after defining a particular family of reflective subuniverses, you can apply this module and [Import] it to get all of the theory.  (Some suggested naming conventions for these modules can be found in Modality.v.)  *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module ReflectiveSubuniverses_Theory (Os : ReflectiveSubuniverses).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Export Os.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We now give new names or identities to all the "internal" fields.  This serves several purposes.  Firstly, it allows us to make "being in the subuniverse" into a typeclass. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Class In (O : ReflectiveSubuniverse@{u a}) (T : Type@{i}) :=
  in_inO_internal : inO_internal@{u a i} O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Typeclasses Transparent In.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 150
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The type of types in the subuniverse *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 152
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition Type_ (O : ReflectiveSubuniverse) : Type
  := {T : Type &amp; In O T}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 153
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Before going on, we declare some coercions in a module, so that they can be imported separately.  In fact, this submodule should be exported by any file that defines a reflective subuniverse.  *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export Coercions.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 155
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We allow the name of a subuniverse or modality to be used as the name of its reflector.  This means that when defining a particular example, you should generally put the parametrizing family in a wrapper, so that you can notate the subuniverse as parametrized by, rather than identical to, its parameter.  See Modality.v, Truncations.v, and Localization.v for examples. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Coercion O_reflector : ReflectiveSubuniverse &gt;-&gt; Funclass.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Obviously, every element of [Type_ O] is a type. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Coercion TypeO_pr1 O (T : Type_ O) := @pr1 Type (In O) T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 161
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Coercions.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** With this given, we now essentially have to redefine almost all the other fields so that they refer explicitly to the class [In] rather than to [inO_internal], so that Coq is willing to do typeclass inference for them. *)

(** We assumed repleteness of the subuniverse in the definition.  Of course, with univalence this would be automatic, but we include it as a hypothesis since this is the only appearance of univalence in the theory of reflective subuniverses and non-lex modalities, and most or all examples can be shown to be replete without using univalence. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 167
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition inO_equiv_inO {O : ReflectiveSubuniverse}
           T {U} {T_inO : In O T} (f : T -&gt; U) {feq : IsEquiv f}
: In O U
:= inO_equiv_inO_internal O T U T_inO f feq.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Being in the subuniverse is a mere predicate (by hypothesis) *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance hprop_inO {fs : Funext} {O : ReflectiveSubuniverse} (T : Type)
  : IsHProp (In O T)
  := hprop_inO_internal fs O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** [O T] is always in the subuniverse (by hypothesis).  This needs a universe annotation to become sufficiently polymorphic. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance O_inO {O : ReflectiveSubuniverse} (T : Type) : In O (O T)
  := O_inO_internal O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The second component of [TypeO] is unique *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 179
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>Definition path_TypeO {fs : Funext} O (T T' : Type_ O) (p : T.1 = T'.1)
  : T = T'
  := path_sigma_hprop T T' p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 181
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

Definition extendable_to_O (O : ReflectiveSubuniverse)
           {P Q : Type} {Q_inO : In O Q}
: ooExtendableAlong (to O P) (fun _ =&gt; Q)
  := @extendable_to_O_internal O P Q Q_inO.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We now extract the recursion principle and the restricted induction principles for paths. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section ORecursion.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context {O : ReflectiveSubuniverse}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 189
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>

  Definition O_rec {P Q : Type} {Q_inO : In O Q}
             (f : P -&gt; Q)
  : O P -&gt; Q
  := (fst (extendable_to_O O 1%nat) f).1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 194
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>

  Definition O_rec_beta {P Q : Type} {Q_inO : In O Q}
             (f : P -&gt; Q) (x : P)
  : O_rec f (to O P x) = f x
  := (fst (extendable_to_O O 1%nat) f).2 x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 199
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>

  Definition O_indpaths {P Q : Type} {Q_inO : In O Q}
             (g h : O P -&gt; Q) (p : g o to O P == h o to O P)
  : g == h
  := (fst (snd (extendable_to_O O 2) g h) p).1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 204
Time: 0.008s">
<div class="time" style="width: 3.9024390243902%"></div>
<pre>

  Definition O_indpaths_beta {P Q : Type} {Q_inO : In O Q}
             (g h : O P -&gt; Q) (p : g o (to O P) == h o (to O P)) (x : P)
  : O_indpaths g h p (to O P x) = p x
  := (fst (snd (extendable_to_O O 2) g h) p).2 x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 209
Time: 0.01s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>

  Definition O_ind2paths {P Q : Type} {Q_inO : In O Q}
             {g h : O P -&gt; Q} (p q : g == h)
             (r : p oD (to O P) == q oD (to O P))
  : p == q
  := (fst (snd (snd (extendable_to_O O 3) g h) p q) r).1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 215
Time: 0.013s">
<div class="time" style="width: 6.3414634146341%"></div>
<pre>

  Definition O_ind2paths_beta {P Q : Type} {Q_inO : In O Q}
             {g h : O P -&gt; Q} (p q : g == h)
             (r : p oD (to O P) == q oD (to O P)) (x : P)
  : O_ind2paths p q r (to O P x) = r x
  := (fst (snd (snd (extendable_to_O O 3) g h) p q) r).2 x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Clearly we can continue indefinitely as needed. *)

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 224
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>End ORecursion.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* We never want to see [extendable_to_O]. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Arguments O_rec : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 226
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_rec_beta : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_indpaths : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_indpaths_beta : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_ind2paths : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments O_ind2paths_beta : simpl never.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Given [Funext], we prove the definition of reflective subuniverse in the book. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 233
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>Global Instance isequiv_o_to_O `{Funext}
       (O : ReflectiveSubuniverse) (P Q : Type) `{In O Q}
: IsEquiv (fun g : O P -&gt; Q =&gt; g o to O P)
:= isequiv_ooextendable _ _ (extendable_to_O O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 236
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>

Definition equiv_o_to_O `{Funext}
           (O : ReflectiveSubuniverse) (P Q : Type) `{In O Q}
: (O P -&gt; Q) &lt;~&gt; (P -&gt; Q)
:= BuildEquiv _ _ (fun g : O P -&gt; Q =&gt; g o to O P) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Properties of Reflective Subuniverses *)

(** We now prove a bunch of things about an arbitrary reflective subuniverse. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context (O : ReflectiveSubuniverse).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 246
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Functoriality of [O_rec] homotopies *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 249
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>Definition O_rec_homotopy {P Q : Type} `{In O Q} (f g : P -&gt; Q) (pi : f == g)
  : O_rec f == O_rec g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 251
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    apply O_indpaths; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 252
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
    etransitivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 255
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre> etransitivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (pi _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 257
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre> symmetry; apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 257
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 257
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 257
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** If [T] is in the subuniverse, then [to O T] is an equivalence. *)
 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isequiv_to_O_inO (T : Type) `{In O T} : IsEquiv (to O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 261
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    pose (g := O_rec idmap).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 263
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    refine (isequiv_adjointify (to O T) g _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 264
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 265
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre> refine (O_indpaths (to O T o g) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 269
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 270
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 271
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>

  Definition equiv_to_O (T : Type) `{In O T} : T &lt;~&gt; O T
    := BuildEquiv T (O T) (to O T) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 276
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** In this section, we see that [O] is a functor. *)
    
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 280
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>Definition O_functor {A B : Type} (f : A -&gt; B) : O A -&gt; O B
      := O_rec (to O B o f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on composition *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 284
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>Definition O_functor_compose {A B C : Type} (f : A -&gt; B) (g : B -&gt; C)
    : (O_functor (g o f)) == (O_functor g) o (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 286
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply O_indpaths; intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 287
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      refine (O_rec_beta (to O C o g o f) x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 288
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      transitivity (O_functor g (to O B (f x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 290
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 290
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> exact (O_rec_beta (to O C o g) (f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 290
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 291
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre> apply ap; symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 291
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
        exact (O_rec_beta (to O B o f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 292
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 293
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on homotopies (2-functoriality) *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 296
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition O_functor_homotopy {A B : Type} (f g : A -&gt; B) (pi : f == g)
    : O_functor f == O_functor g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 297
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 298
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 299
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      refine (O_rec_beta (to O B o f) x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 300
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      refine (_ @ (O_rec_beta (to O B o g) x)^).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold compose; apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 302
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply pi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 303
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Hence functoriality on commutative squares *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 307
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>Definition O_functor_square {A B C X : Type} (pi1 : X -&gt; A) (pi2 : X -&gt; B)
               (f : A -&gt; C) (g : B -&gt; C) (comm : (f o pi1) == (g o pi2))
    : ( (O_functor f) o (O_functor pi1) )
      == ( (O_functor g) o (O_functor pi2) ).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 311
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 312
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      transitivity (O_functor (f o pi1) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 314
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre> symmetry; apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 314
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 315
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre> transitivity (O_functor (g o pi2) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 316
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> apply O_functor_homotopy, comm.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 317
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> apply O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 317
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Functoriality on identities *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 321
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition O_functor_idmap (A : Type)
    : @O_functor A A idmap == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 322
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 323
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 324
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 325
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 326
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** 3-functoriality, as an example use of [O_ind2paths] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 329
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>Definition O_functor_2homotopy {A B : Type} {f g : A -&gt; B}
               (p q : f == g) (r : p == q)
    : O_functor_homotopy f g p == O_functor_homotopy f g q.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 332
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>
      refine (O_ind2paths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_functor_homotopy, composeD.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 334
Time: 0.016s">
<div class="time" style="width: 7.8048780487805%"></div>
<pre>
      do 2 rewrite O_indpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 335
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
      apply whiskerL, whiskerR, ap, r.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 336
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** Of course, if we wanted to prove 4-functoriality, we'd need to make this transparent. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0.034s">
<div class="time" style="width: 16.585365853659%"></div>
<pre>Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Naturality of [to O] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 341
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>Definition to_O_natural {A B : Type} (f : A -&gt; B)
    : (O_functor f) o (to O A) == (to O B) o f
    := (O_rec_beta _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The pointed endofunctor ([O],[to O]) is well-pointed *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 346
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition O_functor_wellpointed (A : Type)
    : O_functor (to O A) == to O (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 347
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 348
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 349
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 350
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Preservation of equivalences *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 354
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Global Instance isequiv_O_functor {A B : Type} (f : A -&gt; B) `{IsEquiv _ _ f}
    : IsEquiv (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 355
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 356
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      refine (isequiv_adjointify (O_functor f) (O_functor f^-1) _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 357
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 358
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
        refine ((O_functor_compose _ _ x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 359
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
        refine (O_functor_homotopy _ idmap _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 360
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y; apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 362
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 362
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 363
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 363
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
        refine ((O_functor_compose _ _ x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 364
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
        refine (O_functor_homotopy _ idmap _ x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 365
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros y; apply eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 367
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 368
Time: 0.031s">
<div class="time" style="width: 15.121951219512%"></div>
<pre>
      
    Definition equiv_O_functor {A B : Type} (f : A &lt;~&gt; B)
    : O A &lt;~&gt; O B
    := BuildEquiv _ _ (O_functor f) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 372
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Postcomposition respects [O_rec] *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 375
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>Definition O_rec_postcompose {A B C : Type} `{In O B} {C_inO : In O C}
               (f : A -&gt; B) (g : B -&gt; C)
    : g o O_rec f == O_rec (g o f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 378
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x; unfold compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 379
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      transitivity (g (f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 380
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 381
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> symmetry.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 382
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec_beta (g o f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 382
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 383
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>

  End Functor.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 385
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Replete.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** An equivalent formulation of repleteness is that a type lies in the subuniverse as soon as its unit map is an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 390
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>Definition inO_isequiv_to_O (T:Type)
    : IsEquiv (to O T) -&gt; In O T
    := fun _ =&gt; inO_equiv_inO (O T) (to O T)^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (* We don't make this an ordinary instance, but we allow it to solve [In O] constraints if we already have [IsEquiv] as a hypothesis.  *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Hint Immediate inO_isequiv_to_O : typeclass_instances.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 395
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition inO_iff_isequiv_to_O (T:Type)
    : In O T &lt;-&gt; IsEquiv (to O T).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 398
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 399
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      split; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 401
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Thus, [T] is in a subuniverse as soon as [to O T] admits a retraction. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition inO_to_O_retract (T:Type) (mu : O T -&gt; T)
    : Sect (to O T) mu -&gt; In O T.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 405
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold Sect; intros H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_isequiv_to_O.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 408
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply isequiv_adjointify with (g:=mu).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 410
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre> refine (O_indpaths (to O T o mu) idmap _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 410
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        intros x; exact (ap (to O T) (H x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 412
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 412
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 413
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  End Replete.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The maps that are inverted by the reflector.  Note that this notation is NOT GLOBAL, it only exists in this section. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Notation O_inverts f := (IsEquiv (O_functor f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance O_inverts_O_unit (A : Type)
    : O_inverts (to O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 424
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>
      refine (isequiv_homotopic (to O (O A)) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 425
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      intros x; symmetry; apply O_functor_wellpointed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 426
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** A map between modal types that is inverted by [O] is already an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 430
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition isequiv_O_inverts {A B : Type} `{In O A} `{In O B}
      (f : A -&gt; B) `{O_inverts f}
    : IsEquiv f.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 432
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 433
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>
      refine (isequiv_commsq' f (O_functor f) (to O A) (to O B) _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 435
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 436
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>

    Definition equiv_O_inverts {A B : Type} `{In O A} `{In O B}
      (f : A -&gt; B) `{O_inverts f}
    : A &lt;~&gt; B
    := BuildEquiv _ _ f (isequiv_O_inverts f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 441
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>

    Definition to_O_inv_natural {A B : Type} `{In O A} `{In O B}
               (f : A -&gt; B)
    : (to O B)^-1 o (O_functor f) == f o (to O A)^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 445
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 446
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold compose; apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 448
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      refine (to_O_natural f x @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 449
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold compose; do 2 apply ap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 450
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      symmetry; apply eissect.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 451
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Two maps between modal types that become equal after applying [O_functor] are already equal. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 455
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition O_functor_faithful_inO {A B : Type} `{In O A} `{In O B}
      (f g : A -&gt; B) (e : O_functor f == O_functor g)
      : f == g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 459
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      refine (ap f (eissect (to O A) x)^ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 460
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      refine (_ @ ap g (eissect (to O A) x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 461
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      transitivity ((to O B)^-1 (O_functor f (to O A x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 462
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 463
Time: 0.042s">
<div class="time" style="width: 20.487804878049%"></div>
<pre> symmetry; apply to_O_inv_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 463
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 464
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre> transitivity ((to O B)^-1 (O_functor g (to O A x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 464
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap, e.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 465
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        *</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 466
Time: 0.041s">
<div class="time" style="width: 20%"></div>
<pre> apply to_O_inv_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 466
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 467
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Any map to a type in the subuniverse that is inverted by [O] must be equivalent to [to O].  More precisely, the type of such maps is contractible. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 470
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition typeof_to_O (A : Type)
      := { OA : Type &amp; { Ou : A -&gt; OA &amp; ((In O OA) * (O_inverts Ou)) }}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 471
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance contr_typeof_O_unit `{Univalence} (A : Type)
    : Contr (typeof_to_O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 474
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 475
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      exists (O A ; (to O A ; (_ , _))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 476
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
      intros [OA [Ou [? ?]]].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 477
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (f := O_rec Ou : O A -&gt; OA).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 478
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      pose (g := (O_functor Ou)^-1 o to O OA : (OA -&gt; O A)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 479
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assert (IsEquiv f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 480
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 481
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> refine (isequiv_adjointify f g _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 481
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 482
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply O_functor_faithful_inO; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 482
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
          rewrite O_functor_idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 483
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
          fold (f o g); rewrite O_functor_compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 484
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 485
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>
          simpl rewrite (O_functor_compose (to O OA) (O_functor Ou)^-1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 486
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
          rewrite O_functor_wellpointed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 487
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
          simpl rewrite (to_O_natural (O_functor Ou)^-1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 488
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
          refine (to_O_natural f _ @ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 489
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
          set (y := (O_functor Ou)^-1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 490
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
          transitivity (O_functor Ou y); try apply eisretr.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold f, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 492
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
          apply O_rec_postcompose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 493
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 494
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre> refine (O_indpaths _ _ _); intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 494
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          unfold f, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 495
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
          rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 496
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          apply moveR_equiv_V.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 497
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
          symmetry; apply to_O_natural.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 498
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 499
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>
      refine (path_sigma _ _ _ _ _); cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (path_universe f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 501
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 502
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre> rewrite transport_sigma.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 502
Time: 0.1s">
<div class="time" style="width: 48.780487804878%"></div>
<pre>
        refine (path_sigma _ _ _ _ _); cbn; try apply path_ishprop.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply path_arrow; intros x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 504
Time: 0.022s">
<div class="time" style="width: 10.731707317073%"></div>
<pre>
        rewrite transport_arrow_fromconst.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 505
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
        rewrite transport_path_universe.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold f; apply O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 507
Time: 0.069s">
<div class="time" style="width: 33.658536585366%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 508
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>

  End OInverts.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 512
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** The [Unit] type *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_unit : In O Unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 516
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_to_O_retract with (mu := fun x =&gt; tt).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 517
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (@contr Unit _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 518
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 519
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** It follows that any contractible type is in [O]. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_contr {A : Type} `{Contr A} : In O A.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 523
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      exact (inO_equiv_inO Unit (equiv_inverse equiv_contr_unit)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 524
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 525
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** And that the reflection of a contractible type is still contractible. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 528
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance contr_O_contr {A : Type} `{Contr A} : Contr (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 528
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 529
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      exact (contr_equiv A (to O A)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 530
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Dependent product and arrows *)
    (** Theorem 7.7.2 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_forall {fs : Funext} (A:Type) (B:A -&gt; Type) 
    : (forall x, (In O (B x)))
      -&gt; (In O (forall x:A, (B x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 537
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 538
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 539
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (ev := fun x =&gt; (fun (f:(forall x, (B x))) =&gt; f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 540
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (zz := fun x:A =&gt; O_rec (ev x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 541
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_to_O_retract with (mu := fun z =&gt; fun x =&gt; zz x z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 542
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro phi.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 543
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold zz, ev; clear zz; clear ev.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 544
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_forall; intro x.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 545
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_rec_beta (fun f : forall x0, (B x0) =&gt; f x) phi).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 546
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance inO_arrow {fs : Funext} (A B : Type) `{In O B}
    : In O (A -&gt; B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 551
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_forall.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 552
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 553
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Product *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 557
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_prod (A B : Type) `{In O A} `{In O B}
    : In O (A*B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 559
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply inO_to_O_retract with
        (mu := fun X =&gt; (@O_rec _ (A * B) A _ fst X , O_rec snd X)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 561
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      intros [a b]; apply path_prod; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec_beta fst (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 564
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (O_rec_beta snd (a,b)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 564
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 565
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** We show that [OA*OB] has the same universal property as [O(A*B)] *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 569
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition equiv_O_prod_unit_precompose
               {fs : Funext} (A B C : Type) `{In O C}
    : ((O A) * (O B) -&gt; C) &lt;~&gt; (A * B -&gt; C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 572
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply (equiv_compose' (equiv_uncurry A B C)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 573
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      refine (equiv_compose' _ (equiv_inverse (equiv_uncurry (O A) (O B) C))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 574
Time: 0.011s">
<div class="time" style="width: 5.3658536585366%"></div>
<pre>
      apply (equiv_compose' (equiv_o_to_O _ A (B -&gt; C))); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply equiv_postcompose'.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 576
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (equiv_o_to_O _ B C).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 577
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** The preceding equivalence turns out to be actually (judgmentally!) precomposition with the following function. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 581
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition O_prod_unit (A B : Type) : A * B -&gt; O A * O B
      := functor_prod (to O A) (to O B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** From this, we can define the comparison map for products, and show that precomposing with it is also an equivalence. *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 585
Time: 0.011s">
<div class="time" style="width: 5.3658536585366%"></div>
<pre>Definition O_prod_cmp (A B : Type) : O (A * B) -&gt; O A * O B
      := O_rec (O_prod_unit A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 586
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

    Global Instance isequiv_O_prod_cmp (A B : Type)
    : IsEquiv (O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 589
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (isequiv_adjointify _ _ _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 592
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply prod_ind; intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 592
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_rec; intro b; revert a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 593
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply O_rec; intro a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 594
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        apply (to O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 595
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (a, b).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 597
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold prod_ind, O_prod_cmp, O_prod_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 597
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
        intros [oa ob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 598
Time: 0.013s">
<div class="time" style="width: 6.3414634146341%"></div>
<pre>
        revert ob; refine (O_indpaths _ _ _); intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 599
Time: 0.015s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>
        revert oa; refine (O_indpaths _ _ _); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 601
Time: 0.018s">
<div class="time" style="width: 8.780487804878%"></div>
<pre> abstract (repeat rewrite O_rec_beta; reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 601
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold prod_ind, O_prod_cmp, O_prod_unit.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 602
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>
        refine (O_indpaths _ _ _); intros [a b]; cbn.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 603
Time: 0.018s">
<div class="time" style="width: 8.780487804878%"></div>
<pre>
        abstract (repeat (rewrite O_rec_beta; cbn); reflexivity).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 604
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 604
Time: 0.043s">
<div class="time" style="width: 20.975609756098%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 605
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>

    Definition isequiv_O_prod_cmp_precompose
      {fs : Funext} (A B C : Type) {C_inO : In O C}
    : IsEquiv (fun h : O A * O B -&gt; C =&gt; h o O_prod_cmp A B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 609
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 610
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply isequiv_precompose; exact _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 611
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 612
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>

    Definition equiv_O_prod_cmp {fs : Funext} (A B : Type)
    : O (A * B) &lt;~&gt; (O A * O B)
    := BuildEquiv _ _ (O_prod_cmp A B) _.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 616
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Dependent sums *)
    (** Theorem 7.7.4 *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 620
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>Definition inO_sigma_from_O_ind
    : (forall (A:Type@{i}) (B: (O A) -&gt; Type@{j}) `{forall a, In@{u a j} O (B a)}
              (g : forall (a:A), (B (to O A a))),
         {f : forall (z:O A), (B z) &amp; forall a:A, f (to@{u a i} O A a) = g a})
      -&gt;
      (forall (A:Type@{i}) (B:A -&gt; Type@{j}) `{In@{u a i} O A} `{forall a, In@{u a j} O (B a)},
         (In@{u a j} O (sig@{i j} (fun x:A =&gt; B x)))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 626
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 627
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros H A B ? ?.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 628
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
             pose (h := fun x =&gt; @O_rec _ ({x:A &amp; B x}) A _ pr1 x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 629
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      pose (p := (fun z =&gt; O_rec_beta pr1 z)
                 : h o (to O _) == pr1).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 631
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (g := fun z =&gt; (transport B ((p z)^) z.2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 632
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simpl in *.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 633
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
      specialize (H ({x:A &amp; B x}) (B o h) _ g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 634
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      destruct H as [f q].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 635
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply inO_to_O_retract with (mu := fun w =&gt; (h w; f w)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 636
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros [x1 x2].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 637
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      refine (path_sigma B _ _ _ _); simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 638
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply p.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 640
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> rewrite (q (x1;x2)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 640
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        unfold g; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (transport_pV B _ _).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 641
Time: 0.008s">
<div class="time" style="width: 3.9024390243902%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 642
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

    Definition O_ind_from_inO_sigma
    (** Work around https://coq.inria.fr/bugs/show_bug.cgi?id=3811 *)
    : (forall (A:Type@{i}) (B:A -&gt; Type@{j}) {A_inO : In@{u a i} O A} `{forall a, In@{u a j} O (B a)},
         (In@{u a j} O (sig@{i j} (fun x:A =&gt; B x))))
      -&gt;
      (forall (A:Type@{i}) (B: (O A) -&gt; Type@{j}) `{forall a, In@{u a j} O (B a)}
              (g : forall (a:A), (B (to O A a))),
         {f : forall (z:O A), (B z) &amp; forall a:A, f (to@{u a i} O A a) = g a}).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 652
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intro H.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros A B ? g.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (Z := sigT B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 654
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      assert (In@{u a j} O Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 655
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 656
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> apply H; [ exact _ | assumption ].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (g' := (fun a:A =&gt; (to O A a ; g a)) : A -&gt; Z).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 657
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (f' := O_rec g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 658
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      pose (eqf := (O_rec_beta g')  : f' o to O A == g').</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 659
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
      pose (eqid := O_indpaths (pr1 o f') idmap
                               (fun x =&gt; ap pr1 (eqf x))).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 661
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      exists (fun z =&gt; transport B (eqid z) ((f' z).2)); intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 662
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold eqid.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 663
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre> rewrite O_indpaths_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 663
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      exact (pr2_path (O_rec_beta g' a)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 664
Time: 0.008s">
<div class="time" style="width: 3.9024390243902%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 665
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** ** Paths *)

   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 669
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance inO_paths (S : Type) {S_inO : In O S} (x y : S)
    : In O (x=y).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 670
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 671
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      refine (inO_to_O_retract _ _ _); intro u.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 672
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 673
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assert (p : (fun _ : O (x=y) =&gt; x) == (fun _=&gt; y)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 673
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> 
        {</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 674
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre> refine (O_indpaths _ _ _); unfold compose; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 674
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
          intro v; exact v.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 675
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> }</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 675
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (p u).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 676
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 677
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> hnf.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 677
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
        rewrite O_indpaths_beta; reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 678
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 679
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    
  End Types.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 681
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Monad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 683
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

    Definition O_monad_mult (A : Type) : O (O A) -&gt; O A
      := O_rec idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 686
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>

    Definition O_monad_mult_natural {A B} (f : A -&gt; B)
    : O_functor f o O_monad_mult A == O_monad_mult B o O_functor (O_functor f).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 689
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 690
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply O_indpaths; intros x; unfold compose, O_monad_mult.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 691
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      simpl rewrite (to_O_natural (O_functor f) x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 692
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      rewrite (O_rec_beta idmap x).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 693
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      rewrite (O_rec_beta idmap (O_functor f x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 694
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 695
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 696
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

    Definition O_monad_unitlaw1 (A : Type)
    : O_monad_mult A o (to O (O A)) == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 699
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 700
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply O_indpaths; intros x; unfold compose, O_monad_mult.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 701
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (O_rec_beta idmap (to O A x)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 702
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 703
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

    Definition O_monad_unitlaw2 (A : Type)
    : O_monad_mult A o (O_functor (to O A)) == idmap.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 706
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 707
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_mult, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 708
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 709
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 710
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 711
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

    Definition O_monad_mult_assoc (A : Type)
    : O_monad_mult A o O_monad_mult (O A) == O_monad_mult A o O_functor (O_monad_mult A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 714
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 715
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_mult, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 716
Time: 0.01s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 717
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 718
Time: 0.006s">
<div class="time" style="width: 2.9268292682927%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 719
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>

  End Monad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 721
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section StrongMonad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 723
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Context {fs : Funext}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 724
Time: 0.034s">
<div class="time" style="width: 16.585365853659%"></div>
<pre>

    Definition O_monad_strength (A B : Type) : A * O B -&gt; O (A * B)
      := fun aob =&gt; O_rec (fun b a =&gt; to O (A*B) (a,b)) (snd aob) (fst aob).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 727
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>

    Definition O_monad_strength_natural (A A' B B' : Type) (f : A -&gt; A') (g : B -&gt; B')
    : O_functor (functor_prod f g) o O_monad_strength A B ==
      O_monad_strength A' B' o functor_prod f (O_functor g).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 731
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 732
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      intros [a ob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 733
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 733
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 733
Time: 0.038s">
<div class="time" style="width: 18.536585365854%"></div>
<pre>
      revert ob; apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 734
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros b; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 735
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 736
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor, compose; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 737
Time: 0.011s">
<div class="time" style="width: 5.3658536585366%"></div>
<pre>
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 738
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 739
Time: 0.015s">
<div class="time" style="width: 7.3170731707317%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 740
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      
    (** The diagrams for strength, see http://en.wikipedia.org/wiki/Strong_monad *)
   </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 743
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>Definition O_monad_strength_unitlaw1 (A : Type)
    : O_functor (@snd Unit A) o O_monad_strength Unit A == @snd Unit (O A).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 744
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 745
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      intros [[] oa]; revert oa.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 746
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      apply O_indpaths; intros x; unfold O_monad_strength, O_functor, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 747
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 747
Time: 0.005s">
<div class="time" style="width: 2.4390243902439%"></div>
<pre> 
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 748
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 749
Time: 0.007s">
<div class="time" style="width: 3.4146341463415%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 750
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre>

    Definition O_monad_strength_unitlaw2 (A B : Type)
    : O_monad_strength A B o functor_prod idmap (to O B) == to O (A*B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 753
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 754
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      intros [a b].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 755
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, functor_prod, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 756
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 756
Time: 0.002s">
<div class="time" style="width: 0.97560975609756%"></div>
<pre> 
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 757
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 758
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 759
Time: 0.01s">
<div class="time" style="width: 4.8780487804878%"></div>
<pre>

    Definition O_monad_strength_assoc1 (A B C : Type)
    : O_functor (equiv_prod_assoc A B C)^-1 o O_monad_strength (A*B) C ==
      O_monad_strength A (B*C) o functor_prod idmap (O_monad_strength B C) o (equiv_prod_assoc A B (O C))^-1.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 763
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 764
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>
      intros [[a b] oc].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 765
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      revert a; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 766
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert b; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 766
Time: 0.205s">
<div class="time" style="width: 100%"></div>
<pre>
      revert oc; apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 767
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros c; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply path_arrow; intros b.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 769
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 769
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor, functor_prod, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 770
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 770
Time: 0.014s">
<div class="time" style="width: 6.8292682926829%"></div>
<pre> 
      repeat rewrite O_rec_beta.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 771
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 772
Time: 0.03s">
<div class="time" style="width: 14.634146341463%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 773
Time: 0.004s">
<div class="time" style="width: 1.9512195121951%"></div>
<pre>

    Definition O_monad_strength_assoc2 (A B : Type)
    : O_monad_mult (A*B) o O_functor (O_monad_strength A B) o O_monad_strength A (O B) ==
      O_monad_strength A B o functor_prod idmap (O_monad_mult B).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 777
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 778
Time: 0.001s">
<div class="time" style="width: 0.48780487804878%"></div>
<pre>
      intros [a oob].</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 779
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> revert a; apply ap10.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 779
Time: 0.039s">
<div class="time" style="width: 19.024390243902%"></div>
<pre>
      revert oob; apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 780
Time: 0.034s">
<div class="time" style="width: 16.585365853659%"></div>
<pre> apply O_indpaths.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros b; simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 781
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply path_arrow; intros a.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 781
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold O_monad_strength, O_functor, O_monad_mult, functor_prod, compose.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 782
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> simpl.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 782
Time: 0.021s">
<div class="time" style="width: 10.243902439024%"></div>
<pre> 
      repeat (rewrite O_rec_beta; simpl).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 783
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      reflexivity.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 784
Time: 0.034s">
<div class="time" style="width: 16.585365853659%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 785
Time: 0.003s">
<div class="time" style="width: 1.4634146341463%"></div>
<pre>
      
  End StrongMonad.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 787
Time: 0.069s">
<div class="time" style="width: 33.658536585366%"></div>
<pre>
      
End Reflective_Subuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 789
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Make the [O_inverts] notation global. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 791
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Notation O_inverts O f := (IsEquiv (O_functor O f)).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 791
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End ReflectiveSubuniverses_Theory.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 793
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Restriction of a family of reflective subuniverses *)

(** Recall that an implementation of [ReflectiveSubuniverses] is a family of reflective subuniverses indexed by the type [ReflectiveSubuniverse].  Sometimes we want to consider only a subfamily of a known one, or more generally a restriction of such a family along a function.  The second-class nature of modules makes this a bit of a pain to construct, but we can do it. *)</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 797
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Type ReflectiveSubuniverses_Restriction_Data (Os : ReflectiveSubuniverses).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 797
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Parameter New_ReflectiveSubuniverse : Type2@{u a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 799
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check New_ReflectiveSubuniverse@{u a}.    (** Verify that we have the right number of universes *)

 </pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 802
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Parameter ReflectiveSubuniverses_restriction
  : New_ReflectiveSubuniverse@{u a} -&gt; Os.ReflectiveSubuniverse@{u a}.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 803
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Check ReflectiveSubuniverses_restriction@{u a}.

</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 805
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>End ReflectiveSubuniverses_Restriction_Data.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 805
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Module ReflectiveSubuniverses_Restriction
       (Os : ReflectiveSubuniverses)
       (Res : ReflectiveSubuniverses_Restriction_Data Os)
&lt;: ReflectiveSubuniverses.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 810
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition ReflectiveSubuniverse := Res.New_ReflectiveSubuniverse.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 812
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition O_reflector (O : ReflectiveSubuniverse@{u a})
    := Os.O_reflector@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 815
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_internal (O : ReflectiveSubuniverse@{u a})
    := Os.inO_internal@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 817
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition O_inO_internal (O : ReflectiveSubuniverse@{u a})
    := Os.O_inO_internal@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 819
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition to (O : ReflectiveSubuniverse@{u a})
    := Os.to@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 821
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition inO_equiv_inO_internal (O : ReflectiveSubuniverse@{u a})
    := Os.inO_equiv_inO_internal@{u a i} (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 823
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition hprop_inO_internal (H : Funext) (O : ReflectiveSubuniverse@{u a})
    := Os.hprop_inO_internal@{u a i} H (Res.ReflectiveSubuniverses_restriction O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 825
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition extendable_to_O_internal (O : ReflectiveSubuniverse@{u a})
    := @Os.extendable_to_O_internal@{u a i j k} (Res.ReflectiveSubuniverses_restriction@{u a} O).</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 827
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End ReflectiveSubuniverses_Restriction.</pre>
</div>
<div class="code" title="File: ReflectiveSubuniverse.v
Line: 830
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Union of families of reflective subuniverses *)

(** TODO *)

(** For examples of reflective subuniverses, see the examples of modalities listed in the file [Modality], and also [Localization]. *)

</pre>
</div>
</body>
</html>


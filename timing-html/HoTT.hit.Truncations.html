<html>
<head>
<title>Truncations.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Truncations.v</h1>

<div class="code" title="File: Truncations.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)

(** * Truncations of types, in all dimensions. *)

</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 4
Time: 0.033s">
<div class="time" style="width: 100%"></div>
<pre>Require Import Overture PathGroupoids Equivalences Trunc types.Sigma.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope equiv_scope.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Generalizable Variables A X n.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Definition. *)

(** The definition of [Trunc n], the n-truncation of a type.

If Coq supported higher inductive types natively, we would construct this as somthing like:

   Inductive Truncation n (A : Type) : Type :=
   | truncation_incl : A -&gt; Truncation n A
   | istrunc_truncation : forall (f : Sphere (trunc_S n) -&gt; Truncation n A)
       (x : Sphere (trunc_S n)), f x = f North.

However, while we are faking our higher-inductives anyway, we can take some shortcuts, rather than translating the definition above.  Firstly, we directly posit a “constructor” giving truncatedness, rather than rephrasing it in terms of maps of spheres.  Secondly, we omit the “computation rule” for this constructor, since it is implied by truncatedness of the result type (and, for essentially that reason, is never wanted in practice anyway).
*)

</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 22
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export Truncation.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 22
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Local Inductive Truncation (n : trunc_index) (A :Type) : Type :=
  truncation_incl : A -&gt; Truncation n A.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 25
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments truncation_incl {n A} a.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 26
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Axiom istrunc_truncation : forall n A, IsTrunc n (Truncation n A).</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Global Existing Instance istrunc_truncation.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 28
Time: 0.003s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>

Definition Truncation_rect {n A}
  (P : Truncation n A -&gt; Type) `{forall aa, IsTrunc n (P aa)}
  : (forall a, P (truncation_incl a)) -&gt; (forall aa, P aa)
:= (fun f aa =&gt; match aa with truncation_incl a =&gt; f a end).</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

End Truncation.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 35
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The non-dependent version of the eliminator. *)

</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 38
Time: 0.003s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>Definition Truncation_rect_nondep {n A X} `{IsTrunc n X}
  : (A -&gt; X) -&gt; (Truncation n A -&gt; X)
:= Truncation_rect (fun _ =&gt; X).</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Functoriality *)</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 42
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition functor_Truncation {n : trunc_index} {X Y} (f : X -&gt; Y)
  : Truncation n X -&gt; Truncation n Y.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 44
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  apply Truncation_rect_nondep.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (fun x =&gt; truncation_incl (f x)).</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 46
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Definition functor_Truncation_idmap `{Funext} {n : trunc_index} (X : Type)
  : @functor_Truncation n X X idmap == idmap.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 49
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  unfold pointwise_paths.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 51
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> apply @Truncation_rect.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 51
Time: 0.004s">
<div class="time" style="width: 12.121212121212%"></div>
<pre>
    intros ?; apply trunc_succ.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 52
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  intros a; exact 1.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 53
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 54
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>

Definition isequiv_functor_Truncation {n : trunc_index} {X Y} (f : X -&gt; Y)
  `{IsEquiv _ _ f} : IsEquiv (functor_Truncation (n:=n) f).</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 57
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 58
Time: 0.022s">
<div class="time" style="width: 66.666666666667%"></div>
<pre>
  refine (isequiv_adjointify _ (functor_Truncation (f ^-1)) _ _);
    unfold Sect; apply @Truncation_rect;
    try (intros ?; apply trunc_succ).</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 61
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros y; simpl.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 62
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre> apply ap, eisretr.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros x; simpl.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 63
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre> apply ap, eissect.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 63
Time: 0.006s">
<div class="time" style="width: 18.181818181818%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Truncations.v
Line: 65
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


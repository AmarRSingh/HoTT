<html>
<head>
<title>minus1Trunc.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for minus1Trunc.v</h1>

<div class="code" title="File: minus1Trunc.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * (-1)-truncation *)

</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 2
Time: 0.033s">
<div class="time" style="width: 100%"></div>
<pre>Require Import Overture HProp HSet Fibrations EquivalenceVarieties Contractible Equivalences types.Unit types.Sigma.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Open Local Scope path_scope.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 3
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Open Local Scope equiv_scope.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** The definition of [minus1Trunc], the (-1)-truncation.  Here is what
   it would look like if Coq supported higher inductive types natively:

&lt;&lt;
   Inductive minus1Trunc (A : Type) : Type :=
   | min1 : A -&gt; minus1Trunc A
   | min1_path : forall (x y: minus1Trunc A), x = y
&gt;&gt;
*)

</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export minus1Trunc.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 14
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Delimit Scope prop_trunc_scope with prop_trunc.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 15
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Private Inductive minus1Trunc (A :Type) : Type :=
  min1 : A -&gt; minus1Trunc A.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Bind Scope prop_trunc_scope with minus1Trunc.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Axiom min1_path : forall {A : Type} (x y : minus1Trunc A),  x = y.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 20
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Arguments min1 {A} a.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 21
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Definition minus1Trunc_rect :
  forall {A : Type} {P : minus1Trunc A -&gt; Type}
    (dmin1 : forall a : A, P (min1 a))
    (dpath : forall {x y : minus1Trunc A} (z : P x) (w : P y), transport _ (min1_path x y) z = w)
    (x : minus1Trunc A), P x.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 27
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
intros ???? [x].</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply dmin1.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 28
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 29
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>

Definition minus1Trunc_compute_min1 : forall {A : Type} {P : minus1Trunc A -&gt; Type}
  (dmin1 : forall (a : A), P (min1 a))
  (dpath : forall (x y : minus1Trunc A) (z : P x) (w : P y), transport _ (min1_path x y) z = w),
  forall (a : A), minus1Trunc_rect dmin1 dpath (min1 a) = dmin1 a.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
reflexivity.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 35
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 36
Time: 0.005s">
<div class="time" style="width: 15.151515151515%"></div>
<pre>

Axiom minus1Trunc_compute_path : forall {A : Type} {P : minus1Trunc A -&gt; Type}
  (dmin1 : forall (a : A), P (min1 a))
  (dpath : forall (x y : minus1Trunc A) (z : P x) (w : P y), transport _ (min1_path x y) z = w),
  forall (x y : minus1Trunc A),
    apD (minus1Trunc_rect dmin1 dpath) (min1_path x y)
    = dpath x y (minus1Trunc_rect dmin1 dpath x) (minus1Trunc_rect dmin1 dpath y).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 43
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End minus1Trunc.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 44
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** By adding the following [Hint Resolve] we can simply use the [auto] tactic
   to resolve any path involving [is_inhab]. *)

</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Hint Resolve @min1_path @minus1Trunc_compute_min1 @minus1Trunc_compute_path.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 48
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The non-dependent version of the eliminator. *)

</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition minus1Trunc_rect_nondep {A B : Type} :
  (A -&gt; B) -&gt; (forall (z w : B), z = w) -&gt; (minus1Trunc A -&gt; B).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros dmin1' dpath'.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 54
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  by apply minus1Trunc_rect.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 56
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition minus1Trunc_compute_min1_nondep {A B : Type}
  (dmin1' : A -&gt; B) (dpath' : forall (z w : B), z = w) (a : A) :
  minus1Trunc_rect_nondep dmin1' dpath' (min1 a) = (dmin1' a).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 60
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 61
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  apply @minus1Trunc_compute_min1 with (P := fun a =&gt; B).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 62
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 63
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>

Definition minus1Trunc_compute_path_nondep {A B : Type}
  (dmin1' : A -&gt; B) (path' : forall (z w : B), z = w)
  (x y : minus1Trunc A) :
  ap (minus1Trunc_rect_nondep dmin1' path') (min1_path x y)
  = path' (minus1Trunc_rect_nondep dmin1' path' x) (minus1Trunc_rect_nondep dmin1' path' y).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
 apply (@path_contr ).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 71
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
 by apply hprop_allpath.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 72
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** ** [minus1Trunc A] is always a proposition. *)

</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance minus1Trunc_is_prop {A : Type} : IsHProp (minus1Trunc A) | 0.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply hprop_allpath, min1_path.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition minus1Trunc_ind {A B : Type} `{IsHProp B} :
  (A -&gt; B) -&gt; minus1Trunc A -&gt; B.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 81
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 82
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
intros ?.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply minus1Trunc_rect_nondep.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> assumption.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 83
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
apply allpath_hprop.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 84
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** And if [A] was already a proposition, then [minus1Trunc A] is equivalent to [A]. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Instance IsEquivmin1 {A} `{IsHProp A} : IsEquiv (@min1 A) | 1000.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 88
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  apply (@isequiv_adjointify _ _ (@min1 A) (minus1Trunc_rect_nondep (fun x:A =&gt; x) allpath_hprop )).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
   intro x.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 90
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> apply hprop_allpath, min1_path.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro a.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply allpath_hprop.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 91
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 92
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Weaker form: if [A] is a proposition, you can remove the truncation *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma untrunc_hprop {A : Type} : (IsHProp A) -&gt; (minus1Trunc A) -&gt; A.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 94
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 96
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply minus1Trunc_ind.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact idmap.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 97
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section AssumeFunext.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 100
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
(** ** Inhabited propositions are contractible. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Open Scope fibration_scope.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 101
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Context `{Funext}.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma inhab_prop_contr {A} : (IsHProp A) -&gt; minus1Trunc A -&gt; Contr A.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 104
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 105
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros prp.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply minus1Trunc_rect_nondep.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 107
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    by apply contr_inhabited_hprop.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 108
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 109
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> eapply allpath_hprop.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 109
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 110
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** "Epi" and "mono" implies equivalence. *)

</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 113
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition is_epi {X Y : Type} (f : X -&gt; Y) :=
  forall y:Y, minus1Trunc (hfiber f y).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition is_mono {X Y : Type} (f : X -&gt; Y) :=
  forall y:Y, IsHProp (hfiber f y).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma epi_mono_equiv {X Y : Type} (f : X -&gt; Y) :
  is_epi f -&gt; is_mono f -&gt; IsEquiv f.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 120
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros epi mono.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 122
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  apply contr_inhabited_hprop.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
   apply hprop_isequiv.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 124
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply  isequiv_fcontr.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intro b.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply (inhab_prop_contr (mono b) (epi b)).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 127
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
End AssumeFunext.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** Monos are injective *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma is_mono_isinj {A B : Type} (m : A -&gt; B) : is_mono m -&gt; isinj m.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros H a a' p.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  specialize (H (m a')).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> unfold hfiber in *.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 133
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
  assert ((a; p) = (a'; 1) :&gt; {x : A &amp; m x = m a'}) by apply allpath_hprop.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 134
Time: 0.024s">
<div class="time" style="width: 72.727272727273%"></div>
<pre>
  apply (path_sigma_uncurried (fun x =&gt; m x = m a') (a; p) (a'; 1))^-1.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  assumption.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 136
Time: 0.012s">
<div class="time" style="width: 36.363636363636%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 137
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section minus1TruncMonad.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 139
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** The monadic structure of [minus1Trunc].

    This is pretty easy to check since any diagram involving propositions commutes. *)

(** We first need the action of [minus1Trunc] on morphisms. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 145
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition minus1Trunc_map_dep {A B}
: (forall x : A, B (min1 x)) -&gt; (forall x : minus1Trunc A, minus1Trunc (B x)).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 146
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros f.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 148
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
  apply (@minus1Trunc_rect A (fun x =&gt; minus1Trunc (B x))
                           (fun x =&gt; min1 (f x))); auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 150
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 151
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition minus1Trunc_map {A B : Type} : (A -&gt; B) -&gt; (minus1Trunc A -&gt; minus1Trunc B)
  := @minus1Trunc_map_dep A (fun _ =&gt; B).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 154
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** Functoriality of [minus1Trunc_map]. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 156
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma minus1Trunc_map_id {A : Type} :
  forall (p : minus1Trunc A), minus1Trunc_map (fun x =&gt; x) p = p.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 158
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 160
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Lemma minus1Trunc_map_compose {A B C : Type} (f : A -&gt; B) (g : B -&gt; C):
  forall (p : minus1Trunc A), minus1Trunc_map (compose g f) p = minus1Trunc_map g (minus1Trunc_map f p).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 164
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 165
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** The unit. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition eta := @min1.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 168
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** Naturality of unit. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 170
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma eta_natural {A B : Type} (f : A -&gt; B) :
  forall a : A, eta B (f a) = minus1Trunc_map f (eta A a).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 171
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 173
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 174
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** The multiplication. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition mu (A : Type) : minus1Trunc (minus1Trunc A) -&gt; minus1Trunc A.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 176
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 177
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros p.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 178
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> apply @minus1Trunc_rect_nondep with (A := minus1Trunc A); auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 178
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 179
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** Naturality of multiplication. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 181
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>Lemma mu_natural {A B : Type} (f : A -&gt; B) :
  forall p : minus1Trunc (minus1Trunc A),
    mu B (minus1Trunc_map (minus1Trunc_map f) p) = minus1Trunc_map f (mu A p).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 183
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 185
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 186
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** Unit laws. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 188
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma eta_1 (A : Type) :
  forall p : minus1Trunc A, mu A (eta (minus1Trunc A) p) = p.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 191
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma eta_2 (A : Type) :
  forall p : minus1Trunc A, mu A (minus1Trunc_map (eta A) p) = p.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 197
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 198
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Lemma mu_1 (A : Type) :
  forall p : minus1Trunc (minus1Trunc (minus1Trunc A)),
    mu A (minus1Trunc_map (mu A) p) = mu A (mu (minus1Trunc A) p).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 202
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 203
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 204
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 205
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** The strength. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma t (A B : Type) : A * minus1Trunc B -&gt; minus1Trunc (A * B).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 207
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 208
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intros [a q].</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 209
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  apply (minus1Trunc_rect_nondep (A := B)); auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 210
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  intro b.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply min1; auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 211
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 212
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** Naturality of strength. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 214
Time: 0.003s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>Lemma t_natural (A A' B B' : Type) (f : A -&gt; A') (g : B -&gt; B') :
  forall (a : A) (q : minus1Trunc B),
    minus1Trunc_map (fun xy =&gt; (f (fst xy), g (snd xy))) (t A B (a,q)) = t A' B' (f a, minus1Trunc_map g q).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 216
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 218
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 219
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(* The diagrams for strength, see http://en.wikipedia.org/wiki/Strong_monad *)

</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 222
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>Lemma strength_unit (A : Type) :
  forall p : Unit * minus1Trunc A,
    minus1Trunc_map (@snd Unit A) (t Unit A p) = snd p.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 226
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 227
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Lemma strength_eta (A B : Type) :
  forall (a : A) (b : B),
    t A B (a, eta B b) = eta (A * B) (a,b).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 232
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 233
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 234
Time: 0.003s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>

Definition alpha A B C (u : (A * B) * C) := (fst (fst u), (snd (fst u), snd u)).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 236
Time: 0.003s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>

Lemma strength_pentagon_1 (A B C : Type) :
  forall (a : A) (b : B) (r : minus1Trunc C),
    minus1Trunc_map (alpha A B C) (t (A * B) C ((a,b),r)) =
    t A (B * C) (a, t B C (b, r)).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 242
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 243
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 244
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>

Lemma strength_pentagon_2 (A B : Type) :
  forall (a : A) (p : minus1Trunc (minus1Trunc B)),
    mu (A * B) (minus1Trunc_map (t A B) (t A (minus1Trunc B) (a, p))) = t A B (a, mu B p).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 248
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  auto.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 250
Time: 0.002s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 251
Time: 0.01s">
<div class="time" style="width: 30.30303030303%"></div>
<pre>

End minus1TruncMonad.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We may want to define the other connectives to at some point. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 255
Time: 0.001s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>Definition hexists {X} (P:X-&gt;Type):Type:= minus1Trunc (sigT  P).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Definition hor (P:Type) (Q:Type):Type:= minus1Trunc (P + Q).</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 256
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** If the goal is an hProp, we may remove [minus1Trunc] in hypotheses. *)</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Ltac strip_truncations :=
  (** get the type of the goal *)
  let G := match goal with |- ?G =&gt; constr:(G) end in
  (** prove that the goal is an hProp *)
  let H := fresh in
  assert (H : forall z w : G, z = w) by apply allpath_hprop;
    (** search for truncated hypotheses *)
    progress repeat match goal with
                      | [ T : _ |- _ ]
                        =&gt; revert T;
                          refine (@minus1Trunc_rect_nondep _ _ _ H);
                          intro T
                    end;
    (** clear the IsHProp hypothesis *)
    clear H.</pre>
</div>
<div class="code" title="File: minus1Trunc.v
Line: 273
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


<html>
<head>
<title>Core.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Core.v</h1>

<div class="code" title="File: Core.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(* -*- mode: coq; mode: visual-line -*- *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 1
Time: 0.044s">
<div class="time" style="width: 4.2677012609117%"></div>
<pre>Require Import HoTT.Basics HoTT.Types.</pre>
</div>
<div class="code" title="File: Core.v
Line: 1
Time: 0.006s">
<div class="time" style="width: 0.5819592628516%"></div>
<pre>
Require Import UnivalenceImpliesFunext TruncType HSet.</pre>
</div>
<div class="code" title="File: Core.v
Line: 2
Time: 0.176s">
<div class="time" style="width: 17.070805043647%"></div>
<pre>
Require Import HIT.Truncations.</pre>
</div>
<div class="code" title="File: Core.v
Line: 3
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
Import TrM.</pre>
</div>
<div class="code" title="File: Core.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope nat_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope path_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** * The surreal numbers *)

(** Based on section 11.6 of the HoTT Book. *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Delimit Scope surreal_scope with No.</pre>
</div>
<div class="code" title="File: Core.v
Line: 12
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope surreal_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 13
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** The surreal numbers use a lot of universes.  We include some universe annotations here and there to reduce the number of overall universe parameters from an unmanageable number to a slightly less unmanageable number.  This improves performance significantly.  We also use [abstract] and [Qed] whenever possible, for the same reason. *)

(** ** Definition *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Module Export Surreals.</pre>
</div>
<div class="code" title="File: Core.v
Line: 18
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Games first *)

  (** Since Coq doesn't support inductive-inductive types natively, we have to hack a bit.  Inspired by Conway, we define [Game]s to be constructed by the point-constructor of [No] but without the hypothesis on inequality of options.  Then we define the inequalities as a mutual inductive family over [Game], and put an inductive predicate on [Game] characterizing those that are Numbers.  (This is roughly a standard technique described by Fredrik Nordvall Forsberg for reducing induction-induction to parametrized induction.)  We then proceed to add axioms for the path-constructors of [No].

  It should be emphasized that this is *not* currently a correct higher inductive-inductive definition of games; these "games" are only being used inside this module as a trick to produce [No] in a way that computes on the point-constructor.  It should be possible to make a higher inductive-inductive definition of games, but this is not it. *)

 </pre>
</div>
<div class="code" title="File: Core.v
Line: 26
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Private Inductive Game : Type :=
  | opt : forall (L R : Type@{i}) (xL : L -&gt; Game) (xR : R -&gt; Game), Game.</pre>
</div>
<div class="code" title="File: Core.v
Line: 27
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Arguments opt {L R} xL xR.</pre>
</div>
<div class="code" title="File: Core.v
Line: 29
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

  Private Inductive game_le : Game@{i} -&gt; Game@{i} -&gt; Type :=
  | game_le_lr
    : forall (L R : Type@{i}) (xL : L -&gt; Game@{i}) (xR : R -&gt; Game@{i})
             (L' R' : Type@{i}) (yL : L' -&gt; Game@{i}) (yR : R' -&gt; Game@{i}),
        (forall (l:L), game_lt (xL l) (opt yL yR)) -&gt;
        (forall (r:R'), game_lt (opt xL xR) (yR r)) -&gt;
        game_le (opt xL xR) (opt yL yR)

  with game_lt : Game@{i} -&gt; Game@{i} -&gt; Type :=
  | game_lt_l
    : forall (L R : Type@{i}) (xL : L -&gt; Game@{i}) (xR : R -&gt; Game@{i})
             (L' R' : Type@{i}) (yL : L' -&gt; Game@{i}) (yR : R' -&gt; Game@{i})
             (l : L'),
        (game_le (opt xL xR) (yL l)) -&gt;
        game_lt (opt xL xR) (opt yL yR)
  | game_lt_r
    : forall (L R : Type@{i}) (xL : L -&gt; Game@{i}) (xR : R -&gt; Game@{i})
             (L' R' : Type@{i}) (yL : L' -&gt; Game@{i}) (yR : R' -&gt; Game@{i})
             (r : R),
        (game_le (xR r) (opt yL yR)) -&gt;
        game_lt (opt xL xR) (opt yL yR).</pre>
</div>
<div class="code" title="File: Core.v
Line: 51
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Arguments game_le_lr {L R} xL xR {L' R'} yL yR _ _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Arguments game_lt_l {L R} xL xR {L' R'} yL yR l _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 54
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Arguments game_lt_r {L R} xL xR {L' R'} yL yR r _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 55
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Now the surreals *)

 </pre>
</div>
<div class="code" title="File: Core.v
Line: 59
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>Private Inductive is_surreal : Game@{i} -&gt; Type :=
  | isno : forall (L R : Type@{i}) (xL : L -&gt; Game@{i}) (xR : R -&gt; Game@{i}),
             (forall l, is_surreal (xL l))
             -&gt; (forall r, is_surreal (xR r))
             -&gt; (forall (l:L) (r:R), game_lt (xL l) (xR r))
             -&gt; is_surreal (opt xL xR).</pre>
</div>
<div class="code" title="File: Core.v
Line: 64
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Unset Nonrecursive Elimination Schemes.</pre>
</div>
<div class="code" title="File: Core.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Record No : Type :=
    { game_of : Game
    ; isno_game_of : is_surreal (game_of) }.</pre>
</div>
<div class="code" title="File: Core.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Bind Scope surreal_scope with No.</pre>
</div>
<div class="code" title="File: Core.v
Line: 71
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition lt (x y : No) := game_lt (game_of x) (game_of y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition le (x y : No) := game_le (game_of x) (game_of y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 75
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Infix "&lt;" := lt : surreal_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Infix "&lt;=" := le : surreal_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 78
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

  Definition No_cut {L R : Type@{i}} (xL : L -&gt; No@{i}) (xR : R -&gt; No@{i})
             (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
  : No
    := Build_No (opt (game_of o xL) (game_of o xR))
                (isno _ _ _ _ (isno_game_of o xL)
                      (isno_game_of o xR) xcut).</pre>
</div>
<div class="code" title="File: Core.v
Line: 85
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Notation "{ { xL | xR // xcut } }" := (No_cut xL xR xcut) : surreal_scope.</pre>
</div>
<div class="code" title="File: Core.v
Line: 87
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Axiom path_No : forall (x y : No), (x &lt;= y) -&gt; (y &lt;= x) -&gt; (x = y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 89
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Arguments path_No {x y} _ _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 90
Time: 0.006s">
<div class="time" style="width: 0.5819592628516%"></div>
<pre>

  Definition le_lr
             {L R : Type@{i} } (xL : L -&gt; No) (xR : R -&gt; No)
             (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
             {L' R' : Type@{i} } (yL : L' -&gt; No) (yR : R' -&gt; No)
             (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
  : (forall (l:L), xL l &lt; {{ yL | yR // ycut }}) -&gt;
    (forall (r:R'), {{ xL | xR // xcut }} &lt; yR r) -&gt;
    {{ xL | xR // xcut }} &lt;= {{ yL | yR // ycut }}
    := game_le_lr (game_of o xL) (game_of o xR)
                  (game_of o yL) (game_of o yR).</pre>
</div>
<div class="code" title="File: Core.v
Line: 101
Time: 0.005s">
<div class="time" style="width: 0.48496605237633%"></div>
<pre>

  Definition lt_l
             {L R : Type@{i} } (xL : L -&gt; No) (xR : R -&gt; No)
             (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
             {L' R' : Type@{i} } (yL : L' -&gt; No) (yR : R' -&gt; No)
             (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
             (l : L')
  : ({{ xL | xR // xcut }} &lt;= yL l) -&gt;
    {{ xL | xR // xcut }} &lt; {{ yL | yR // ycut }}
    := game_lt_l (game_of o xL) (game_of o xR)
                 (game_of o yL) (game_of o yR) l.</pre>
</div>
<div class="code" title="File: Core.v
Line: 112
Time: 0.005s">
<div class="time" style="width: 0.48496605237633%"></div>
<pre>

  Definition lt_r
             {L R : Type@{i} } (xL : L -&gt; No) (xR : R -&gt; No)
             (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
             {L' R' : Type@{i} } (yL : L' -&gt; No) (yR : R' -&gt; No)
             (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
             (r : R)
  : (xR r &lt;= {{ yL | yR // ycut }}) -&gt;
    {{ xL | xR // xcut }} &lt; {{ yL | yR // ycut }}
    := game_lt_r (game_of o xL) (game_of o xR)
                 (game_of o yL) (game_of o yR) r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance ishprop_No_le {x y : No}
  : IsHProp (x &lt;= y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Admitted.</pre>
</div>
<div class="code" title="File: Core.v
Line: 127
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Global Instance ishprop_No_lt {x y : No}
  : IsHProp (x &lt; y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 130
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Admitted.</pre>
</div>
<div class="code" title="File: Core.v
Line: 131
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Now the induction principle. *)

 </pre>
</div>
<div class="code" title="File: Core.v
Line: 135
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section NoInd.</pre>
</div>
<div class="code" title="File: Core.v
Line: 135
Time: 0.02s">
<div class="time" style="width: 1.9398642095053%"></div>
<pre>

    Context
      (A : No@{i} -&gt; Type)
      (dle : forall (x y:No@{i}), (x &lt;= y) -&gt; A x -&gt; A y -&gt; Type)
      (dlt : forall (x y:No@{i}), (x &lt; y) -&gt; A x -&gt; A y -&gt; Type)
      {ishprop_le : forall x y a b p, IsHProp (dle x y p a b)}
      {ishprop_lt : forall x y a b p, IsHProp (dlt x y p a b)}
      (dcut : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                     (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                     (fxL : forall l, A (xL l)) (fxR : forall r, A (xR r))
                     (fxcut : forall l r, dlt _ _ (xcut l r) (fxL l) (fxR r)),
                A {{ xL | xR // xcut }})
      (dpath : forall (x y:No) (a:A x) (b:A y) (p : x &lt;= y) (q : y &lt;= x)
                      (dp : dle x y p a b) (dq : dle y x q b a),
                 path_No p q # a = b)
      (dle_lr : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                       (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                       (fxL : forall l, A (xL l)) (fxR : forall r, A (xR r))
                       (fxcut : forall l r, dlt _ _ (xcut l r) (fxL l) (fxR r))
                       (L' R' : Type@{i}) (yL : L' -&gt; No) (yR : R' -&gt; No)
                       (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
                       (fyL : forall l, A (yL l)) (fyR : forall r, A (yR r))
                       (fycut : forall l r, dlt _ _ (ycut l r) (fyL l) (fyR r))
                       (p : forall (l:L), xL l &lt; {{ yL | yR // ycut }})
                       (dp : forall (l:L),
                               dlt _ _ (p l)
                                   (fxL l)
                                   (dcut _ _ yL yR ycut fyL fyR fycut))
                       (q : forall (r:R'), {{ xL | xR // xcut }} &lt; yR r)
                       (dq : forall (r:R'),
                               dlt _ _ (q r)
                                   (dcut _ _ xL xR xcut fxL fxR fxcut)
                                   (fyR r)),
                  dle {{ xL | xR // xcut }} {{ yL | yR // ycut }}
                      (le_lr xL xR xcut yL yR ycut p q)
                      (dcut _ _ xL xR xcut fxL fxR fxcut)
                      (dcut _ _ yL yR ycut fyL fyR fycut))
      (dlt_l : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                      (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                      (fxL : forall l, A (xL l)) (fxR : forall r, A (xR r))
                      (fxcut : forall l r, dlt _ _ (xcut l r) (fxL l) (fxR r))
                      (L' R' : Type@{i}) (yL : L' -&gt; No) (yR : R' -&gt; No)
                      (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
                      (fyL : forall l, A (yL l)) (fyR : forall r, A (yR r))
                      (fycut : forall l r, dlt _ _ (ycut l r) (fyL l) (fyR r))
                      (l : L')
                      (p : {{ xL | xR // xcut }} &lt;= yL l)
                      (dp : dle _ _ p
                                (dcut _ _ xL xR xcut fxL fxR fxcut)
                                (fyL l)),
                 dlt {{ xL | xR // xcut }} {{ yL | yR // ycut }}
                     (lt_l xL xR xcut yL yR ycut l p)
                     (dcut _ _ xL xR xcut fxL fxR fxcut)
                     (dcut _ _ yL yR ycut fyL fyR fycut))
      (dlt_r : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                      (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                      (fxL : forall l, A (xL l)) (fxR : forall r, A (xR r))
                      (fxcut : forall l r, dlt _ _ (xcut l r) (fxL l) (fxR r))
                      (L' R' : Type@{i}) (yL : L' -&gt; No) (yR : R' -&gt; No)
                      (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
                      (fyL : forall l, A (yL l)) (fyR : forall r, A (yR r))
                      (fycut : forall l r, dlt _ _ (ycut l r) (fyL l) (fyR r))
                      (r : R)
                      (p : (xR r) &lt;= {{ yL | yR // ycut }})
                      (dp : dle _ _ p
                                (fxR r)
                                (dcut _ _ yL yR ycut fyL fyR fycut)),
                 dlt {{ xL | xR // xcut }} {{ yL | yR // ycut }}
                     (lt_r xL xR xcut yL yR ycut r p)
                     (dcut _ _ xL xR xcut fxL fxR fxcut)
                     (dcut _ _ yL yR ycut fyL fyR fycut)).</pre>
</div>
<div class="code" title="File: Core.v
Line: 206
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** As usual for HITs implemented with [Private Inductive], we will define [No_ind] inside this module using a fixpoint over [No], thereby obtaining a judgmental computation rule for the point-constructor [No_cut], and then assert the other computation rules as axioms.  In this case, the relevant other rules are the preservation of inequalities.

However, it turns out that in defining [No_cut] we already need to know that it preserves inequalities.  Since this is eventually an axiom anyway, we could just assert it with [admit] in the proof.  However, if we did this then the [admit] would not be *judgmentally* equal to the axiom [No_ind_lt] that we assert afterwards.  Instead, we make use of the fact that [admit] is essentially by definition [match proof_admitted with end] for a global axiom [proof_admitted : Empty], so that if we use the same [admit] both inside the definition of [No_ind] and in asserting [No_ind_lt] as an axiom, they will be the same term judgmentally.

Finally, for conceptual isolation, and so as not to depend on the particular implementation of [admit], we introduce here local copies of [Empty] and [proof_admitted]. *)
   </pre>
</div>
<div class="code" title="File: Core.v
Line: 213
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>Local Inductive No_Empty_for_admitted := .</pre>
</div>
<div class="code" title="File: Core.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Axiom No_Empty_admitted : No_Empty_for_admitted.</pre>
</div>
<div class="code" title="File: Core.v
Line: 214
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Technically, we induct over the inductive predicate witnessing Numberhood of games.  We prove the "induction step" separately to improve performance, possibly by preventing bare [fix]s from appearing upon simplification. *)
   </pre>
</div>
<div class="code" title="File: Core.v
Line: 217
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Local Definition No_ind_internal_step
          (No_ind_internal : forall (x : Game) (xno : is_surreal x),
                               A (Build_No x xno))
          (x : Game) (xno : is_surreal x)
    : A (Build_No x xno).</pre>
</div>
<div class="code" title="File: Core.v
Line: 221
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 222
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      revert ishprop_le ishprop_lt dpath dle_lr dlt_l dlt_r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 223
Time: 0.005s">
<div class="time" style="width: 0.48496605237633%"></div>
<pre>
      destruct xno as [L R xL xR Lno Rno xcut].</pre>
</div>
<div class="code" title="File: Core.v
Line: 224
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      intros ishprop_le ishprop_lt dpath dle_lr dlt_l dlt_r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 225
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      simple refine (dcut L R (fun l =&gt; Build_No (xL l) (Lno l))
                   (fun r =&gt; Build_No (xR r) (Rno r)) xcut _ _ _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 227
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros l; exact (No_ind_internal (xL l) (Lno l)).</pre>
</div>
<div class="code" title="File: Core.v
Line: 228
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r; exact (No_ind_internal (xR r) (Rno r)).</pre>
</div>
<div class="code" title="File: Core.v
Line: 229
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 230
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros; exact (match No_Empty_admitted with end).</pre>
</div>
<div class="code" title="File: Core.v
Line: 230
Time: 0.006s">
<div class="time" style="width: 0.5819592628516%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 231
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Local Fixpoint No_ind_internal (x : Game) (xno : is_surreal x)
          {struct xno}
    : A (Build_No x xno).</pre>
</div>
<div class="code" title="File: Core.v
Line: 235
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 236
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
      destruct xno.</pre>
</div>
<div class="code" title="File: Core.v
Line: 237
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (No_ind_internal_step No_ind_internal _ _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 238
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 239
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition No_ind (x : No) : A x.</pre>
</div>
<div class="code" title="File: Core.v
Line: 241
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 242
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      destruct x as [x xno].</pre>
</div>
<div class="code" title="File: Core.v
Line: 243
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      exact (No_ind_internal x xno).</pre>
</div>
<div class="code" title="File: Core.v
Line: 244
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 245
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition No_ind_le (x y : No) (p : x &lt;= y)
    : dle x y p (No_ind x) (No_ind y)
      := match No_Empty_admitted with end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 249
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Definition No_ind_lt (x y : No) (p : x &lt; y)
    : dlt x y p (No_ind x) (No_ind y)
      := match No_Empty_admitted with end.</pre>
</div>
<div class="code" title="File: Core.v
Line: 253
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** Sometimes it's convenient to have all three parts of [No_ind] in one package, so that we only have to verify the hypotheses once. *)
   </pre>
</div>
<div class="code" title="File: Core.v
Line: 256
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>Definition No_ind_package
    : { f : forall x, A x &amp;
      (forall (x y : No) (p : x &lt;= y), dle x y p (f x) (f y)) *
      (forall (x y : No) (p : x &lt; y), dlt x y p (f x) (f y)) }
      := ( No_ind ; (No_ind_le , No_ind_lt) ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 260
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** It's also sometimes convenient to have just the inequality parts together. *)
   </pre>
</div>
<div class="code" title="File: Core.v
Line: 263
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>Definition No_ind_le_lt (x y : No)
    : (forall (p : x &lt;= y), dle x y p (No_ind x) (No_ind y)) *
      (forall (p : x &lt; y), dlt x y p (No_ind x) (No_ind y))
      := (No_ind_le x y , No_ind_lt x y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 266
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** We verify that our definition computes judgmentally. *)
   </pre>
</div>
<div class="code" title="File: Core.v
Line: 269
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>Definition No_ind_cut `{Funext}
               (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
               (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
    : No_ind {{ xL | xR // xcut }}
      = dcut L R xL xR xcut
             (fun l =&gt; No_ind (xL l)) (fun r =&gt; No_ind (xR r))
             (fun l r =&gt; No_ind_lt (xL l) (xR r) (xcut l r))
      := 1.</pre>
</div>
<div class="code" title="File: Core.v
Line: 276
Time: 0.017s">
<div class="time" style="width: 1.6488845780795%"></div>
<pre>

  End NoInd.</pre>
</div>
<div class="code" title="File: Core.v
Line: 278
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>

End Surreals.</pre>
</div>
<div class="code" title="File: Core.v
Line: 280
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** A few surreal numbers *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 283
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>Definition zero : No
  := {{ Empty_rec | Empty_rec //
        Empty_ind (fun x =&gt; forall y, Empty_rec x &lt; Empty_rec y ) }}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Definition one : No
  := {{ (fun _:Unit =&gt; zero) | Empty_rec // fun x =&gt; Empty_ind _ }}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 288
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>

Definition minusone : No
  := {{ Empty_rec | (fun _:Unit =&gt; zero) // Empty_ind _ }}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 291
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** More induction principles *)

(** *** The simplified induction principle for hprops *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 296
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>Definition No_ind_hprop (P : No -&gt; Type) `{forall x, IsHProp (P x)}
           (dcut : forall (L R : Type) (xL : L -&gt; No) (xR : R -&gt; No)
                          (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                          (IHL : forall l, P (xL l))
                          (IHR : forall r, P (xR r)),
                     P {{ xL | xR // xcut }})
           (x : No)
: P x.</pre>
</div>
<div class="code" title="File: Core.v
Line: 303
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 304
Time: 0.117s">
<div class="time" style="width: 11.348205625606%"></div>
<pre>
  revert x;
  refine (No_ind P (fun _ _ _ _ _ =&gt; Unit) (fun _ _ _ _ _ =&gt; Unit)
                 _ _ _ _ _);
  intros; try apply path_ishprop; try exact tt.</pre>
</div>
<div class="code" title="File: Core.v
Line: 308
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply dcut; assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 309
Time: 0.008s">
<div class="time" style="width: 0.77594568380213%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 310
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** *** The non-dependent recursion principle *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section NoRec.</pre>
</div>
<div class="code" title="File: Core.v
Line: 313
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Funext}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 314
Time: 0.01s">
<div class="time" style="width: 0.96993210475267%"></div>
<pre>

  Context  (A : Type)
           (dle : A -&gt; A -&gt; Type) `{is_mere_relation A dle}
           (dlt : A -&gt; A -&gt; Type) `{is_mere_relation A dlt}
           (dcut : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                          (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                          (fxL : L -&gt; A) (fxR : R -&gt; A)
                          (fxcut : forall l r, dlt (fxL l) (fxR r)),
                     A)
           (dpath : forall a b, dle a b -&gt; dle b a -&gt; a = b)
           (dle_lr : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                            (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                            (fxL : L -&gt; A) (fxR : R -&gt; A)
                            (fxcut : forall l r, dlt (fxL l) (fxR r))
                            (L' R' : Type@{i}) (yL : L' -&gt; No) (yR : R' -&gt; No)
                            (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
                            (fyL : L' -&gt; A) (fyR : R' -&gt; A)
                            (fycut : forall l r, dlt (fyL l) (fyR r))
                            (p : forall (l:L), xL l &lt; {{ yL | yR // ycut }})
                            (dp : forall (l:L),
                                    dlt (fxL l) (dcut _ _ yL yR ycut fyL fyR fycut))
                            (q : forall (r:R'), {{ xL | xR // xcut }} &lt; yR r)
                            (dq : forall (r:R'),
                                    dlt (dcut _ _ xL xR xcut fxL fxR fxcut) (fyR r)),
                       dle (dcut _ _ xL xR xcut fxL fxR fxcut)
                           (dcut _ _ yL yR ycut fyL fyR fycut))
           (dlt_l : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                           (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                           (fxL : L -&gt; A) (fxR : R -&gt; A)
                           (fxcut : forall l r, dlt (fxL l) (fxR r))
                           (L' R' : Type@{i}) (yL : L' -&gt; No) (yR : R' -&gt; No)
                           (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
                           (fyL : L' -&gt; A) (fyR : R' -&gt; A)
                           (fycut : forall l r, dlt (fyL l) (fyR r))
                           (l : L') (p : {{ xL | xR // xcut }} &lt;= yL l)
                           (dp : dle (dcut _ _ xL xR xcut fxL fxR fxcut) (fyL l)),
                      dlt (dcut _ _ xL xR xcut fxL fxR fxcut)
                          (dcut _ _ yL yR ycut fyL fyR fycut))
           (dlt_r : forall (L R : Type@{i}) (xL : L -&gt; No) (xR : R -&gt; No)
                           (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
                           (fxL : L -&gt; A) (fxR : R -&gt; A)
                           (fxcut : forall l r, dlt (fxL l) (fxR r))
                           (L' R' : Type@{i}) (yL : L' -&gt; No) (yR : R' -&gt; No)
                           (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
                           (fyL : L' -&gt; A) (fyR : R' -&gt; A)
                           (fycut : forall l r, dlt (fyL l) (fyR r))
                           (r : R) (p : (xR r) &lt;= {{ yL | yR // ycut }})
                           (dp : dle (fxR r) (dcut _ _ yL yR ycut fyL fyR fycut)),
                      dlt (dcut _ _ xL xR xcut fxL fxR fxcut)
                          (dcut _ _ yL yR ycut fyL fyR fycut)).</pre>
</div>
<div class="code" title="File: Core.v
Line: 364
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition No_rec (x : No) : A.</pre>
</div>
<div class="code" title="File: Core.v
Line: 366
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 367
Time: 0.079s">
<div class="time" style="width: 7.6624636275461%"></div>
<pre>
    revert x;
    simple refine (No_ind (fun _ =&gt; A) (fun _ _ _ a b =&gt; dle a b)
                   (fun _ _ _ a b =&gt; dlt a b)
                   _ _ _ _ _);
    intros.</pre>
</div>
<div class="code" title="File: Core.v
Line: 372
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact (dcut L R xL xR xcut fxL fxR fxcut).</pre>
</div>
<div class="code" title="File: Core.v
Line: 373
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 374
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre> refine (transport_const _ _ @ _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 374
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply dpath; assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 375
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: Core.v
Line: 376
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre> apply dle_lr; assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: Core.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply dlt_l with l; assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 377
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> cbn.</pre>
</div>
<div class="code" title="File: Core.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply dlt_r with r; assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 378
Time: 0.007s">
<div class="time" style="width: 0.67895247332687%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 379
Time: 0.016s">
<div class="time" style="width: 1.5518913676043%"></div>
<pre>

  Definition No_rec_le (x y : No) (p : x &lt;= y)
  : dle (No_rec x) (No_rec y)
    := No_ind_le (fun _ =&gt; A) (fun _ _ _ a b =&gt; dle a b)
                 (fun _ _ _ a b =&gt; dlt a b) _ _ _ _ _ x y p.</pre>
</div>
<div class="code" title="File: Core.v
Line: 384
Time: 0.016s">
<div class="time" style="width: 1.5518913676043%"></div>
<pre>

  Definition No_rec_lt (x y : No) (p : x &lt; y)
  : dlt (No_rec x) (No_rec y)
    := No_ind_lt (fun _ =&gt; A) (fun _ _ _ a b =&gt; dle a b)
                 (fun _ _ _ a b =&gt; dlt a b) _ _ _ _ _ x y p.</pre>
</div>
<div class="code" title="File: Core.v
Line: 389
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

  Definition No_rec_package
  : { f : No -&gt; A &amp;
      (forall (x y : No) (p : x &lt;= y), dle (f x) (f y)) *
      (forall (x y : No) (p : x &lt; y), dlt (f x) (f y)) }
    := ( No_rec ; (No_rec_le , No_rec_lt) ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 395
Time: 0.013s">
<div class="time" style="width: 1.2609117361785%"></div>
<pre>

End NoRec.</pre>
</div>
<div class="code" title="File: Core.v
Line: 397
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Conway's Theorem 0 *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 400
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>Lemma Conway_theorem0_lemma1 `{Funext} (x : No@{i}) (xle : x &lt;= x)
      (L' R' : Type@{i}) (yL : L' -&gt; No@{i}) (yR : R' -&gt; No@{i})
      (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
      (l : L') (p : x = yL l)
: x &lt; {{ yL | yR // ycut }}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 404
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 405
Time: 0.044s">
<div class="time" style="width: 4.2677012609117%"></div>
<pre>
  generalize dependent x; refine (No_ind_hprop _ _); intros.</pre>
</div>
<div class="code" title="File: Core.v
Line: 406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply lt_l with l.</pre>
</div>
<div class="code" title="File: Core.v
Line: 407
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (transport (fun z =&gt; {{ xL | xR // xcut}} &lt;= z) p xle).</pre>
</div>
<div class="code" title="File: Core.v
Line: 408
Time: 0.002s">
<div class="time" style="width: 0.19398642095053%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 409
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Lemma Conway_theorem0_lemma2 `{Funext} (x : No@{i}) (xle : x &lt;= x)
      (L' R' : Type@{i}) (yL : L' -&gt; No@{i}) (yR : R' -&gt; No@{i})
      (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
      (r : R') (p : x = yR r)
: {{ yL | yR // ycut }} &lt; x.</pre>
</div>
<div class="code" title="File: Core.v
Line: 415
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 416
Time: 0.06s">
<div class="time" style="width: 5.819592628516%"></div>
<pre>
  generalize dependent x; refine (No_ind_hprop _ _); intros.</pre>
</div>
<div class="code" title="File: Core.v
Line: 417
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply lt_r with r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 418
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  exact (transport (fun z =&gt; z &lt;= {{ xL | xR // xcut}}) p xle).</pre>
</div>
<div class="code" title="File: Core.v
Line: 419
Time: 0.002s">
<div class="time" style="width: 0.19398642095053%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 420
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem Conway_theorem0_i `{Funext} (x : No)
: x &lt;= x.</pre>
</div>
<div class="code" title="File: Core.v
Line: 423
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 424
Time: 0.014s">
<div class="time" style="width: 1.3579049466537%"></div>
<pre>
  revert x; refine (No_ind_hprop _ _); intros.</pre>
</div>
<div class="code" title="File: Core.v
Line: 425
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply le_lr.</pre>
</div>
<div class="code" title="File: Core.v
Line: 426
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Core.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros l.</pre>
</div>
<div class="code" title="File: Core.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (Conway_theorem0_lemma1 (xL l) (IHL l) _ _ _ _ _ _ 1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Core.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> refine (Conway_theorem0_lemma2 (xR r) (IHR r) _ _ _ _ _ _ 1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 428
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 429
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>

Instance reflexive_le `{Funext} : Reflexive le
  := Conway_theorem0_i.</pre>
</div>
<div class="code" title="File: Core.v
Line: 432
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem Conway_theorem0_ii_l `{Funext}
        (L R : Type@{i}) (xL : L -&gt; No@{i}) (xR : R -&gt; No@{i})
        (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
        (l : L)
: xL l &lt; {{ xL | xR // xcut }}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 438
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (Conway_theorem0_lemma1 (xL l) _ _ _ _ _ _ _ 1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply Conway_theorem0_i.</pre>
</div>
<div class="code" title="File: Core.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Theorem Conway_theorem0_ii_r `{Funext}
        (L R : Type@{i}) (xL : L -&gt; No@{i}) (xR : R -&gt; No@{i})
        (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
        (r : R)
: {{ xL | xR // xcut }} &lt; xR r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 449
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  refine (Conway_theorem0_lemma2 (xR r) _ _ _ _ _ _ _ 1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  apply Conway_theorem0_i.</pre>
</div>
<div class="code" title="File: Core.v
Line: 451
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Instance isset_No `{Funext} : IsHSet No.</pre>
</div>
<div class="code" title="File: Core.v
Line: 454
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 455
Time: 0.036s">
<div class="time" style="width: 3.4917555771096%"></div>
<pre>
  refine (@isset_hrel_subpaths No (fun (x y:No) =&gt; (x &lt;= y) * (y &lt;= x)) _ _ _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 456
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Core.v
Line: 457
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre> intros x; split; apply Conway_theorem0_i.</pre>
</div>
<div class="code" title="File: Core.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  -</pre>
</div>
<div class="code" title="File: Core.v
Line: 458
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x y [xley ylex]; apply path_No; assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 458
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>


(** ** The proofs of cut-ness don't impact equality of surreals *)</pre>
</div>
<div class="code" title="File: Core.v
Line: 462
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>Definition path_No_easy `{Funext}
           {L R : Type} (xL xL' : L -&gt; No) (xR xR' : R -&gt; No)
           (xLeq : forall l, xL l = xL' l)
           (xReq : forall r, xR r = xR' r)
           (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
           (xcut' : forall (l:L) (r:R), (xL' l) &lt; (xR' r))
: {{ xL | xR // xcut }} = {{ xL' | xR' // xcut' }}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 468
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 469
Time: 0.007s">
<div class="time" style="width: 0.67895247332687%"></div>
<pre>
  apply path_No; apply le_lr; intros;
  [ rewrite xLeq | rewrite &lt;- xReq | rewrite &lt;- xLeq | rewrite xReq ];
  try apply Conway_theorem0_ii_l;
  try apply Conway_theorem0_ii_r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 473
Time: 0.002s">
<div class="time" style="width: 0.19398642095053%"></div>
<pre>
Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 474
Time: 0.007s">
<div class="time" style="width: 0.67895247332687%"></div>
<pre>

Definition path_No_easy' `{Funext}
           {L R : Type} (xL xL' : L -&gt; No) (xR xR' : R -&gt; No)
           (xLeq : forall l, xL l = xL' l)
           (xReq : forall r, xR r = xR' r)
           (xcut : forall (l:L) (r:R), (xL l) &lt; (xR r))
: {{ xL | xR // xcut }}
  = {{ xL' | xR' //
       (fun l r =&gt; transport (fun xy =&gt; fst xy &lt; snd xy)
                             (path_prod' (xLeq l) (xReq r))
                             (xcut l r)) }}
  := path_No_easy xL xL' xR xR' xLeq xReq xcut _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 486
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Encode-decode to characterize [&lt;] and [&lt;=] recursively (Theorem 11.6.7). *)

</pre>
</div>
<div class="code" title="File: Core.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section NoCodes.</pre>
</div>
<div class="code" title="File: Core.v
Line: 489
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Context `{Univalence}.</pre>
</div>
<div class="code" title="File: Core.v
Line: 490
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

  Let A := {le'_x : No -&gt; hProp &amp;
           {lt'_x : No -&gt; hProp &amp;
           (forall y : No, lt'_x y -&gt; le'_x y) *
           (forall y z : No, le'_x y -&gt; y &lt;= z -&gt; le'_x z) *
           (forall y z : No, le'_x y -&gt; y &lt; z -&gt; lt'_x z) *
           (forall y z : No, lt'_x y -&gt; y &lt;= z -&gt; lt'_x z)} }.</pre>
</div>
<div class="code" title="File: Core.v
Line: 497
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section Inner.</pre>
</div>
<div class="code" title="File: Core.v
Line: 499
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

    Context {L R : Type@{i} } (xL : L -&gt; No@{i}) (xR : R -&gt; No@{i})
            (xcut : forall (l : L) (r : R), xL l &lt; xR r)
            (xL_let : L -&gt; A) (xR_let : R -&gt; A)
            (x_lt_le : forall (l : L) (r : R) (y : No),
                         (xR_let r).1 y -&gt; ((xL_let l).2).1 y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 505
Time: 0.006s">
<div class="time" style="width: 0.5819592628516%"></div>
<pre>

    Let A' (y : No) : Type
    := { lelt'_x_y : hProp * hProp &amp;
         (snd lelt'_x_y -&gt; fst lelt'_x_y) *
         (forall l : L, fst lelt'_x_y -&gt; ((xL_let l).2).1 y) *
         (forall r : R, (xR_let r).1 y -&gt; snd lelt'_x_y) }.</pre>
</div>
<div class="code" title="File: Core.v
Line: 511
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>

    Let A'le (y z : No) (p : y &lt;= z) (tr : A' y) (sq : A' z) : Type
      := (fst tr.1 -&gt; fst sq.1) * (snd tr.1 -&gt; snd sq.1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 514
Time: 0.002s">
<div class="time" style="width: 0.19398642095053%"></div>
<pre>

    Let A'lt (y z : No) (p : y &lt; z) (tr : A' y) (sq : A' z) : Type
      := (fst tr.1 -&gt; snd sq.1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 517
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>

    Local Definition inner_package
    : { inner : forall (y : No), A' y &amp;
       (forall y z p, A'le y z p (inner y) (inner z)) *
       (forall y z p, A'lt y z p (inner y) (inner z)) }.</pre>
</div>
<div class="code" title="File: Core.v
Line: 522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 523
Time: 0.659s">
<div class="time" style="width: 63.918525703201%"></div>
<pre>
      simple refine (No_ind_package A' A'le A'lt _ _ _ _ _ );
      unfold A', A'le, A'lt; try exact _.</pre>
</div>
<div class="code" title="File: Core.v
Line: 525
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros L' R' yL yR ycut x_let_yL x_let_yR y_lt_le.</pre>
</div>
<div class="code" title="File: Core.v
Line: 526
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
        set (y := {{ yL | yR // ycut }}).</pre>
</div>
<div class="code" title="File: Core.v
Line: 527
Time: 0.193s">
<div class="time" style="width: 18.719689621726%"></div>
<pre>
        exists (BuildhProp
                  ((forall l, (xL_let l).2.1 y) *
                   (forall r', snd (x_let_yR r').1)) ,
                (hor {l':L' &amp; fst (x_let_yL l').1}
                    {r:R   &amp; (xR_let r).1 y})).</pre>
</div>
<div class="code" title="File: Core.v
Line: 532
Time: 0.352s">
<div class="time" style="width: 34.141610087294%"></div>
<pre>
        abstract (
            refine ((_,_),_);
            [ intros h; strip_truncations;
              destruct h as [[l' h]|[r h]]; split; intros;
              [ refine (snd (fst (xL_let l).2.2) (yL l') y _ _);
                [ refine (fst (fst (fst (xL_let l).2.2)) (yL l') _);
                  exact (snd (fst (x_let_yL l').2) l h)
                | by apply Conway_theorem0_ii_l ]
              | exact (y_lt_le l' r' h)
              | exact (x_lt_le l r y h)
              | refine (snd (x_let_yR r').2 r _);
                refine (fst (fst (fst (xR_let r).2.2)) _ _);
                refine (snd (fst (xR_let r).2.2) y (yR r') h _);
                apply Conway_theorem0_ii_r ]
            | intros l [h k]; apply h
            | intros r h; apply tr, inr; exact (r;h) ] ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 548
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 549
Time: 0.492s">
<div class="time" style="width: 47.720659553831%"></div>
<pre> abstract (
            intros y z
                   [[x_le_y x_lt_y] ?]
                   [[x_le_z x_lt_z] ?]
                   p q;
            cbn; intros [p1 p2] [q1 q2];
            rewrite transport_sigma'; (* cbn; *)
            refine (path_sigma' _
                      (path_prod' (path_hprop (equiv_iff_hprop p1 q1))
                                  (path_hprop (equiv_iff_hprop p2 q2)))
                      _);
            apply path_ishprop ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 560
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 561
Time: 0.88s">
<div class="time" style="width: 85.354025218235%"></div>
<pre> abstract (
            cbn;
            intros L' R' yL yR ycut x_let_yL x_let_yR y_lt_le;
            set (y := {{ yL | yR // ycut }});
            intros L'' R'' zL zR zcut x_let_zL x_let_zR z_lt_le;
            set (z := {{ zL | zR // zcut }});
            intros yL_lt_z h1 y_lt_zR h2;
            assert (y_le_z := le_lr yL yR ycut zL zR zcut yL_lt_z y_lt_zR);
            split; [ intros [h3 h4]; split
                   | intros h3; strip_truncations;
                     destruct h3 as [[l' h3]|[r h3]] ] ;
            [ intros l; refine (snd (xL_let l).2.2 y z (h3 l) y_le_z)
            | intros r''; refine (h2 r'' (h3 , h4))
            | refine (h1 l' h3)
            | apply tr, inr; exists r;
              refine (snd (fst (fst (xR_let r).2.2)) y z h3 y_le_z) ] ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 576
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 577
Time: 0.04s">
<div class="time" style="width: 3.8797284190107%"></div>
<pre> abstract (
            cbn;
            intros L' R' yL yR ycut x_let_yL x_let_yR y_lt_le;
            set (y := {{ yL | yR // ycut }});
            intros L'' R'' zL zR zcut x_let_zL x_let_zR z_lt_le;
            set (z := {{ zL | zR // zcut }});
            intros l'' y_le_zL [h1 h2] x_le_y;
            apply tr, inl; exact (l''; h1 x_le_y) ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 584
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      -</pre>
</div>
<div class="code" title="File: Core.v
Line: 585
Time: 0.039s">
<div class="time" style="width: 3.7827352085354%"></div>
<pre> abstract (
            cbn;
            intros L' R' yL yR ycut x_let_yL x_let_yR y_lt_le;
            set (y := {{ yL | yR // ycut }});
            intros L'' R'' zL zR zcut x_let_zL x_let_zR z_lt_le;
            set (z := {{ zL | zR // zcut }});
            intros r' yR_le_z [h1 h2] x_le_y;
            apply h2; exact (snd x_le_y r') ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 592
Time: 0.044s">
<div class="time" style="width: 4.2677012609117%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 593
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

    Local Definition inner (y : No) : A' y
      := inner_package.1 y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 596
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** These computation laws hold definitionally, but it helps Coq out if we prove them explicitly and then rewrite along them later. *)
   </pre>
</div>
<div class="code" title="File: Core.v
Line: 599
Time: 0.206s">
<div class="time" style="width: 19.980601357905%"></div>
<pre>Definition inner_cut_le
               (L' R' : Type@{i}) (yL : L' -&gt; No@{i}) (yR : R' -&gt; No@{i})
               (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
    : fst (inner {{ yL | yR // ycut }}).1 =
      (BuildhProp ((forall l, (xL_let l).2.1 {{ yL | yR // ycut }}) *
                   (forall r', snd (inner (yR r')).1)))
      := 1.</pre>
</div>
<div class="code" title="File: Core.v
Line: 605
Time: 0.024s">
<div class="time" style="width: 2.3278370514064%"></div>
<pre>

    Definition inner_cut_lt
               (L' R' : Type@{i}) (yL : L' -&gt; No@{i}) (yR : R' -&gt; No@{i})
               (ycut : forall (l:L') (r:R'), (yL l) &lt; (yR r))
    : snd (inner {{ yL | yR // ycut }}).1 =
      (hor {l':L' &amp; fst (inner (yL l')).1}
           {r:R &amp; (xR_let r).1 {{ yL | yR // ycut }} })
      := 1.</pre>
</div>
<div class="code" title="File: Core.v
Line: 613
Time: 0.007s">
<div class="time" style="width: 0.67895247332687%"></div>
<pre>

    Local Definition inner_le y z p : A'le y z p (inner y) (inner z)
      := fst (inner_package.2) y z p.</pre>
</div>
<div class="code" title="File: Core.v
Line: 616
Time: 0.007s">
<div class="time" style="width: 0.67895247332687%"></div>
<pre>

    Local Definition inner_lt y z p : A'lt y z p (inner y) (inner z)
      := snd (inner_package.2) y z p.</pre>
</div>
<div class="code" title="File: Core.v
Line: 619
Time: 0.016s">
<div class="time" style="width: 1.5518913676043%"></div>
<pre>

  End Inner.</pre>
</div>
<div class="code" title="File: Core.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** We instruct [simpl]/[cbn] not to unfold [inner].  We will do the "unfolding" ourselves by rewriting along [inner_cut_le] and [inner_cut_lt], so as to keep better control over the resulting terms (and particularly their size).  *)
 </pre>
</div>
<div class="code" title="File: Core.v
Line: 624
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Arguments inner : simpl never.</pre>
</div>
<div class="code" title="File: Core.v
Line: 624
Time: 0.008s">
<div class="time" style="width: 0.77594568380213%"></div>
<pre>

  Definition No_codes_package
  : { lelt : No -&gt; A &amp;
         (forall (x y : No), (x &lt;= y) -&gt;
            forall z, ((lelt y).1 z -&gt; (lelt x).1 z) *
                      ((lelt y).2.1 z -&gt; (lelt x).2.1 z)) *
         (forall (x y : No), (x &lt; y) -&gt;
            forall z, ((lelt y).1 z -&gt; (lelt x).2.1 z)) }.</pre>
</div>
<div class="code" title="File: Core.v
Line: 632
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 633
Time: 0.186s">
<div class="time" style="width: 18.0407371484%"></div>
<pre>
    simple refine (No_rec_package A
              (fun dm ht =&gt; forall y, (ht.1 y -&gt; dm.1 y)
                                      * (ht.2.1 y -&gt; dm.2.1 y))
              (fun dm ht =&gt; forall y, (ht.1 y -&gt; dm.2.1 y))
              _ _ _ _ _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 638
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros L R xL xR xcut xL_let xR_let x_lt_le.</pre>
</div>
<div class="code" title="File: Core.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      pose (x := {{ xL | xR // xcut }}).</pre>
</div>
<div class="code" title="File: Core.v
Line: 640
Time: 0.002s">
<div class="time" style="width: 0.19398642095053%"></div>
<pre>
      exists (fun y =&gt; fst (inner xL_let xR_let x_lt_le y).1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 641
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
      exists (fun y =&gt; snd (inner xL_let xR_let x_lt_le y).1).</pre>
</div>
<div class="code" title="File: Core.v
Line: 642
Time: 0.052s">
<div class="time" style="width: 5.0436469447139%"></div>
<pre>
      abstract (
          repeat split;
          [ intros y; exact (fst (fst (inner xL_let xR_let x_lt_le y).2))
          | intros y z x_le_y y_le_z;
            exact (fst (inner_le xL_let xR_let x_lt_le y z y_le_z) x_le_y)
          | intros y z x_le_y y_lt_z;
            exact (inner_lt xL_let xR_let x_lt_le y z y_lt_z x_le_y)
          | intros y z x_lt_y y_le_z;
            exact (snd (inner_le xL_let xR_let x_lt_le y z y_le_z) x_lt_y) ]).</pre>
</div>
<div class="code" title="File: Core.v
Line: 651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 652
Time: 0.971s">
<div class="time" style="width: 94.180407371484%"></div>
<pre> abstract (
          intros [x_le [x_lt ?]] [x_le' [x_lt' ?]] p q; cbn in p, q;
          simple refine (path_sigma' _ _ _);
          [ apply path_arrow; intros y; apply path_hprop, equiv_iff_hprop;
            [ exact (fst (q y)) | exact (fst (p y)) ]
          | rewrite transport_sigma'; cbn;
            simple refine (path_sigma' _ _ _);
            [ apply path_arrow; intros y; apply path_hprop, equiv_iff_hprop;
              [ exact (snd (q y)) | exact (snd (p y)) ]
            | apply path_ishprop ] ] ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 661
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 662
Time: 0.944s">
<div class="time" style="width: 91.561590688652%"></div>
<pre> abstract (
          intros L R xL xR xcut xL_let xR_let x_le_lt
                 L' R' yL yR ycut yL_let yR_let y_le_lt;
          set (x := {{ xL | xR // xcut }});
          set (y := {{ yL | yR // ycut }});
          cbn;
          intros xL_lt_y xL_lt_z x_lt_yR le_lt_y;
          refine (No_ind_hprop _ _);
          intros L'' R'' zL zR zcut zLH zRH; split;
          [ rewrite !inner_cut_le;
            intros y_le_z; split;
            [ intros l; refine (xL_lt_z l {{ zL | zR // zcut }} y_le_z)
            | intros r; refine (snd (zRH r) (snd y_le_z r)) ]
          | rewrite !inner_cut_lt;
            intros y_lt_z; strip_truncations;
            destruct y_lt_z as [[l y_le_zL]|[r yR_le_z]];
            [ apply tr; left; exact (l; fst (zLH l) y_le_zL)
            | refine (le_lt_y r {{ zL | zR // zcut }} yR_le_z) ]] ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 679
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 680
Time: 0.181s">
<div class="time" style="width: 17.555771096023%"></div>
<pre> abstract (
          intros L R xL xR xcut xL_let xR_let x_le_lt
                 L' R' yL yR ycut yL_let yR_let y_le_lt;
          set (x := {{ xL | xR // xcut }});
          set (y := {{ yL | yR // ycut }});
          cbn; intros l x_le_yL zH;
          refine (No_ind_hprop _ _);
          intros L'' R'' zL zR zcut zLH zRH y_le_z;
          refine (snd (zH {{ zL | zR // zcut }}) _);
          rewrite inner_cut_le in y_le_z;
          exact (fst y_le_z l) ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 690
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 691
Time: 0.186s">
<div class="time" style="width: 18.0407371484%"></div>
<pre> abstract (
          intros L R xL xR xcut xL_let xR_let x_le_lt
                 L' R' yL yR ycut yL_let yR_let y_le_lt;
          set (x := {{ xL | xR // xcut }});
          set (y := {{ yL | yR // ycut }});
          cbn; intros r xR_le_y zH;
          refine (No_ind_hprop _ _);
          intros L'' R'' zL zR zcut zLH zRH y_le_z;
          rewrite inner_cut_lt;
          apply tr; right; exists r;
          refine (fst (zH {{ zL | zR // zcut }}) y_le_z) ).</pre>
</div>
<div class="code" title="File: Core.v
Line: 701
Time: 0.007s">
<div class="time" style="width: 0.67895247332687%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Core.v
Line: 702
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>

  Definition le' (x y : No) : hProp
    := (No_codes_package.1 x).1 y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 705
Time: 0.005s">
<div class="time" style="width: 0.48496605237633%"></div>
<pre>

  Definition lt' (x y : No) : hProp
    := (No_codes_package.1 x).2.1 y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 708
Time: 0.011s">
<div class="time" style="width: 1.0669253152279%"></div>
<pre>

  Definition lt'_le' x y
  : lt' x y -&gt; le' x y
    := (fst (fst (fst (No_codes_package.1 x).2.2)) y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 712
Time: 0.021s">
<div class="time" style="width: 2.0368574199806%"></div>
<pre>

  Definition le_le'_trans x y z
  : x &lt;= y -&gt; le' y z -&gt; le' x z
    := fun p q =&gt; (fst (fst (No_codes_package.2) x y p z) q).</pre>
</div>
<div class="code" title="File: Core.v
Line: 716
Time: 0.021s">
<div class="time" style="width: 2.0368574199806%"></div>
<pre>

  Definition le_lt'_trans x y z
  : x &lt;= y -&gt; lt' y z -&gt; lt' x z
    := fun p q =&gt; (snd (fst (No_codes_package.2) x y p z) q).</pre>
</div>
<div class="code" title="File: Core.v
Line: 720
Time: 0.02s">
<div class="time" style="width: 1.9398642095053%"></div>
<pre>

  Definition lt_le'_trans x y z
  : x &lt; y -&gt; le' y z -&gt; lt' x z
    := fun p q =&gt; (snd (No_codes_package.2) x y p z q).</pre>
</div>
<div class="code" title="File: Core.v
Line: 724
Time: 0.022s">
<div class="time" style="width: 2.1338506304559%"></div>
<pre>

  Definition le'_le_trans x y z
  :  le' x y -&gt; y &lt;= z -&gt; le' x z
    := fun p q =&gt; (snd (fst (fst (No_codes_package.1 x).2.2)) y z p q).</pre>
</div>
<div class="code" title="File: Core.v
Line: 728
Time: 0.024s">
<div class="time" style="width: 2.3278370514064%"></div>
<pre>

  Definition le'_lt_trans x y z
  : le' x y -&gt; y &lt; z -&gt; lt' x z
    := fun p q =&gt; (snd (fst (No_codes_package.1 x).2.2) y z p q).</pre>
</div>
<div class="code" title="File: Core.v
Line: 732
Time: 0.025s">
<div class="time" style="width: 2.4248302618817%"></div>
<pre>

  Definition lt'_le_trans x y z
  : lt' x y -&gt; y &lt;= z -&gt; lt' x z
    := fun p q =&gt; (snd (No_codes_package.1 x).2.2 y z p q).</pre>
</div>
<div class="code" title="File: Core.v
Line: 736
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** These computation laws hold definitionally, but it takes Coq a little while to verify that.  Thus, we prove them once and then [rewrite] along them later, so we don't have to do the verification every time. *)
 </pre>
</div>
<div class="code" title="File: Core.v
Line: 739
Time: 0.523s">
<div class="time" style="width: 50.727449078565%"></div>
<pre>Definition le'_cut
             (L R : Type) (xL : L -&gt; No) (xR : R -&gt; No)
             (xcut : forall (l : L) (r : R), xL l &lt; xR r)
             (L' R' : Type) (yL : L' -&gt; No) (yR : R' -&gt; No)
             (ycut : forall (l : L') (r : R'), yL l &lt; yR r)
  : le' {{xL | xR // xcut}} {{yL | yR // ycut}}
    = ((forall l, lt' (xL l) {{ yL | yR // ycut }}) *
       (forall r', lt' {{ xL | xR // xcut }} (yR r')))
        (** For some reason, Coq has a really hard time checking the version of this that asserts an equality in [hProp].  But fortunately, we only ever really need the equality of types. *)
        :&gt; Type
    := 1.</pre>
</div>
<div class="code" title="File: Core.v
Line: 749
Time: 1.031s">
<div class="time" style="width: 100%"></div>
<pre>

  Definition lt'_cut
             (L R : Type) (xL : L -&gt; No) (xR : R -&gt; No)
             (xcut : forall (l : L) (r : R), xL l &lt; xR r)
             (L' R' : Type) (yL : L' -&gt; No) (yR : R' -&gt; No)
             (ycut : forall (l : L') (r : R'), yL l &lt; yR r)
  : lt' {{xL | xR // xcut}} {{yL | yR // ycut}}
    = (hor {l':L' &amp; le' {{ xL | xR // xcut }} (yL l')}
                  {r:R   &amp; le' (xR r) {{ yL | yR // ycut }} })
    := 1.</pre>
</div>
<div class="code" title="File: Core.v
Line: 759
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>

  Definition No_encode_le_lt (x y : No)
  : ((x &lt;= y) -&gt; (le' x y)) * ((x &lt; y) -&gt; (lt' x y)).</pre>
</div>
<div class="code" title="File: Core.v
Line: 762
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 763
Time: 0.335s">
<div class="time" style="width: 32.492725509214%"></div>
<pre>
    refine (No_ind_le_lt (fun _ =&gt; Unit)
                         (fun x y _ _ _ =&gt; le' x y)
                         (fun x y _ _ _ =&gt; lt' x y)
                         _ _ _ _ _ x y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 767
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Core.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros; exact tt.</pre>
</div>
<div class="code" title="File: Core.v
Line: 768
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Core.v
Line: 769
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre> intros; apply path_contr.</pre>
</div>
<div class="code" title="File: Core.v
Line: 769
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Core.v
Line: 770
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros L R xL xR xcut _ _ xcut'
             L' R' yL yR ycut _ _ ycut'
             xL_lt_y xL_lt_y' x_lt_yR x_lt_yR'.</pre>
</div>
<div class="code" title="File: Core.v
Line: 772
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>
      rewrite le'_cut.</pre>
</div>
<div class="code" title="File: Core.v
Line: 773
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
      exact (xL_lt_y' , x_lt_yR').</pre>
</div>
<div class="code" title="File: Core.v
Line: 774
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Core.v
Line: 775
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros L R xL xR xcut _ _ xcut'
             L' R' yL yR ycut _ _ ycut'
             l x_le_yL x_le_yL'.</pre>
</div>
<div class="code" title="File: Core.v
Line: 777
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>
      rewrite lt'_cut.</pre>
</div>
<div class="code" title="File: Core.v
Line: 778
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
      apply tr; left.</pre>
</div>
<div class="code" title="File: Core.v
Line: 779
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists l.</pre>
</div>
<div class="code" title="File: Core.v
Line: 779
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact x_le_yL'.</pre>
</div>
<div class="code" title="File: Core.v
Line: 779
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    +</pre>
</div>
<div class="code" title="File: Core.v
Line: 780
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros L R xL xR xcut _ _ xcut'
             L' R' yL yR ycut _ _ ycut'
             r xR_le_y xR_le_y'.</pre>
</div>
<div class="code" title="File: Core.v
Line: 782
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>
      rewrite lt'_cut.</pre>
</div>
<div class="code" title="File: Core.v
Line: 783
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
      apply tr; right.</pre>
</div>
<div class="code" title="File: Core.v
Line: 784
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exists r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 784
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> exact xR_le_y'.</pre>
</div>
<div class="code" title="File: Core.v
Line: 784
Time: 0.019s">
<div class="time" style="width: 1.8428709990301%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 785
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>

  Definition No_decode_le_lt (x y : No)
  : ((le' x y) -&gt; (x &lt;= y)) * ((lt' x y) -&gt; (x &lt; y)).</pre>
</div>
<div class="code" title="File: Core.v
Line: 788
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 789
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    revert x y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 790
Time: 0.106s">
<div class="time" style="width: 10.281280310378%"></div>
<pre>
    refine (No_ind_hprop _ _); intros L R xL xR xcut xHL xHR.</pre>
</div>
<div class="code" title="File: Core.v
Line: 791
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** TODO: Why can't Coq find [trunc_arrow] here? *)
   </pre>
</div>
<div class="code" title="File: Core.v
Line: 793
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>refine (@No_ind_hprop _
              (fun y =&gt; @trunc_prod _ _ trunc_arrow _ trunc_arrow) _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 794
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros L' R' yL yR ycut yHL yHR.</pre>
</div>
<div class="code" title="File: Core.v
Line: 795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> split.</pre>
</div>
<div class="code" title="File: Core.v
Line: 795
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 796
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x_le_y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 796
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
      rewrite le'_cut in x_le_y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 797
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
      exact (le_lr xL xR xcut yL yR ycut
                   (fun l =&gt; snd (xHL l _) (fst x_le_y l))
                   (fun r =&gt; snd (yHR r) (snd x_le_y r))).</pre>
</div>
<div class="code" title="File: Core.v
Line: 800
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Core.v
Line: 801
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> intros x_lt_y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 801
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
      rewrite lt'_cut in x_lt_y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 802
Time: 0.212s">
<div class="time" style="width: 20.562560620757%"></div>
<pre>
      strip_truncations; destruct x_lt_y as [[l x_le_yL]|[r xR_le_y]].</pre>
</div>
<div class="code" title="File: Core.v
Line: 803
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Core.v
Line: 804
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply lt_l with l.</pre>
</div>
<div class="code" title="File: Core.v
Line: 804
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (fst (yHL l) x_le_yL).</pre>
</div>
<div class="code" title="File: Core.v
Line: 805
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      +</pre>
</div>
<div class="code" title="File: Core.v
Line: 806
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> apply lt_r with r.</pre>
</div>
<div class="code" title="File: Core.v
Line: 806
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
        exact (fst (xHR r _) xR_le_y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 807
Time: 0.013s">
<div class="time" style="width: 1.2609117361785%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 808
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

  Definition No_encode_le x y := fst (No_encode_le_lt x y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 810
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
  Definition No_encode_lt x y := snd (No_encode_le_lt x y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 811
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
  Definition No_decode_le x y := fst (No_decode_le_lt x y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 812
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>
  Definition No_decode_lt x y := snd (No_decode_le_lt x y).</pre>
</div>
<div class="code" title="File: Core.v
Line: 813
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Corollary lt_le {x y : No} (p : x &lt; y) : x &lt;= y.</pre>
</div>
<div class="code" title="File: Core.v
Line: 815
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 816
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply No_decode_le.</pre>
</div>
<div class="code" title="File: Core.v
Line: 817
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    apply lt'_le'.</pre>
</div>
<div class="code" title="File: Core.v
Line: 818
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    apply No_encode_lt.</pre>
</div>
<div class="code" title="File: Core.v
Line: 819
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 820
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 821
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** Conway's theorem 1 *)
 </pre>
</div>
<div class="code" title="File: Core.v
Line: 824
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Corollary le_le_trans {x y z : No}
  : (x &lt;= y) -&gt; (y &lt;= z) -&gt; (x &lt;= z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 825
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 826
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros p q.</pre>
</div>
<div class="code" title="File: Core.v
Line: 827
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply No_decode_le.</pre>
</div>
<div class="code" title="File: Core.v
Line: 828
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    refine (le_le'_trans x y z p _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 829
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    apply No_encode_le.</pre>
</div>
<div class="code" title="File: Core.v
Line: 830
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 831
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 832
Time: 0.003s">
<div class="time" style="width: 0.2909796314258%"></div>
<pre>

  Global Instance trans_le : Transitive le
    := @le_le_trans.</pre>
</div>
<div class="code" title="File: Core.v
Line: 835
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Corollary le_lt_trans {x y z : No}
  : (x &lt;= y) -&gt; (y &lt; z) -&gt; (x &lt; z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 838
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 839
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros p q.</pre>
</div>
<div class="code" title="File: Core.v
Line: 840
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply No_decode_lt.</pre>
</div>
<div class="code" title="File: Core.v
Line: 841
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    refine (le_lt'_trans x y z p _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 842
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    apply No_encode_lt.</pre>
</div>
<div class="code" title="File: Core.v
Line: 843
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 844
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 845
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Corollary lt_le_trans {x y z : No}
  : (x &lt; y) -&gt; (y &lt;= z) -&gt; (x &lt; z).</pre>
</div>
<div class="code" title="File: Core.v
Line: 848
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Core.v
Line: 849
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros p q.</pre>
</div>
<div class="code" title="File: Core.v
Line: 850
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    apply No_decode_lt.</pre>
</div>
<div class="code" title="File: Core.v
Line: 851
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    refine (lt_le'_trans x y z p _).</pre>
</div>
<div class="code" title="File: Core.v
Line: 852
Time: 0.001s">
<div class="time" style="width: 0.096993210475267%"></div>
<pre>
    apply No_encode_le.</pre>
</div>
<div class="code" title="File: Core.v
Line: 853
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    assumption.</pre>
</div>
<div class="code" title="File: Core.v
Line: 854
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Core.v
Line: 855
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>

  Definition lt_lt_trans {x y z : No}
  : (x &lt; y) -&gt; (y &lt; z) -&gt; (x &lt; z)
    := fun p q =&gt; lt_le_trans p (lt_le q).</pre>
</div>
<div class="code" title="File: Core.v
Line: 859
Time: 0.004s">
<div class="time" style="width: 0.38797284190107%"></div>
<pre>

  Global Instance trans_lt : Transitive lt
    := @lt_lt_trans.</pre>
</div>
<div class="code" title="File: Core.v
Line: 862
Time: 0.165s">
<div class="time" style="width: 16.003879728419%"></div>
<pre>

End NoCodes.</pre>
</div>
<div class="code" title="File: Core.v
Line: 865
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>


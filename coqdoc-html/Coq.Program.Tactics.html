<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Coq.Program.Tactics</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Coq.Program.Tactics</h1>

<div class="code">

<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.Init.Datatypes.html#"><span class="id" type="library">Datatypes</span></a> <a class="idref" href="Coq.Init.Specif.html#"><span class="id" type="library">Specif</span></a> <a class="idref" href="Coq.Init.Logic.html#"><span class="id" type="library">Logic</span></a>.<br/>

<br/>
</div>

<div class="doc">
This module implements various tactics used to simplify the goals produced by Program,
   which are also generally useful. 
<div class="paragraph"> </div>

 Debugging tactics to show the goal during evaluation. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">show_goal</span> := <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span> [ |- ?<span class="id" type="var">T</span> ] ⇒ <span class="id" type="tactic">idtac</span> <span class="id" type="var">T</span> <span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">show_hyp</span> <span class="id" type="var">id</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> := ?<span class="id" type="var">b</span> : ?<span class="id" type="var">T</span> |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">id</span> ⇒ <span class="id" type="tactic">idtac</span> <span class="id" type="var">id</span> ":=" <span class="id" type="var">b</span> ":" <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">T</span> |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">id</span> ⇒ <span class="id" type="tactic">idtac</span> <span class="id" type="var">id</span>  ":"  <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">show_hyps</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="keyword">match</span> <span class="id" type="var">reverse</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">T</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">show_hyp</span> <span class="id" type="var">H</span> ; <span class="id" type="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" type="tactic">do</span></span> tactic but using a Coq-side nat. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">do_nat</span> <span class="id" type="var">n</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0 ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> ?<span class="id" type="var">n'</span> ⇒ <span class="id" type="var">tac</span> ; <span class="id" type="var">do_nat</span> <span class="id" type="var">n'</span> <span class="id" type="var">tac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Do something on the last hypothesis, or fail 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">on_last_hyp</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span> [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">first</span> [ <span class="id" type="var">tac</span> <span class="id" type="var">H</span> | <span class="id" type="tactic">fail</span> 1 ] <span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Destructs one pair, without care regarding naming. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_one_pair</span> :=<br/>
&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| [<span class="id" type="var">H</span> : <a class="idref" href="Coq.Init.Datatypes.html#conj"><span class="id" type="abbreviation">conj</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span>] ⇒ <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;| [<span class="id" type="var">H</span> : <a class="idref" href="Coq.Init.Datatypes.html#prod"><span class="id" type="record">prod</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span>] ⇒ <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span><br/>
&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Repeateadly destruct pairs. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_pairs</span> := <span class="id" type="tactic">repeat</span> (<span class="id" type="var">destruct_one_pair</span>).<br/>

<br/>
</div>

<div class="doc">
Destruct one existential package, keeping the name of the hypothesis for the first component. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_one_ex</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tac</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">ph</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span> (<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H</span> <span class="id" type="var">ph</span>]) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tac2</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">ph</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">ph'</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H</span> <span class="id" type="var">ph</span> <span class="id" type="var">ph'</span>]) <br/>
&nbsp;&nbsp;<span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tacT</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">ph</span> := <span class="id" type="tactic">fresh</span> "X" <span class="id" type="keyword">in</span> (<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H</span> <span class="id" type="var">ph</span>]) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tacT2</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">ph</span> := <span class="id" type="tactic">fresh</span> "X" <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> <span class="id" type="var">ph'</span> := <span class="id" type="tactic">fresh</span> "X" <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H</span> <span class="id" type="var">ph</span> <span class="id" type="var">ph'</span>]) <br/>
&nbsp;&nbsp;<span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" type="var">H</span> : (<a class="idref" href="Coq.Init.Specif.html#sigT"><span class="id" type="abbreviation">sigT</span></a> ?<span class="id" type="var">P</span>) |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tacT</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" type="var">H</span> : (<a class="idref" href="Coq.Init.Specif.html#sigT2"><span class="id" type="abbreviation">sigT2</span></a> ?<span class="id" type="var">P</span> <span class="id" type="var">_</span>) |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">tacT2</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Repeateadly destruct existentials. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_exists</span> := <span class="id" type="tactic">repeat</span> (<span class="id" type="var">destruct_one_ex</span>).<br/>

<br/>
</div>

<div class="doc">
Repeateadly destruct conjunctions and existentials. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_conjs</span> := <span class="id" type="tactic">repeat</span> (<span class="id" type="var">destruct_one_pair</span> || <span class="id" type="var">destruct_one_ex</span>).<br/>

<br/>
</div>

<div class="doc">
Destruct an existential hypothesis <span class="inlinecode"><a class="idref" href="HoTT.hit.minus1Trunc.html#t"><span class="id" type="lemma">t</span></a></span> keeping its name for the first component
   and using <span class="inlinecode"><span class="id" type="var">Ht</span></span> for the second 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Tactic Notation</span> "destruct" "exist" <span class="id" type="var">ident</span>(<span class="id" type="var">t</span>) <span class="id" type="var">ident</span>(<span class="id" type="var">Ht</span>) := <span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">t</span> <span class="id" type="var">Ht</span>].<br/>

<br/>
</div>

<div class="doc">
Destruct a disjunction keeping its name in both subgoals. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Tactic Notation</span> "destruct" "or" <span class="id" type="var">ident</span>(<span class="id" type="var">H</span>) := <span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span> <span class="id" type="keyword">as</span> [<span class="id" type="var">H</span>|<span class="id" type="var">H</span>].<br/>

<br/>
</div>

<div class="doc">
Discriminate that also work on a <span class="inlinecode"><a class="idref" href="HoTT.categories.Grothendieck.PseudofunctorToCat.html#x"><span class="id" type="projection">x</span></a></span> <span class="inlinecode">≠</span> <span class="inlinecode"><a class="idref" href="HoTT.categories.Grothendieck.PseudofunctorToCat.html#x"><span class="id" type="projection">x</span></a></span> hypothesis. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">discriminates</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">discriminate</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Revert the last hypothesis. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">revert_last</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">revert</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Repeatedly reverse the last hypothesis, putting everything in the goal. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">reverse</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">revert_last</span>.<br/>

<br/>
</div>

<div class="doc">
Reverse everything up to hypothesis id (not included). 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">revert_until</span> <span class="id" type="var">id</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">on_last_hyp</span> <span class="id" type="keyword">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">id'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">id'</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">id</span> ⇒ <span class="id" type="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="var">revert</span> <span class="id" type="var">id'</span> ; <span class="id" type="var">revert_until</span> <span class="id" type="var">id</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>).<br/>

<br/>
</div>

<div class="doc">
Clear duplicated hypotheses 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">clear_dup</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : ?<span class="id" type="var">X</span> |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H'</span> : ?<span class="id" type="var">Y</span> |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H'</span> ⇒ <span class="id" type="tactic">fail</span> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="var">unify</span> <span class="id" type="var">X</span> <span class="id" type="var">Y</span> ; (<span class="id" type="tactic">clear</span> <span class="id" type="var">H'</span> || <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">clear_dups</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="var">clear_dup</span>.<br/>

<br/>
</div>

<div class="doc">
Try to clear everything except some hyp 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">clear_except</span> <span class="id" type="var">hyp</span> := <br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span> [ <span class="id" type="var">H</span> : <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">hyp</span> ⇒ <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A non-failing subst that substitutes as much as possible. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">subst_no_fail</span> := <span class="id" type="tactic">idtac</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "subst" "*" := <span class="id" type="var">subst_no_fail</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">on_application</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span> <span class="id" type="var">T</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">T</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ?<span class="id" type="var">z</span> ?<span class="id" type="var">w</span> ?<span class="id" type="var">v</span> ?<span class="id" type="var">u</span> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span> ?<span class="id" type="var">c</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">w</span> <span class="id" type="var">v</span> <span class="id" type="var">u</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ?<span class="id" type="var">z</span> ?<span class="id" type="var">w</span> ?<span class="id" type="var">v</span> ?<span class="id" type="var">u</span> ?<span class="id" type="var">a</span> ?<span class="id" type="var">b</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">w</span> <span class="id" type="var">v</span> <span class="id" type="var">u</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ?<span class="id" type="var">z</span> ?<span class="id" type="var">w</span> ?<span class="id" type="var">v</span> ?<span class="id" type="var">u</span> ?<span class="id" type="var">a</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">w</span> <span class="id" type="var">v</span> <span class="id" type="var">u</span> <span class="id" type="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ?<span class="id" type="var">z</span> ?<span class="id" type="var">w</span> ?<span class="id" type="var">v</span> ?<span class="id" type="var">u</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">w</span> <span class="id" type="var">v</span> <span class="id" type="var">u</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ?<span class="id" type="var">z</span> ?<span class="id" type="var">w</span> ?<span class="id" type="var">v</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">w</span> <span class="id" type="var">v</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ?<span class="id" type="var">z</span> ?<span class="id" type="var">w</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> <span class="id" type="var">w</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span> ?<span class="id" type="var">z</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span> ?<span class="id" type="var">y</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<span class="id" type="var">f</span> ?<span class="id" type="var">x</span>] ⇒ <span class="id" type="var">tac</span> (<span class="id" type="var">f</span> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A variant of <span class="inlinecode"><span class="id" type="tactic">apply</span></span> using <span class="inlinecode"><span class="id" type="tactic">refine</span></span>, doing as much conversion as necessary. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">rapply</span> <span class="id" type="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">p</span> <span class="id" type="var">_</span>) ||<br/>
&nbsp;&nbsp;<span class="id" type="tactic">refine</span> <span class="id" type="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
Tactical <span class="inlinecode"><span class="id" type="var">on_call</span></span> <span class="inlinecode"><a class="idref" href="HoTTBookExercises.html#Book_4_5.parts.f"><span class="id" type="variable">f</span></a></span> <span class="inlinecode"><span class="id" type="var">tac</span></span> applies <span class="inlinecode"><span class="id" type="var">tac</span></span> on any application of <span class="inlinecode"><a class="idref" href="HoTTBookExercises.html#Book_4_5.parts.f"><span class="id" type="variable">f</span></a></span> in the hypothesis or goal. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">on_call</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">T</span>  ⇒ <span class="id" type="var">on_application</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">H</span> : ?<span class="id" type="var">T</span> |- <span class="id" type="var">_</span>  ⇒ <span class="id" type="var">on_application</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span> <span class="id" type="var">T</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="tactic">destruct_call</span> <span class="id" type="var">f</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tac</span> <span class="id" type="var">t</span> := (<span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">on_call</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_calls</span> <span class="id" type="var">f</span> := <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">destruct_call</span> <span class="id" type="var">f</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_call_in</span> <span class="id" type="var">f</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tac</span> <span class="id" type="var">t</span> := (<span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">T</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">on_application</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span> <span class="id" type="var">T</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_call_as</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tac</span> <span class="id" type="var">t</span> := (<span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span> <span class="id" type="keyword">as</span> <span class="id" type="var">l</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">on_call</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_call_as_in</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tac</span> <span class="id" type="var">t</span> := (<span class="id" type="tactic">destruct</span> <span class="id" type="var">t</span> <span class="id" type="keyword">as</span> <span class="id" type="var">l</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">T</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">on_application</span> <span class="id" type="var">f</span> <span class="id" type="var">tac</span> <span class="id" type="var">T</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "destruct_call" <span class="id" type="keyword">constr</span>(<span class="id" type="var">f</span>) := <span class="id" type="tactic">destruct_call</span> <span class="id" type="var">f</span>.<br/>

<br/>
</div>

<div class="doc">
Permit to name the results of destructing the call to <span class="inlinecode"><a class="idref" href="HoTTBookExercises.html#Book_4_5.parts.f"><span class="id" type="variable">f</span></a></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Tactic Notation</span> "destruct_call" <span class="id" type="keyword">constr</span>(<span class="id" type="var">f</span>) "as" <span class="id" type="var">simple_intropattern</span>(<span class="id" type="var">l</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">destruct_call_as</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span>.<br/>

<br/>
</div>

<div class="doc">
Specify the hypothesis in which the call occurs as well. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Tactic Notation</span> "destruct_call" <span class="id" type="keyword">constr</span>(<span class="id" type="var">f</span>) "in" <span class="id" type="var">hyp</span>(<span class="id" type="var">id</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">destruct_call_in</span> <span class="id" type="var">f</span> <span class="id" type="var">id</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "destruct_call" <span class="id" type="keyword">constr</span>(<span class="id" type="var">f</span>) "as" <span class="id" type="var">simple_intropattern</span>(<span class="id" type="var">l</span>) "in" <span class="id" type="var">hyp</span>(<span class="id" type="var">id</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="var">destruct_call_as_in</span> <span class="id" type="var">f</span> <span class="id" type="var">l</span> <span class="id" type="var">id</span>.<br/>

<br/>
</div>

<div class="doc">
A marker for prototypes to destruct. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="fix_proto"><span class="id" type="definition">fix_proto</span></a> {<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>} (<span class="id" type="var">a</span> : <a class="idref" href="Coq.Program.Tactics.html#A"><span class="id" type="variable">A</span></a>) := <a class="idref" href="Coq.Program.Tactics.html#a"><span class="id" type="variable">a</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_rec_calls</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <a class="idref" href="Coq.Program.Tactics.html#fix_proto"><span class="id" type="definition">fix_proto</span></a> <span class="id" type="var">_</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="var">destruct_calls</span> <span class="id" type="var">H</span> ; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_all_rec_calls</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="var">destruct_rec_calls</span> ; <span class="id" type="tactic">unfold</span> <a class="idref" href="Coq.Program.Tactics.html#fix_proto"><span class="id" type="definition">fix_proto</span></a> <span class="id" type="keyword">in</span> ×.<br/>

<br/>
</div>

<div class="doc">
Try to inject any potential constructor equality hypothesis. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">autoinjection</span> <span class="id" type="var">tac</span> := <span class="id" type="tactic">idtac</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">inject</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">progress</span> (<span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span> ; <span class="id" type="tactic">subst</span>*; <span class="id" type="var">clear_dups</span>) ; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">autoinjections</span> := <span class="id" type="tactic">repeat</span> (<span class="id" type="var">clear_dups</span> ; <span class="id" type="var">autoinjection</span> <span class="id" type="keyword">ltac</span>:<span class="id" type="var">inject</span>).<br/>

<br/>
</div>

<div class="doc">
Destruct an hypothesis by first copying it to avoid dependencies. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">destruct_nondep</span> <span class="id" type="var">H</span> := <span class="id" type="keyword">let</span> <span class="id" type="var">H0</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span>(<span class="id" type="var">H0</span> := <span class="id" type="var">H</span>); <span class="id" type="tactic">destruct</span> <span class="id" type="var">H0</span>.<br/>

<br/>
</div>

<div class="doc">
If bang appears in the goal, it means that we have a proof of False and the goal is solved. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">bang</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">x</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">x</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="keyword">context</span> [<a class="idref" href="Coq.Init.Logic.html#False_rect"><span class="id" type="definition">False_rect</span></a> <span class="id" type="var">_</span> ?<span class="id" type="var">p</span>] ⇒ <span class="id" type="tactic">elim</span> <span class="id" type="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A tactic to show contradiction by first asserting an automatically provable hypothesis. 
</div>
<div class="code">
<span class="id" type="keyword">Tactic Notation</span> "contradiction" "by" <span class="id" type="keyword">constr</span>(<span class="id" type="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">assert</span> <span class="id" type="var">t</span> <span class="id" type="keyword">as</span> <span class="id" type="var">H</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> × ; <span class="id" type="var">contradiction</span>.<br/>

<br/>
</div>

<div class="doc">
A tactic that adds <span class="inlinecode"><a class="idref" href="HoTT.categories.Adjoint.Composition.AssociativityLaw.html#composition_lemmas.H"><span class="id" type="variable">H</span></a>:=<a class="idref" href="HoTT.categories.KanExtensions.Functors.html#kan_extension_functors.p"><span class="id" type="variable">p</span></a>:<a class="idref" href="HoTT.categories.Pseudofunctor.RewriteLaws.html#typeof"><span class="id" type="abbreviation">typeof</span></a>(<a class="idref" href="HoTT.categories.KanExtensions.Functors.html#kan_extension_functors.p"><span class="id" type="variable">p</span></a>)</span> to the context if no hypothesis of the same type appears in the goal.
   Useful to do saturation using tactics. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">add_hypothesis</span> <span class="id" type="var">H'</span> <span class="id" type="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" type="var">X</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [ <span class="id" type="var">H</span> : <span class="id" type="var">X</span> |- <span class="id" type="var">_</span> ] ⇒ <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> ⇒ <span class="id" type="tactic">set</span> (<span class="id" type="var">H'</span>:=<span class="id" type="var">p</span>) ; <span class="id" type="tactic">try</span> (<span class="id" type="tactic">change</span> <span class="id" type="var">p</span> <span class="id" type="keyword">with</span> <span class="id" type="var">H'</span>) ; <span class="id" type="var">clearbody</span> <span class="id" type="var">H'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A tactic to replace an hypothesis by another term. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">replace_hyp</span> <span class="id" type="var">H</span> <span class="id" type="var">c</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H'</span> := <span class="id" type="tactic">fresh</span> "H" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span>(<span class="id" type="var">H'</span> := <span class="id" type="var">c</span>) ; <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span> ; <span class="id" type="tactic">rename</span> <span class="id" type="var">H'</span> <span class="id" type="var">into</span> <span class="id" type="var">H</span>.<br/>

<br/>
</div>

<div class="doc">
A tactic to refine an hypothesis by supplying some of its arguments. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">refine_hyp</span> <span class="id" type="var">c</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tac</span> <span class="id" type="var">H</span> := <span class="id" type="var">replace_hyp</span> <span class="id" type="var">H</span> <span class="id" type="var">c</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">c</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">H</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> ⇒ <span class="id" type="var">tac</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The default simplification tactic used by Program is defined by <span class="inlinecode"><span class="id" type="tactic">program_simpl</span></span>, sometimes <span class="inlinecode"><span class="id" type="tactic">auto</span></span>
   is not enough, better rebind using <span class="inlinecode"><span class="id" type="keyword">Obligation</span></span> <span class="inlinecode"><span class="id" type="keyword">Tactic</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" type="var">tac</span></span> in this case,
   possibly using <span class="inlinecode"><span class="id" type="tactic">program_simplify</span></span> to use standard goal-cleaning tactics. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="tactic">program_simplify</span> :=<br/>
<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span> ; <span class="id" type="var">destruct_all_rec_calls</span> ; <span class="id" type="tactic">repeat</span> (<span class="id" type="var">destruct_conjs</span>; <span class="id" type="tactic">simpl</span> <a class="idref" href="Coq.Init.Specif.html#proj1_sig"><span class="id" type="projection">proj1_sig</span></a> <span class="id" type="keyword">in</span> × );<br/>
&nbsp;&nbsp;<span class="id" type="tactic">subst</span>*; <span class="id" type="var">autoinjections</span> ; <span class="id" type="tactic">try</span> <span class="id" type="var">discriminates</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> (<span class="id" type="tactic">solve</span> [ <span class="id" type="tactic">red</span> ; <span class="id" type="tactic">intros</span> ; <span class="id" type="var">destruct_conjs</span> ; <span class="id" type="var">autoinjections</span> ; <span class="id" type="var">discriminates</span> ]).<br/>

<br/>
</div>

<div class="doc">
Restrict automation to propositional obligations. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">program_solve_wf</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="keyword">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- ?<span class="id" type="var">T</span> ⇒ <span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">T</span> <span class="id" type="keyword">with</span> <span class="id" type="keyword">Prop</span> ⇒ <span class="id" type="tactic">auto</span> <span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="var">Create</span> <span class="id" type="var">HintDb</span> <span class="id" type="var">program</span> <span class="id" type="var">discriminated</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="tactic">program_simpl</span> := <span class="id" type="tactic">program_simplify</span> ; <span class="id" type="tactic">try</span> <span class="id" type="var">typeclasses</span> <span class="id" type="tactic">eauto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">program</span> ; <span class="id" type="tactic">try</span> <span class="id" type="var">program_solve_wf</span>.<br/>

<br/>
<span class="id" type="keyword">Obligation</span> <span class="id" type="keyword">Tactic</span> := <span class="id" type="tactic">program_simpl</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="obligation"><span class="id" type="definition">obligation</span></a> (<span class="id" type="var">A</span> : <span class="id" type="keyword">Type</span>) {<span class="id" type="var">a</span> : <a class="idref" href="Coq.Program.Tactics.html#A"><span class="id" type="variable">A</span></a>} := <a class="idref" href="Coq.Program.Tactics.html#a"><span class="id" type="variable">a</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>